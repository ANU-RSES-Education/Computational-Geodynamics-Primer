[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Computational Geodynamics Primer",
    "section": "",
    "text": "This is a template repository for Lecture notes that include a computational component. It builds a website from the notes and includes live-links to source code that will run on binder. This template is pre-configured for courses at Research School of Earth Sciences, but is freely available for adoption elsewhere.\nI use the Quarto publication system which converts simple markdown formatted documents to webpages, pdf and slides. Quarto is designed to develop reusable content and is based around pandoc: you should be able to quickly import and convert content to the quarto version of markdown (especially if you have been using jupyter-book or myst-md - the concepts are very similar).\nTo use this repository, you will need make a fork for yourself and replace this content with your own. You will also need set a few configuration options to match the course metadata. I’m going to explain how this works.",
    "crumbs": [
      "Introduction",
      "Preface",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>EMSC e-Course template</span>"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "Introduction",
    "section": "",
    "text": "This is a book created from markdown and executable code.\nSee (knuth84?) for additional discussion of literate programming.",
    "crumbs": [
      "Introduction",
      "Preface",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "Part1-Fundamentals/placeholder.html",
    "href": "Part1-Fundamentals/placeholder.html",
    "title": "Mathematical Fundamentals",
    "section": "",
    "text": "Content to be added from migration\nThis part will cover: - Conservation laws - Tensor notation - Vector calculus - Coordinate systems",
    "crumbs": [
      "Introduction",
      "**Part I: Mathematical Fundamentals**",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Mathematical Fundamentals</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/placeholder.html",
    "href": "Part2-FluidDynamics/placeholder.html",
    "title": "Fluid Dynamics",
    "section": "",
    "text": "Content to be added from migration\nThis part will cover: - Continuum mechanics - Navier-Stokes equations - Incompressible flow - Vorticity",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Fluid Dynamics</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html",
    "href": "Part2-FluidDynamics/inviscid-flows.html",
    "title": "Steady Inviscid Flows",
    "section": "",
    "text": "Introduction\nInviscid flow theory provides fundamental insights into fluid motion by examining the limiting case where viscosity is negligible. While no real fluid is truly inviscid, many geophysical flows operate at very low Reynolds numbers where viscous effects are confined to thin boundary layers, and the bulk flow can be approximated as inviscid.\nWhy study inviscid flows in geodynamics?",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#introduction",
    "href": "Part2-FluidDynamics/inviscid-flows.html#introduction",
    "title": "Steady Inviscid Flows",
    "section": "",
    "text": "Flow Topology: Inviscid solutions reveal the fundamental structure of flow patterns\nAnalytical Tractability: Many inviscid problems have exact solutions\nLimiting Cases: Provide benchmarks for understanding viscous flows\nLarge-Scale Circulation: Core dynamics and atmospheric flows can be approximated as inviscid away from boundaries\nMathematical Foundation: Potential flow theory is a cornerstone of analytical fluid mechanics\n\n\n\n\n\n\n\nNoteMaterial adapted from MTH3360 Fluid Mechanics\n\n\n\nThis chapter is adapted from MTH3360 Incompressible Fluid Mechanics course materials (Monash University, 2010-2013), modified to emphasize connections to geodynamics.",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#bernoullis-equation",
    "href": "Part2-FluidDynamics/inviscid-flows.html#bernoullis-equation",
    "title": "Steady Inviscid Flows",
    "section": "Bernoulli’s Equation",
    "text": "Bernoulli’s Equation\n\nDerivation\nFor steady inviscid flow under external forces which have a potential \\(\\Omega\\) such that \\(\\mathbf{F} = -\\nabla\\Omega\\), the Euler equation (Navier-Stokes without viscosity) reduces to: \\[\n(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}= -\\frac{1}{\\rho}\\nabla p - \\nabla\\Omega\n\\]\nFor incompressible fluids: \\[\n(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}+ \\frac{1}{\\rho}\\nabla(p + \\rho\\Omega) = \\mathbf{0}\n\\]\nWe may regard \\(p + \\rho\\Omega\\) as a more general dynamic pressure. For gravitational potential, \\(\\Omega = gz\\), and \\(\\mathbf{F} = -\\nabla\\Omega = -g\\hat{\\mathbf{k}}\\).\nTo derive Bernoulli’s equation, we note that: \\[\n\\begin{aligned}\n\\mathbf{u}\\cdot [(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}] &= u(\\mathbf{u}\\cdot \\nabla)u + v(\\mathbf{u}\\cdot \\nabla)v + w(\\mathbf{u}\\cdot \\nabla)w \\\\\n&= \\mathbf{u}\\cdot \\nabla\\left(\\frac{1}{2}(u^2 + v^2 + w^2)\\right) \\\\\n&= (\\mathbf{u}\\cdot \\nabla)\\left(\\frac{1}{2}|\\mathbf{u}|^2\\right)\n\\end{aligned}\n\\]\nusing the fact that \\(\\mathbf{u}\\cdot \\nabla\\) is a scalar differential operator. Hence: \\[\n\\mathbf{u}\\cdot \\left[(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}+ \\frac{1}{\\rho}\\nabla(p + \\rho\\Omega)\\right] = (\\mathbf{u}\\cdot \\nabla)\\left(\\frac{1}{2}|\\mathbf{u}|^2 + \\frac{p}{\\rho} + \\Omega\\right) = 0\n\\]\nSince \\(\\mathbf{u}\\cdot \\nabla\\) is the derivative in the direction \\(\\mathbf{u}\\) (tangent to streamlines), it follows that:\nBernoulli’s Equation: \\[\n\\frac{1}{2}|\\mathbf{u}|^2 + \\frac{p}{\\rho} + \\Omega = \\text{constant along each streamline}\n\\tag{5.1}\\]\nalthough the constant will generally be different on different streamlines.\n\n\nPhysical Interpretation\nBernoulli’s equation Equation 5.1 represents energy conservation along a streamline:\n\n\\(\\frac{1}{2}|\\mathbf{u}|^2\\) = kinetic energy per unit mass\n\\(\\frac{p}{\\rho}\\) = pressure work per unit mass\n\\(\\Omega\\) = potential energy per unit mass\n\nThe sum remains constant as a fluid parcel moves along its streamline.\n\n\nCommon Forms of the Potential\nGravitational potential: \\[\n\\Omega = gz\n\\]\nRotating reference frame: \\[\n\\Omega = gz - \\frac{\\omega^2 r^2}{2}\n\\]\nwhere \\(\\omega\\) is the rotation rate and \\(r\\) is the distance from the rotation axis.\n\n\n\n\n\n\nTipExample: Rotating Fluid Surface\n\n\n\nIn a ‘static’ fluid in a rotating reference frame, verify that \\(\\Omega = gz - \\omega^2 r^2/2\\) predicts that the free surface takes the form of a parabola.\nSolution: At the free surface, \\(p = p_0\\) (atmospheric) and \\(\\mathbf{u}= \\mathbf{0}\\) (static). Bernoulli’s equation gives: \\[\ngz - \\frac{\\omega^2 r^2}{2} = \\text{constant}\n\\]\nTherefore: \\[\nz = z_0 + \\frac{\\omega^2 r^2}{2g}\n\\]\nThis is indeed a parabola opening upward. This is observed in rotating buckets of water and explains the shape of liquid telescope mirrors.",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#applications-of-bernoullis-equation",
    "href": "Part2-FluidDynamics/inviscid-flows.html#applications-of-bernoullis-equation",
    "title": "Steady Inviscid Flows",
    "section": "Applications of Bernoulli’s Equation",
    "text": "Applications of Bernoulli’s Equation\n\nTorricelli’s Theorem: Draining a Reservoir\n\n\n\n\n\n\nFigure 5.1: Flow from a draining tank through a small orifice\n\n\n\nConsider a large reservoir with a small drainage hole at the bottom. If the opening is much smaller than the reservoir cross-section, the water surface falls very slowly and the flow may be regarded as approximately steady.\nAt the exit (point A): - Pressure: \\(p_A = p_0\\) (atmospheric) - Velocity: \\(u_A\\) (to be determined)\nAt the surface (point B): - Pressure: \\(p_B = p_0\\) (atmospheric) - Velocity: \\(u_B \\approx 0\\) (slow descent) - Height above exit: \\(h\\)\nApplying Bernoulli’s equation along streamline AB: \\[\n\\frac{1}{2}u_A^2 + \\frac{p_0}{\\rho} = \\frac{1}{2}u_B^2 + \\frac{p_0}{\\rho} + gh\n\\]\nSince \\(u_B \\ll u_A\\):\nTorricelli’s Theorem: \\[\nu_A = \\sqrt{2gh}\n\\tag{5.2}\\]\nThe outflow speed is that of free fall from height \\(h\\) under gravity. This neglects viscous dissipation of energy.\n\n\nGeodynamic Application: Magma Ascent\nTorricelli’s theorem can be adapted to estimate magma ascent velocities. For a magma chamber at depth \\(h\\) beneath a volcanic vent: \\[\nu_{\\text{exit}} \\approx \\sqrt{2g'h}\n\\]\nwhere \\(g' = g\\Delta\\rho/\\rho\\) is the reduced gravity accounting for buoyancy. For \\(\\Delta\\rho/\\rho \\sim 0.1\\) and \\(h \\sim 5\\) km: \\[\nu_{\\text{exit}} \\sim \\sqrt{2 \\times 10 \\times 0.1 \\times 5000} \\sim 30 \\text{ m/s}\n\\]\nThis provides a rough estimate for effusive eruption velocities (actual values modified by viscosity, conduit friction, and gas content).\n\n\nStagnation Pressure and the Pitot Tube\n\n\n\n\n\n\nFigure 5.2: Flow around a bluff body showing the stagnation point\n\n\n\nSuppose a stream has uniform speed \\(U_0\\) and pressure \\(p_0\\) far from an obstacle. As it flows around a bluff body, the flow must slow down in front, creating a dividing streamline that separates fluid passing on either side. This streamline ends at a stagnation point where the velocity is zero.\nApplying Bernoulli’s equation from the free stream to the stagnation point: \\[\n\\frac{1}{2}\\rho U_0^2 + p_0 = 0 + p_{\\text{stag}}\n\\]\nStagnation Pressure: \\[\np_{\\text{stag}} = p_0 + \\frac{1}{2}\\rho U_0^2\n\\tag{5.3}\\]\nThe pressure \\(p_{\\text{stag}}\\) is the total or Pitot pressure (also called the total head), differing from the static pressure \\(p_0\\) by the dynamic pressure \\(\\frac{1}{2}\\rho U_0^2\\).\n\n\nThe Pitot Tube\n\n\n\n\n\n\nFigure 5.3: Pitot tube for measuring flow velocity via pressure measurement\n\n\n\nA Pitot tube consists of a tube directed into the stream with a small central hole connected to a manometer. At equilibrium, there is no flow through the tube, so the measured pressure is the total pressure: \\[\nU_0 = \\sqrt{\\frac{2(p_{\\text{stag}} - p_0)}{\\rho}}\n\\]\nThe static pressure \\(p_0\\) can be obtained from a static tube oriented normal to the flow.\n\n\nGeodynamic Application: Dynamic Pressure on Lithosphere\nThe concept of dynamic pressure is relevant to understanding forces on the lithosphere. For mantle flow with velocity \\(U\\) impinging on the base of the lithosphere, the dynamic pressure is: \\[\np_{\\text{dyn}} = \\frac{1}{2}\\rho U^2\n\\]\nFor typical mantle flow \\(U \\sim 50\\) mm/yr \\(= 1.6 \\times 10^{-9}\\) m/s and \\(\\rho = 3300\\) kg/m³: \\[\np_{\\text{dyn}} \\sim \\frac{1}{2} \\times 3300 \\times (1.6 \\times 10^{-9})^2 \\sim 4 \\times 10^{-15} \\text{ Pa}\n\\]\nThis is negligible compared to lithostatic pressure (~GPa), confirming that dynamic pressure effects are unimportant in mantle convection—viscous stresses dominate.",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#vector-identity-for-vorticity",
    "href": "Part2-FluidDynamics/inviscid-flows.html#vector-identity-for-vorticity",
    "title": "Steady Inviscid Flows",
    "section": "Vector Identity for Vorticity",
    "text": "Vector Identity for Vorticity\nA useful vector identity relates the advective acceleration to vorticity:\nVector Identity: \\[\n(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}= \\nabla\\left(\\frac{1}{2}|\\mathbf{u}|^2\\right) - \\mathbf{u}\\times \\boldsymbol{\\omega}\n\\tag{5.4}\\]\nwhere \\(\\boldsymbol{\\omega} = \\nabla\\times\\mathbf{u}\\) is the vorticity.\nThis identity allows us to rewrite the Euler equation as: \\[\n\\frac{\\partial \\mathbf{u}}{\\partial t} + \\nabla\\left(\\frac{1}{2}|\\mathbf{u}|^2\\right) - \\mathbf{u}\\times \\boldsymbol{\\omega} = -\\frac{1}{\\rho}\\nabla p - \\nabla\\Omega\n\\]\nFor irrotational flow where \\(\\boldsymbol{\\omega} = \\mathbf{0}\\), the equation simplifies significantly, leading to potential flow theory.",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#irrotational-flow-and-velocity-potential",
    "href": "Part2-FluidDynamics/inviscid-flows.html#irrotational-flow-and-velocity-potential",
    "title": "Steady Inviscid Flows",
    "section": "Irrotational Flow and Velocity Potential",
    "text": "Irrotational Flow and Velocity Potential\n\nDefinition\nA flow is irrotational if the vorticity vanishes everywhere: \\[\n\\nabla\\times\\mathbf{u}= \\mathbf{0}\n\\]\nFrom vector calculus, any irrotational vector field can be expressed as the gradient of a scalar velocity potential \\(\\phi\\): \\[\n\\mathbf{u}= \\nabla\\phi\n\\tag{5.5}\\]\n\n\nIncompressible Irrotational Flow\nFor incompressible flow, \\(\\nabla\\cdot\\mathbf{u}= 0\\). Substituting Equation 5.5: \\[\n\\nabla\\cdot(\\nabla\\phi) = \\nabla^2 \\phi = 0\n\\]\nLaplace’s Equation: \\[\n\\nabla^2 \\phi = 0\n\\tag{5.6}\\]\nThis is the governing equation for incompressible, irrotational (potential) flow. Laplace’s equation is linear and has extensive mathematical theory, making potential flows analytically tractable.\n\n\nBernoulli’s Equation for Irrotational Flow\nFor irrotational flow, Equation 5.4 gives: \\[\n(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}= \\nabla\\left(\\frac{1}{2}|\\mathbf{u}|^2\\right)\n\\]\nThe unsteady Euler equation becomes: \\[\n\\frac{\\partial \\mathbf{u}}{\\partial t} + \\nabla\\left(\\frac{1}{2}|\\mathbf{u}|^2\\right) = -\\frac{1}{\\rho}\\nabla p - \\nabla\\Omega\n\\]\nSince \\(\\mathbf{u}= \\nabla\\phi\\): \\[\n\\nabla\\left(\\frac{\\partial \\phi}{\\partial t}\\right) + \\nabla\\left(\\frac{1}{2}|\\nabla\\phi|^2\\right) = -\\frac{1}{\\rho}\\nabla p - \\nabla\\Omega\n\\]\nIntegrating:\nUnsteady Bernoulli’s Equation (irrotational): \\[\n\\frac{\\partial \\phi}{\\partial t} + \\frac{1}{2}|\\nabla\\phi|^2 + \\frac{p}{\\rho} + \\Omega = f(t)\n\\tag{5.7}\\]\nwhere \\(f(t)\\) is an arbitrary function of time (can be absorbed into \\(\\phi\\) by redefining the potential).\nFor steady irrotational flow: \\[\n\\frac{1}{2}|\\mathbf{u}|^2 + \\frac{p}{\\rho} + \\Omega = \\text{constant everywhere}\n\\tag{5.8}\\]\nUnlike the general case Equation 5.1, Bernoulli’s constant is the same on all streamlines for irrotational flow.\n\n\nGeodynamic Relevance of Potential Flow\nWhile the mantle is highly viscous and far from inviscid, potential flow concepts remain relevant:\n\nCore Dynamics: The liquid outer core has low viscosity; large-scale flow may approximate potential flow away from boundaries\nAtmospheric/Ocean Circulation: Geostrophic flows in rotating systems often have irrotational components\nCrustal Fluids: Groundwater flow in porous media often satisfies Laplace’s equation\nMathematical Methods: Analytical techniques from potential flow transfer to other Laplacian fields (temperature, pressure in porous media)",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#stream-function-2d-flows",
    "href": "Part2-FluidDynamics/inviscid-flows.html#stream-function-2d-flows",
    "title": "Steady Inviscid Flows",
    "section": "Stream Function (2D Flows)",
    "text": "Stream Function (2D Flows)\nFor two-dimensional incompressible flow in the \\(x\\)-\\(y\\) plane, we can define a stream function \\(\\psi(x,y)\\) such that: \\[\nu = \\frac{\\partial \\psi}{\\partial y}, \\quad v = -\\frac{\\partial \\psi}{\\partial x}\n\\tag{5.9}\\]\nThis automatically satisfies incompressibility: \\[\n\\nabla\\cdot\\mathbf{u}= \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = \\frac{\\partial^2 \\psi}{\\partial x \\partial y} - \\frac{\\partial^2 \\psi}{\\partial y \\partial x} = 0\n\\]\n\nProperties of Stream Function\n\nStreamlines are curves of constant \\(\\psi\\)\nVolume flux between two streamlines equals \\(\\Delta \\psi\\)\nFor irrotational 2D flow: \\(\\nabla^2 \\psi = 0\\) (Laplace’s equation)\n\n\n\nRelationship to Velocity Potential (2D)\nFor 2D irrotational flow, both \\(\\phi\\) and \\(\\psi\\) exist: \\[\nu = \\frac{\\partial \\phi}{\\partial x} = \\frac{\\partial \\psi}{\\partial y}, \\quad v = \\frac{\\partial \\phi}{\\partial y} = -\\frac{\\partial \\psi}{\\partial x}\n\\]\nThese are the Cauchy-Riemann equations, indicating that \\(\\phi\\) and \\(\\psi\\) are harmonic conjugates. This connects potential flow to complex analysis.",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#complex-potential-2d-flows",
    "href": "Part2-FluidDynamics/inviscid-flows.html#complex-potential-2d-flows",
    "title": "Steady Inviscid Flows",
    "section": "Complex Potential (2D Flows)",
    "text": "Complex Potential (2D Flows)\nFor 2D incompressible, irrotational flow, we can define a complex potential: \\[\nF(z) = \\phi(x,y) + i\\psi(x,y)\n\\]\nwhere \\(z = x + iy\\) is the complex coordinate.\nThe complex velocity is: \\[\nw(z) = \\frac{dF}{dz} = u - iv\n\\]\nThis powerful formulation allows us to use complex analysis to solve flow problems. Standard complex functions generate useful flow patterns:\n\nUniform flow: \\(F = U_0 z\\)\nSource/Sink: \\(F = \\frac{Q}{2\\pi}\\ln z\\)\nVortex: \\(F = -i\\frac{\\Gamma}{2\\pi}\\ln z\\)\nDoublet: \\(F = \\frac{\\mu}{z}\\)\n\nSuperposition of these elementary solutions can model complex flows around obstacles.",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#exercises",
    "href": "Part2-FluidDynamics/inviscid-flows.html#exercises",
    "title": "Steady Inviscid Flows",
    "section": "Exercises",
    "text": "Exercises\n\n\n\n\n\n\nNote\n\n\n\nExercises marked with ⭐ have worked solutions provided.\n\n\n\nExercise 1: Vector Identity ⭐\nProve the vector identity: \\[\n\\nabla(\\mathbf{a} \\cdot \\mathbf{b}) = (\\mathbf{b} \\cdot \\nabla)\\mathbf{a} + (\\mathbf{a} \\cdot \\nabla)\\mathbf{b} + \\mathbf{b} \\times (\\nabla\\times\\mathbf{a}) + \\mathbf{a} \\times (\\nabla\\times\\mathbf{b})\n\\]\nHence show that: \\[\n(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}= \\nabla\\left(\\frac{1}{2}|\\mathbf{u}|^2\\right) - \\mathbf{u}\\times \\boldsymbol{\\omega}\n\\]\nwhere \\(\\boldsymbol{\\omega} = \\nabla\\times\\mathbf{u}\\) is the vorticity.\n\n\nExercise 2: Channel Flow with Constriction ⭐\nA uniform straight open rectangular channel carries water flow of mean speed \\(U\\) and depth \\(h\\). The channel has a constriction that reduces its width by half, and it is observed that the depth of water in the constriction is only \\(h/2\\).\nBy applying Bernoulli’s theorem to a surface streamline, find \\(U\\) in terms of \\(g\\) and \\(h\\).\n\n\nExercise 3: Pressure on Buildings ⭐\nExplain why there is an increase in pressure on the side of a building facing the wind. Estimate the force per unit area on a building face when the wind speed is 100 km/hr.\nHint: Consider the stagnation point concept.\n\n\nExercise 4: Curl and Divergence\nCalculate the curl and divergence of the Cartesian velocity field: \\[\n\\mathbf{u}= \\left[z - \\frac{2x}{r}, 2y - 3z - \\frac{2y}{r}, x - 3y - \\frac{2z}{r}\\right]\n\\]\nwhere \\(r = \\sqrt{x^2 + y^2 + z^2}\\). Is this flow incompressible or irrotational?\n\n\nExercise 5: Bernoulli Paradox ⭐\nHold two sheets of paper parallel to each other with a small gap between them. Blow air between the sheets. Contrary to intuition, the sheets move together rather than apart.\nExplain this phenomenon using Bernoulli’s equation, assuming steady flow.\n\n\nExercise 6: Balloon Deflation ⭐\nUsing Bernoulli’s equation:\n\nShow that air from a balloon at excess pressure \\(p_1\\) above atmospheric will emerge with approximate speed \\(\\sqrt{2p_1/\\rho}\\)\nFind the depth of water in steady state in a vessel that is filled at constant rate \\(3 \\times 10^{-5}\\) m³/s and has a waste pipe of length 0.01 m and cross-sectional area \\(2 \\times 10^{-5}\\) m² protruding vertically below its base\n\n\n\nExercise 7: Post in River ⭐\nA vertical round post stands in a river, and it is observed that the water level at the upstream face of the post is slightly higher than the level at some distance to either side.\n\nExplain why this occurs\nFind the increase in height in terms of surface stream speed \\(U\\) and acceleration of gravity \\(g\\)\nEstimate the increase in height for a stream with undisturbed surface speed 1 m/s\n\n\n\nExercise 8: Velocity Potential for Simple Flows\nFor each of the following velocity fields, determine if the flow is irrotational. If so, find the velocity potential \\(\\phi\\):\n\n\\(\\mathbf{u}= (y, -x, 0)\\) (rigid body rotation)\n\\(\\mathbf{u}= (x, y, 0)\\) (radial flow from origin)\n\\(\\mathbf{u}= (kx, -ky, 0)\\) (hyperbolic flow)\n\n\n\nExercise 9: Geostrophic Flow in Core\nThe flow in Earth’s liquid outer core is influenced by both buoyancy and rotation. Consider a simplified model where large-scale flow is approximately geostrophic (balanced by Coriolis and pressure gradient forces).\n\nEstimate the typical velocity in the core using the geostrophic balance\nCalculate the Reynolds number for core flow\nDiscuss whether inviscid flow approximations are appropriate\n\n\n\nExercise 10: Magma Chamber Dynamics\nA magma chamber at depth \\(h = 5\\) km beneath a volcano has excess pressure \\(\\Delta p = 50\\) MPa relative to the surrounding rock. A conduit of diameter \\(d = 10\\) m opens to the surface.\n\nEstimate the exit velocity using Bernoulli’s equation (assume inviscid flow)\nCalculate the volume flux\nDiscuss limitations of the inviscid approximation for magma (typical viscosity \\(\\eta \\sim 10^3\\) Pa·s)",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#solutions-to-selected-exercises",
    "href": "Part2-FluidDynamics/inviscid-flows.html#solutions-to-selected-exercises",
    "title": "Steady Inviscid Flows",
    "section": "Solutions to Selected Exercises",
    "text": "Solutions to Selected Exercises\n\n\n\n\n\n\nTipSolution to Exercise 1: Vector Identity\n\n\n\n\n\nStart with the term \\(\\mathbf{b} \\times (\\nabla\\times\\mathbf{a})\\) in index notation: \\[\n\\begin{aligned}\n[\\mathbf{b} \\times (\\nabla\\times\\mathbf{a})]_i &= \\varepsilon_{ijk} b_j [\\nabla\\times\\mathbf{a}]_k \\\\\n&= \\varepsilon_{ijk} b_j \\varepsilon_{klm} \\frac{\\partial a_m}{\\partial x_l} \\\\\n&= \\varepsilon_{kij} \\varepsilon_{klm} b_j \\frac{\\partial a_m}{\\partial x_l}\n\\end{aligned}\n\\]\nUsing the identity \\(\\varepsilon_{kij}\\varepsilon_{klm} = \\delta_{il}\\delta_{jm} - \\delta_{im}\\delta_{jl}\\): \\[\n= (\\delta_{il}\\delta_{jm} - \\delta_{im}\\delta_{jl}) b_j \\frac{\\partial a_m}{\\partial x_l} = b_j \\frac{\\partial a_j}{\\partial x_i} - b_j \\frac{\\partial a_i}{\\partial x_j}\n\\]\nSimilarly: \\[\n[\\mathbf{a} \\times (\\nabla\\times\\mathbf{b})]_i = a_j \\frac{\\partial b_j}{\\partial x_i} - a_j \\frac{\\partial b_i}{\\partial x_j}\n\\]\nAdding these: \\[\n\\mathbf{b} \\times (\\nabla\\times\\mathbf{a}) + \\mathbf{a} \\times (\\nabla\\times\\mathbf{b}) = \\nabla(\\mathbf{a} \\cdot \\mathbf{b}) - (\\mathbf{b} \\cdot \\nabla)\\mathbf{a} - (\\mathbf{a} \\cdot \\nabla)\\mathbf{b}\n\\]\nRearranging gives the vector identity.\nFor the second part, set \\(\\mathbf{a} = \\mathbf{b} = \\mathbf{u}\\): \\[\n2\\mathbf{u}\\times \\boldsymbol{\\omega} = \\nabla|\\mathbf{u}|^2 - 2(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}\n\\]\nDividing by 2 and rearranging: \\[\n(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}= \\nabla\\left(\\frac{1}{2}|\\mathbf{u}|^2\\right) - \\mathbf{u}\\times \\boldsymbol{\\omega}\n\\]\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 2: Channel Constriction\n\n\n\n\n\nConservation of mass (volume flux):\nOutside constriction (point 1): width \\(w_1\\), depth \\(h_1 = h\\), velocity \\(u_1 = U\\)\nInside constriction (point 2): width \\(w_2 = w_1/2\\), depth \\(h_2 = h/2\\), velocity \\(u_2\\)\nVolume flux: \\(u_1 h_1 w_1 = u_2 h_2 w_2\\)\nTherefore: \\[\nu_2 = u_1 \\frac{h_1 w_1}{h_2 w_2} = U \\frac{h \\cdot w_1}{(h/2) \\cdot (w_1/2)} = 4U\n\\]\nBernoulli’s equation along surface streamline (\\(p = p_0\\) everywhere): \\[\n\\frac{u_1^2}{2} + gh_1 = \\frac{u_2^2}{2} + gh_2\n\\]\n\\[\n\\frac{U^2}{2} + gh = \\frac{(4U)^2}{2} + g\\frac{h}{2}\n\\]\n\\[\n\\frac{U^2}{2} + gh = 8U^2 + \\frac{gh}{2}\n\\]\n\\[\n\\frac{gh}{2} = \\frac{15U^2}{2}\n\\]\nResult: \\[\nU = \\sqrt{\\frac{gh}{15}}\n\\]\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 3: Building Pressure\n\n\n\n\n\nThere is a stagnation point on the upstream side of the building where the wind velocity goes to zero. From Bernoulli’s equation: \\[\n\\frac{1}{2}\\rho U_0^2 + p_0 = 0 + p_{\\text{stag}}\n\\]\nPressure increase: \\[\n\\Delta p = p_{\\text{stag}} - p_0 = \\frac{1}{2}\\rho U_0^2\n\\]\nFor wind at 100 km/hr = 27.8 m/s and air density \\(\\rho = 1.2\\) kg/m³: \\[\n\\Delta p = \\frac{1}{2} \\times 1.2 \\times (27.8)^2 \\approx 464 \\text{ Pa}\n\\]\nThis is about 0.5% of atmospheric pressure (~ 100 kPa), but represents a significant force on large building faces. For a 10 m × 10 m wall: \\[\nF = \\Delta p \\times A = 464 \\times 100 = 46.4 \\text{ kN}\n\\]\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 5: Bernoulli Paradox\n\n\n\n\n\nWhen you blow air between the two sheets, the velocity of air increases in the gap (channeling effect).\nAccording to Bernoulli’s equation along a streamline: \\[\n\\frac{1}{2}\\rho v^2 + p = \\text{constant}\n\\]\nOutside the sheets: \\(v \\approx 0\\) (still air), pressure = \\(p_0\\) (atmospheric)\nBetween the sheets: \\(v &gt; 0\\) (moving air), pressure = \\(p_{\\text{gap}}\\)\nTherefore: \\[\n\\frac{1}{2}\\rho v^2 + p_{\\text{gap}} \\approx p_0\n\\]\n\\[\np_{\\text{gap}} &lt; p_0\n\\]\nThe pressure between the sheets is lower than atmospheric pressure outside. This pressure difference pushes the sheets together.\nThis is the same principle behind: - Airplane wings generating lift - Shower curtains billowing inward - Spinning balls curving (Magnus effect)\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 6: Balloon and Tank\n\n\n\n\n\n(a) Balloon deflation:\nInside balloon: \\(p = p_0 + \\Delta p\\), \\(u \\approx 0\\) (large volume, slow movement)\nOutside (at exit): \\(p = p_0\\), \\(u = U\\) (exit velocity)\nBernoulli’s equation (ignoring gravity for a small balloon): \\[\n\\frac{0^2}{2} + \\frac{p_0 + \\Delta p}{\\rho} = \\frac{U^2}{2} + \\frac{p_0}{\\rho}\n\\]\n\\[\nU = \\sqrt{\\frac{2\\Delta p}{\\rho}}\n\\]\n(b) Tank with waste pipe:\nAt top surface: \\(u \\approx 0\\), \\(p = p_0\\), elevation = \\(H\\) (unknown)\nAt waste pipe exit: \\(u = U\\), \\(p = p_0\\), elevation = \\(-L = -0.01\\) m\nBernoulli’s equation: \\[\n0 + \\frac{p_0}{\\rho} + gH = \\frac{U^2}{2} + \\frac{p_0}{\\rho} + g(-L)\n\\]\n\\[\nH = \\frac{U^2}{2g} - L\n\\]\nVolume conservation (steady state): \\[\nU \\cdot A_{\\text{pipe}} = Q_{\\text{in}}\n\\]\n\\[\nU = \\frac{3 \\times 10^{-5}}{2 \\times 10^{-5}} = 1.5 \\text{ m/s}\n\\]\nTherefore: \\[\nH = \\frac{(1.5)^2}{2 \\times 10} - 0.01 = 0.1125 - 0.01 = 0.1025 \\text{ m} \\approx 10.3 \\text{ cm}\n\\]\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 7: Post in River\n\n\n\n\n\n(a) Explanation:\nAt the upstream face of the post, there is a stagnation point where the water velocity becomes zero as it diverts around the post. According to Bernoulli’s equation, where velocity decreases, pressure (and hence water level) must increase.\n(b) Height increase:\nFar from post: velocity = \\(U\\), pressure at surface = \\(p_0\\), height = \\(h_0\\)\nAt stagnation point: velocity = 0, pressure at surface = \\(p_{\\text{stag}}\\), height = \\(h_0 + \\Delta h\\)\nBernoulli’s equation along surface: \\[\n\\frac{U^2}{2} + p_0 + \\rho g h_0 = 0 + p_{\\text{stag}} + \\rho g(h_0 + \\Delta h)\n\\]\nSince pressure varies hydrostatically near the surface: \\(p_{\\text{stag}} = p_0 + \\rho g \\Delta h\\)\nSubstituting: \\[\n\\frac{U^2}{2} + p_0 + \\rho g h_0 = p_0 + \\rho g \\Delta h + \\rho g h_0 + \\rho g \\Delta h\n\\]\n\\[\n\\frac{U^2}{2} = 2\\rho g \\Delta h\n\\]\nWait, let me reconsider. Actually, at the free surface, \\(p = p_0\\) everywhere. The height change creates the pressure difference:\n\\[\n\\frac{U^2}{2} + gh_0 = 0 + g(h_0 + \\Delta h)\n\\]\nHeight increase: \\[\n\\Delta h = \\frac{U^2}{2g}\n\\]\n(c) Numerical estimate:\nFor \\(U = 1\\) m/s: \\[\n\\Delta h = \\frac{1^2}{2 \\times 10} = 0.05 \\text{ m} = 5 \\text{ cm}\n\\]\nThis is easily observable!",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#summary",
    "href": "Part2-FluidDynamics/inviscid-flows.html#summary",
    "title": "Steady Inviscid Flows",
    "section": "Summary",
    "text": "Summary\nThis chapter introduced inviscid flow theory and Bernoulli’s equation, fundamental tools for understanding fluid motion:\n\nBernoulli’s equation expresses energy conservation along streamlines in inviscid flow\nStagnation pressure occurs where flow velocity reaches zero\nTorricelli’s theorem describes drainage from reservoirs\nIrrotational flows can be described by a velocity potential satisfying Laplace’s equation\nStream functions provide an alternative description for 2D incompressible flow\nComplex potentials enable powerful analytical solutions using complex analysis\n\nWhile geodynamic flows are generally viscous, inviscid theory provides: - Fundamental insights into flow topology - Limiting case benchmarks - Mathematical techniques applicable to related fields - Understanding of large-scale circulation patterns\nIn the next chapter, we examine vortex motion and the dynamics of vorticity, building on these inviscid flow concepts.",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part2-FluidDynamics/inviscid-flows.html#references",
    "href": "Part2-FluidDynamics/inviscid-flows.html#references",
    "title": "Steady Inviscid Flows",
    "section": "References",
    "text": "References\nThe material in this chapter is adapted from:\n\nMTH3360 Incompressible Fluid Mechanics, Louis Moresi, Monash University, 2010-2013\nBatchelor (1967): An Introduction to Fluid Dynamics - comprehensive treatment of potential flow\nAcheson (1990): Elementary Fluid Dynamics - accessible introduction with applications\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAcheson, D. J. 1990. Elementary Fluid Dynamics. Oxford University Press.\n\n\nBatchelor, G. K. 1967. An Introduction to Fluid Dynamics. Cambridge University Press.",
    "crumbs": [
      "Introduction",
      "**Part II: Fluid Dynamics**",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Steady Inviscid Flows</span>"
    ]
  },
  {
    "objectID": "Part3-Geodynamics/placeholder.html",
    "href": "Part3-Geodynamics/placeholder.html",
    "title": "Geodynamics Applications",
    "section": "",
    "text": "Content to be added from migration\nThis part will cover: - Mantle dynamics - Thermal convection - Lithospheric dynamics - Plate tectonics",
    "crumbs": [
      "Introduction",
      "**Part III: Geodynamics**",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Geodynamics Applications</span>"
    ]
  },
  {
    "objectID": "Part4-NumericalMethods/placeholder.html",
    "href": "Part4-NumericalMethods/placeholder.html",
    "title": "Numerical Methods",
    "section": "",
    "text": "Content to be added from migration\nThis part will cover: - Finite differences - Finite elements - Spectral methods - Time integration schemes",
    "crumbs": [
      "Introduction",
      "**Part IV: Numerical Methods**",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Numerical Methods</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/placeholder.html",
    "href": "Part5-Computational/placeholder.html",
    "title": "Computational Exercises",
    "section": "",
    "text": "Content to be added from migration\nThis part will contain hands-on computational exercises using Python.",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Computational Exercises</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "",
    "text": "Introduction\nAnalytical solutions to the Navier-Stokes equations are rare and precious. They serve multiple critical purposes in computational geodynamics:\nThis chapter presents a collection of analytical solutions for viscous flows, focusing on one-dimensional problems where the nonlinear advection term vanishes, making exact solutions possible. While these flows are geometrically simple, they capture essential physics relevant to geodynamics:",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#introduction",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#introduction",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "",
    "text": "Code Validation: Compare numerical solutions against exact analytical results to verify implementation correctness\nConvergence Testing: Measure numerical error as a function of resolution to confirm expected convergence rates\nPhysical Intuition: Build understanding of viscous flow behavior through exact solutions\nBenchmark Standards: Establish community-accepted test cases for comparing different numerical methods\n\n\n\nCouette flow: Simple shear, analogous to lithospheric deformation\nPoiseuille flow: Pressure-driven flow, relevant to channel flows and magma transport\nPipe flow: Axisymmetric geometry, applicable to cylindrical conduits\nOscillating boundaries: Time-dependent flows with diffusion\n\n\n\n\n\n\n\nNoteMaterial adapted from MTH3360 Fluid Mechanics\n\n\n\nThe problems in this chapter are adapted from the MTH3360 Incompressible Fluid Mechanics course materials (Monash University, 2010-2013). These classical fluid mechanics problems provide excellent benchmarks for computational geodynamics codes.",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#one-dimensional-flows",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#one-dimensional-flows",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "One-Dimensional Flows",
    "text": "One-Dimensional Flows\n\nWhy the Nonlinear Term Vanishes\nThe central difficulty in solving the Navier-Stokes equations lies in the nonlinear advection term \\((\\mathbf{u}\\cdot \\nabla) \\mathbf{u}\\). However, in one-dimensional flows where only a single component of velocity is non-zero, say \\(\\mathbf{u}= (0, 0, w)\\), this term vanishes.\nFrom continuity (incompressibility): \\[\n\\nabla\\cdot\\mathbf{u}= \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z} = 0\n\\]\nSince \\(u = v = 0\\), we have \\(\\partial w / \\partial z = 0\\), meaning \\(w\\) is independent of \\(z\\). Therefore:\n\\[\n\\begin{aligned}\n(\\mathbf{u}\\cdot \\nabla) \\mathbf{u}&= \\left( u\\frac{\\partial}{\\partial x} + v\\frac{\\partial}{\\partial y} + w\\frac{\\partial}{\\partial z} \\right) (u, v, w) \\\\\n&= \\left( 0, 0, w\\frac{\\partial w}{\\partial z} \\right) \\\\\n&= \\mathbf{0}\n\\end{aligned}\n\\]\nThis linearization allows us to find exact analytical solutions to many problems.",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#steady-plane-couette-flow",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#steady-plane-couette-flow",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "Steady Plane Couette Flow",
    "text": "Steady Plane Couette Flow\n\nProblem Statement\nConsider steady viscous flow between two parallel rigid plates:\n\nLower plate at \\(z = 0\\): fixed (\\(\\mathbf{u}= \\mathbf{0}\\))\nUpper plate at \\(z = h\\): moving with velocity \\((U, 0, 0)\\)\nFlow independent of \\(x\\) and \\(y\\) directions\nNo applied pressure gradient\n\n\n\n\n\n\n\nFigure 9.1: Couette flow: Linear velocity profile between moving plates\n\n\n\n\n\nSolution\nFrom the symmetry assumptions and continuity, we know: - \\(w = 0\\) everywhere - \\(\\mathbf{u}= (u(z), 0, 0)\\)\nThe Navier-Stokes equations reduce to: \\[\n0 = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} + \\nu\\frac{d^2 u}{dz^2}\n\\]\nSince there’s no applied pressure gradient in the \\(x\\)-direction, \\(\\partial p/\\partial x = 0\\), giving: \\[\n\\frac{d^2 u}{dz^2} = 0\n\\]\nThis integrates to: \\[\nu = Az + B\n\\]\nApplying boundary conditions: - At \\(z = 0\\): \\(u = 0 \\Rightarrow B = 0\\) - At \\(z = h\\): \\(u = U \\Rightarrow A = U/h\\)\nAnalytical Solution: \\[\nu(z) = U\\frac{z}{h}\n\\tag{9.1}\\]\n\n\nPhysical Interpretation\n\nVelocity profile: Linear from \\(0\\) to \\(U\\)\nVorticity: Constant throughout the fluid, \\(\\omega = \\partial u/\\partial z = U/h\\)\nShear stress: Constant, \\(\\tau = \\mu(du/dz) = \\mu U/h\\)\nStress transmission: The tangential stress exerted by the upper plate is transmitted without change to the lower plate\n\n\n\nGeodynamic Relevance\nCouette flow is the fundamental model for: - Simple shear deformation in the lithosphere - Shear zones in the mantle - Flow between tectonic plates - Laboratory experiments (rotary shear apparatus)",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#steady-plane-poiseuille-flow",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#steady-plane-poiseuille-flow",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "Steady Plane Poiseuille Flow",
    "text": "Steady Plane Poiseuille Flow\n\nProblem Statement\nSteady viscous flow driven by a pressure gradient between two parallel fixed plates:\n\nBoth plates at \\(z = 0\\) and \\(z = h\\): no-slip (\\(\\mathbf{u}= \\mathbf{0}\\))\nApplied pressure gradient: \\(dp/dx &lt; 0\\) (pressure decreases in flow direction)\nFlow independent of \\(x\\) and \\(y\\) positions\n\n\n\n\n\n\n\nFigure 9.2: Poiseuille flow: Parabolic velocity profile in pressure-driven channel flow\n\n\n\n\n\nSolution\nFrom continuity and boundary conditions: - \\(w = 0\\) everywhere - \\(\\mathbf{u}= (u(z), 0, 0)\\)\nThe Navier-Stokes equations give: \\[\n0 = -\\frac{1}{\\rho}\\frac{\\partial p}{\\partial x} + \\nu\\frac{d^2 u}{dz^2}\n\\]\nNow \\(p = p(x)\\) only, and \\(u = u(z)\\) only. Both sides must equal a constant. Let: \\[\n\\frac{dp}{dx} = -\\gamma \\quad \\text{(constant)}\n\\]\nwhere \\(\\gamma &gt; 0\\) for flow in the positive \\(x\\)-direction. Then: \\[\n\\frac{d^2 u}{dz^2} = -\\frac{\\gamma}{\\mu}\n\\]\nIntegrating twice: \\[\nu = -\\frac{\\gamma}{2\\mu}z^2 + Az + B\n\\]\nApplying boundary conditions: - At \\(z = 0\\): \\(u = 0 \\Rightarrow B = 0\\) - At \\(z = h\\): \\(u = 0 \\Rightarrow A = \\gamma h/(2\\mu)\\)\nAnalytical Solution: \\[\nu(z) = \\frac{\\gamma}{2\\mu}z(h - z)\n\\tag{9.2}\\]\n\n\nPhysical Interpretation\n\nVelocity profile: Parabolic with maximum at \\(z = h/2\\)\nMaximum velocity: \\(u_{max} = \\gamma h^2/(8\\mu)\\)\nVolume flux per unit width: \\(Q = \\int_0^h u \\, dz = \\gamma h^3/(12\\mu)\\)\nShear stress: \\(\\tau = \\gamma(h - 2z)/2\\), zero at centerline, maximum at walls\nVorticity: \\(\\omega = \\gamma(h - 2z)/(2\\mu)\\), positive at lower wall, negative at upper wall\n\n\n\nGeodynamic Relevance\nPoiseuille flow models: - Channel flows in the mantle - Flow in magma-filled fractures and dikes - Pressure-driven flow in laboratory experiments - Return flow in subduction zones",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#axisymmetric-pipe-flow-hagen-poiseuille-flow",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#axisymmetric-pipe-flow-hagen-poiseuille-flow",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "Axisymmetric Pipe Flow (Hagen-Poiseuille Flow)",
    "text": "Axisymmetric Pipe Flow (Hagen-Poiseuille Flow)\n\nProblem Statement\nSteady viscous flow through a cylindrical pipe of radius \\(a\\) under a constant applied pressure gradient:\n\nNo-slip boundary condition at \\(r = a\\): \\(w = 0\\)\nAxisymmetric flow: no dependence on \\(\\theta\\)\nApplied pressure gradient: \\(dp/dz = -\\gamma\\)\n\n\n\n\n\n\n\nFigure 9.3: Pipe flow: Parabolic velocity profile in a circular pipe\n\n\n\n\n\nSolution\nIn cylindrical coordinates \\((r, \\theta, z)\\), assume \\(\\mathbf{U} = (u(r), 0, w(r))\\).\nFrom continuity in cylindrical coordinates: \\[\n\\frac{1}{r}\\frac{\\partial}{\\partial r}(ru) + \\frac{\\partial w}{\\partial z} = 0\n\\]\nSince \\(w = w(r)\\) only, this gives \\(u(r) = 0\\).\nThe momentum balance in the \\(z\\)-direction becomes: \\[\n-\\frac{1}{\\rho}\\frac{\\partial p}{\\partial z} + \\frac{\\nu}{r}\\frac{d}{dr}\\left(r\\frac{dw}{dr}\\right) = 0\n\\]\nSince \\(p = p(z)\\) only and \\(w = w(r)\\) only: \\[\n\\frac{dp}{dz} = -\\gamma \\quad \\text{(constant)}\n\\]\n\\[\n\\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{dw}{dr}\\right) = -\\frac{\\gamma}{\\mu}\n\\]\nThe general solution is: \\[\nw = -\\frac{\\gamma r^2}{4\\mu} + A\\ln r + B\n\\]\nBoundary conditions: - Finite at \\(r = 0\\): \\(A = 0\\) - \\(w(a) = 0\\): \\(B = \\gamma a^2/(4\\mu)\\)\nAnalytical Solution: \\[\nw(r) = \\frac{\\gamma a^2}{4\\mu}\\left(1 - \\frac{r^2}{a^2}\\right)\n\\tag{9.3}\\]\n\n\nPhysical Interpretation\n\nVelocity profile: Parabolic in \\(r\\)\nMaximum velocity: \\(w_{max} = \\gamma a^2/(4\\mu)\\) at \\(r = 0\\)\nVolume flux: \\(Q = \\int_0^a w \\cdot 2\\pi r \\, dr = \\pi\\gamma a^4/(8\\mu)\\)\nAverage velocity: \\(\\bar{w} = Q/(\\pi a^2) = \\gamma a^2/(8\\mu) = w_{max}/2\\)\n\n\n\nGeodynamic Relevance\nPipe flow is relevant to: - Magma ascent through cylindrical conduits - Fluid flow in porous media (Darcy flow in cylindrical pores) - Laboratory experiments with cylindrical geometry - Core dynamics in cylindrical coordinates",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#mixed-couette-poiseuille-flow",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#mixed-couette-poiseuille-flow",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "Mixed Couette-Poiseuille Flow",
    "text": "Mixed Couette-Poiseuille Flow\n\nProblem Statement\nFlow driven by both a moving upper plate and a pressure gradient:\n\nLower plate at \\(z = 0\\): fixed\nUpper plate at \\(z = h\\): velocity \\((U, 0, 0)\\)\nApplied pressure gradient: \\(dp/dx = -\\gamma\\)\n\nThis combines simple shear and pressure-driven flow.\n\n\nSolution\nThe governing equation is: \\[\n\\frac{d^2 u}{dz^2} = -\\frac{\\gamma}{\\mu}\n\\]\nwith boundary conditions \\(u(0) = 0\\) and \\(u(h) = U\\).\nAnalytical Solution: \\[\nu(z) = \\frac{\\gamma}{2\\mu}z(h - z) + U\\frac{z}{h}\n\\tag{9.4}\\]\nThis is simply the superposition of Poiseuille flow Equation 9.2 and Couette flow Equation 9.1.\n\n\nZero Net Flux Condition\nThe volume flux per unit width is: \\[\nQ = \\int_0^h u \\, dz = \\frac{\\gamma h^3}{12\\mu} + \\frac{Uh}{2}\n\\]\nFor zero net flux (\\(Q = 0\\)), the required pressure gradient is: \\[\n\\gamma = -\\frac{6\\mu U}{h^2}\n\\]\nThe negative value indicates the pressure gradient opposes the plate motion.",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#time-dependent-problems",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#time-dependent-problems",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "Time-Dependent Problems",
    "text": "Time-Dependent Problems\n\nOscillating Plate (Stokes’ Second Problem)\nAn incompressible fluid occupies the half-space \\(z &gt; 0\\) above a rigid boundary at \\(z = 0\\) that oscillates with velocity \\(U\\cos(\\alpha t)\\).\nThe velocity field \\(\\mathbf{u}= (u(z,t), 0, 0)\\) satisfies: \\[\n\\frac{\\partial u}{\\partial t} = \\nu\\frac{\\partial^2 u}{\\partial z^2}\n\\tag{9.5}\\]\nThis is the heat/diffusion equation with kinematic viscosity \\(\\nu\\) playing the role of thermal diffusivity.\nSeeking a solution of the form \\(u = \\text{Re}\\{f(z)e^{i\\alpha t}\\}\\) and requiring \\(u \\to 0\\) as \\(z \\to \\infty\\):\nAnalytical Solution: \\[\nu(z,t) = Ue^{-kz}\\cos(kz - \\alpha t)\n\\tag{9.6}\\]\nwhere \\(k = \\sqrt{\\alpha/(2\\nu)}\\) is the inverse penetration depth.\n\n\nPhysical Interpretation\n\nPenetration depth: \\(\\delta = 1/k = \\sqrt{2\\nu/\\alpha}\\)\nVelocity amplitude decays exponentially with distance from the plate\nPhase lag increases linearly with distance\nAt distance \\(z = \\pi/k\\), the fluid moves in the opposite direction to the plate\n\nThis solution demonstrates viscous diffusion of momentum from the oscillating boundary into the fluid.",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#exercises",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#exercises",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "Exercises",
    "text": "Exercises\n\n\n\n\n\n\nNote\n\n\n\nExercises marked with ⭐ have worked solutions provided.\n\n\n\nExercise 1: Mixed Couette-Poiseuille Flow ⭐\nMixed Couette-Poiseuille flow is driven by moving the upper plate at \\(z = h\\) with velocity \\(U\\) and applying an opposing pressure gradient \\(dp/dx = \\gamma &gt; 0\\) (opposing means the pressure gradient acts against the plate motion).\n\nFind the velocity profile in the flow\nCalculate the volume flux per unit width\nDetermine the pressure gradient required to produce zero net volume flux\n\n\n\nExercise 2: Time-Dependent Couette Flow\nA viscous fluid at rest is confined between two rigid plates at \\(z = 0\\) and \\(z = h\\). The lower boundary is fixed, but at \\(t = 0\\) the upper boundary is impulsively set in motion with velocity \\((U, 0, 0)\\).\n\nShow that the velocity field satisfies the diffusion equation Equation 9.5\nCalculate the velocity profile as a function of time\nDetermine the vorticity distribution as a function of time\nSketch the velocity profile at several times and show convergence to the steady Couette solution\n\nHint: Use separation of variables with \\(u(z,t) = \\sum_n A_n \\sin(n\\pi z/h)e^{-\\lambda_n t}\\)\n\n\nExercise 3: Cylindrical Pipe Flow ⭐\nDerive the solution for steady viscous flow through an axisymmetric pipe of radius \\(a\\) under a constant applied pressure gradient (Hagen-Poiseuille flow).\n\nShow that \\(u_r = 0\\) from continuity\nDerive the governing equation for \\(u_z(r)\\)\nSolve with appropriate boundary conditions\nCalculate the volume flux\nCompare the average velocity to the maximum velocity\n\nReminder: In cylindrical coordinates for axisymmetric problems: \\[\n\\nabla^2 f = \\frac{1}{r}\\frac{\\partial}{\\partial r}\\left(r\\frac{\\partial f}{\\partial r}\\right) + \\frac{\\partial^2 f}{\\partial z^2}\n\\]\n\n\nExercise 4: Vorticity Generation in Poiseuille Flow ⭐\nConsider the plane Poiseuille flow problem.\n\nShow that negative/positive vorticity is continuously generated at the upper/lower boundary\nExplain the mechanism of vorticity generation at solid boundaries\nConsider the time-dependent problem where the flow is impulsively accelerated by a uniform pressure gradient\nShow that the unsteady component of velocity satisfies the heat equation\nDetermine the initial condition for this equation\n\n\n\nExercise 5: Flow Down an Inclined Plane\nConsider a thin film of viscous fluid flowing down an inclined plane at angle \\(\\theta\\) to the horizontal under gravity.\n\nSet up the coordinate system and governing equations\nDetermine the velocity profile assuming the upper surface is stress-free\nCalculate the volume flux per unit width\nFind the maximum velocity and its location\nDiscuss the physical meaning of the stress-free boundary condition\n\n\n\nExercise 6: Hele-Shaw Flow\nIn a thin film of fluid confined between two rigid boundaries separated by a small gap \\(h\\), where \\(h \\ll L\\) (with \\(L\\) a typical horizontal length scale):\n\nShow from incompressibility that the vertical velocity \\(W\\) satisfies \\(W \\sim U(h/L)\\)\nShow that \\(\\eta\\nabla^2\\mathbf{u}\\sim \\eta\\partial^2\\mathbf{u}/\\partial z^2\\)\nBy estimating the magnitude of terms, show that \\((\\mathbf{u}\\cdot\\nabla)\\mathbf{u}\\ll \\eta\\partial^2\\mathbf{u}/\\partial z^2\\) when \\(Re(h^2/L^2) \\ll 1\\)\nDerive the governing equations for steady flow\nShow that the flow is always irrotational\nExplain why the Hele-Shaw cell is used to model potential flow experimentally",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#computational-exercises",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#computational-exercises",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "Computational Exercises",
    "text": "Computational Exercises\n\n\n\n\n\n\nTipPython Implementation\n\n\n\nThe following exercises ask you to implement numerical solutions and compare them to the analytical results. This is essential practice for validating computational methods.\n\n\n\nComputational Exercise 1: Implement Couette Flow\nWrite a Python program to solve the Couette flow problem numerically using finite differences:\n\nDiscretize the domain \\([0, h]\\) with \\(N\\) grid points\nImplement the steady-state solver using the discrete Laplacian\nCompare your numerical solution to the analytical solution Equation 9.1\nPlot the error as a function of grid resolution\nVerify that the error decreases as \\(\\Delta z^2\\) (second-order convergence)\n\n\n\nComputational Exercise 2: Implement Poiseuille Flow\nRepeat Computational Exercise 1 for Poiseuille flow:\n\nImplement the steady-state solver\nCompare to the analytical solution Equation 9.2\nCalculate the volume flux numerically and compare to the analytical value\nTest convergence with grid refinement\n\n\n\nComputational Exercise 3: Time-Dependent Couette Flow\nImplement the time-dependent Couette flow problem (Exercise 2):\n\nUse the forward Euler method or Crank-Nicolson method for time stepping\nImplement appropriate initial and boundary conditions\nAnimate the evolution of the velocity profile\nCompare to the analytical solution (look up the series solution)\nInvestigate the diffusion time scale: how long to reach steady state?\n\n\n\nComputational Exercise 4: Pipe Flow in Cylindrical Coordinates\nImplement the axisymmetric pipe flow solution:\n\nSet up the problem in cylindrical coordinates\nHandle the singularity at \\(r = 0\\) properly\nCompare to the analytical solution Equation 9.3\nCalculate volume flux and verify against analytical result\nExplore convergence properties with grid refinement",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#solutions-to-selected-exercises",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#solutions-to-selected-exercises",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "Solutions to Selected Exercises",
    "text": "Solutions to Selected Exercises\n\n\n\n\n\n\nTipSolution to Exercise 1: Mixed Couette-Poiseuille Flow\n\n\n\n\n\n(a) Velocity profile:\nThe governing equation is: \\[\n\\frac{d^2 u}{dz^2} = -\\frac{\\gamma}{\\mu}\n\\]\nIntegrating twice: \\[\nu = -\\frac{\\gamma}{2\\mu}z^2 + Az + B\n\\]\nBoundary conditions: - At \\(z = 0\\): \\(u = 0 \\Rightarrow B = 0\\) - At \\(z = h\\): \\(u = U \\Rightarrow A = U/h + \\gamma h/(2\\mu)\\)\nTherefore: \\[\nu(z) = \\frac{z}{h}\\left(U + \\frac{\\gamma h^2}{2\\mu}\\right) - \\frac{\\gamma z^2}{2\\mu}\n\\]\nSince the pressure gradient opposes the plate motion (\\(\\gamma &gt; 0\\)), the term \\(-\\gamma z^2/(2\\mu)\\) reduces the velocity.\n(b) Volume flux:\n\\[\nQ = \\int_0^h u \\, dz = \\frac{Uh}{2} + \\frac{\\gamma h^3}{12\\mu} - \\frac{\\gamma h^3}{6\\mu} = \\frac{Uh}{2} - \\frac{\\gamma h^3}{12\\mu}\n\\]\n(c) Zero flux condition:\nSetting \\(Q = 0\\): \\[\n\\frac{Uh}{2} = \\frac{\\gamma h^3}{12\\mu}\n\\]\n\\[\n\\gamma = \\frac{6\\mu U}{h^2}\n\\]\nThis is the pressure gradient magnitude required to exactly oppose the plate-driven flow.\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 3: Cylindrical Pipe Flow\n\n\n\n\n\n(a) Continuity:\nIn cylindrical coordinates: \\[\n\\frac{1}{r}\\frac{\\partial}{\\partial r}(ru_r) + \\frac{\\partial u_z}{\\partial z} = 0\n\\]\nSince we assume \\(u_z = u_z(r)\\) only (axisymmetric, fully-developed flow), \\(\\partial u_z/\\partial z = 0\\), which gives: \\[\n\\frac{1}{r}\\frac{d}{dr}(ru_r) = 0\n\\]\nIntegrating: \\(ru_r = \\text{constant}\\). Since \\(u_r\\) must be finite at \\(r = 0\\), the constant must be zero, so \\(u_r = 0\\).\n(b) Governing equation:\nThe \\(z\\)-component of the Navier-Stokes equation (steady, axisymmetric) is: \\[\n-\\frac{1}{\\rho}\\frac{\\partial p}{\\partial z} + \\frac{\\nu}{r}\\frac{d}{dr}\\left(r\\frac{du_z}{dr}\\right) = 0\n\\]\nSince \\(p = p(z)\\) and \\(u_z = u_z(r)\\): \\[\n\\frac{dp}{dz} = -\\gamma \\quad \\text{(constant)}\n\\]\n\\[\n\\frac{1}{r}\\frac{d}{dr}\\left(r\\frac{du_z}{dr}\\right) = -\\frac{\\gamma}{\\mu}\n\\]\n(c) Solution:\nIntegrating once: \\[\nr\\frac{du_z}{dr} = -\\frac{\\gamma r^2}{2\\mu} + C_1\n\\]\nFor finite velocity at \\(r = 0\\): \\(C_1 = 0\\). Integrating again: \\[\nu_z = -\\frac{\\gamma r^2}{4\\mu} + C_2\n\\]\nBoundary condition \\(u_z(a) = 0\\) gives \\(C_2 = \\gamma a^2/(4\\mu)\\): \\[\nu_z(r) = \\frac{\\gamma a^2}{4\\mu}\\left(1 - \\frac{r^2}{a^2}\\right)\n\\]\n(d) Volume flux:\n\\[\nQ = \\int_0^a u_z \\cdot 2\\pi r \\, dr = 2\\pi\\frac{\\gamma a^2}{4\\mu}\\int_0^a \\left(1 - \\frac{r^2}{a^2}\\right)r \\, dr\n\\]\n\\[\nQ = \\frac{\\pi\\gamma a^2}{2\\mu}\\left[\\frac{r^2}{2} - \\frac{r^4}{4a^2}\\right]_0^a = \\frac{\\pi\\gamma a^4}{8\\mu}\n\\]\n(e) Velocity comparison:\n\nMaximum velocity: \\(u_{max} = \\gamma a^2/(4\\mu)\\) at \\(r = 0\\)\nAverage velocity: \\(\\bar{u} = Q/(\\pi a^2) = \\gamma a^2/(8\\mu)\\)\nRatio: \\(\\bar{u}/u_{max} = 1/2\\)\n\nThe average velocity is exactly half the maximum velocity for parabolic pipe flow.\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 4: Vorticity in Poiseuille Flow\n\n\n\n\n\n(a) Vorticity distribution:\nFor plane Poiseuille flow Equation 9.2: \\[\nu = \\frac{\\gamma z}{2\\mu}(h - z)\n\\]\nThe vorticity (for 2D flow in the \\(x\\)-\\(z\\) plane) is: \\[\n\\omega = \\frac{du}{dz} = \\frac{\\gamma}{2\\mu}(h - 2z)\n\\]\nAt the boundaries: - At \\(z = 0\\): \\(\\omega = \\gamma h/(2\\mu) &gt; 0\\) (positive vorticity) - At \\(z = h\\): \\(\\omega = -\\gamma h/(2\\mu) &lt; 0\\) (negative vorticity) - At \\(z = h/2\\): \\(\\omega = 0\\) (vorticity cancels)\n(b) Mechanism:\nVorticity is generated at solid boundaries through the no-slip condition. The boundary continuously generates vorticity that diffuses into the interior. The rate of vorticity generation is proportional to the velocity gradient at the wall.\n(c-d) Time-dependent problem:\nFor the impulsive start problem, let \\(\\mathbf{u}= (u(z,t), 0, 0)\\). From continuity: \\(w = 0\\).\nThe \\(x\\)-momentum equation is: \\[\n\\frac{\\partial u}{\\partial t} = -\\frac{1}{\\rho}\\frac{dp_0}{dx} + \\nu\\frac{\\partial^2 u}{\\partial z^2}\n\\]\nSince \\(dp_0/dx = -\\gamma\\) (constant), this is: \\[\n\\frac{\\partial u}{\\partial t} = \\frac{\\gamma}{\\rho} + \\nu\\frac{\\partial^2 u}{\\partial z^2}\n\\]\n(e) Initial condition:\nAt \\(t = 0\\), the fluid is at rest: \\(u(z, 0) = 0\\). The boundary conditions are \\(u(0,t) = u(h,t) = 0\\) for all \\(t &gt; 0\\).\nThe steady-state solution is the Poiseuille profile. The unsteady solution approaches this as \\(t \\to \\infty\\).",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#summary",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#summary",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "Summary",
    "text": "Summary\nThis chapter presented fundamental analytical solutions for viscous flows that serve as essential benchmarks for validating computational geodynamics codes. Key takeaways:\n\nOne-dimensional flows provide exact solutions because the nonlinear advection term vanishes\nCouette flow (simple shear) and Poiseuille flow (pressure-driven) are fundamental building blocks\nCylindrical geometries (pipe flow) extend these concepts to axisymmetric cases\nTime-dependent problems demonstrate viscous diffusion of momentum\nNumerical validation against these solutions is essential for code verification\n\nIn the following chapters, we will use these benchmark problems to validate more complex numerical methods including finite differences, finite elements, and spectral methods.",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "Part5-Computational/Benchmarks/analytical-solutions.html#references",
    "href": "Part5-Computational/Benchmarks/analytical-solutions.html#references",
    "title": "Benchmark Problems: Analytical Solutions for Viscous Flows",
    "section": "References",
    "text": "References\nThe material in this chapter is adapted from:\n\nMTH3360 Incompressible Fluid Mechanics, Louis Moresi, Monash University, 2010-2013\nBatchelor (1967): An Introduction to Fluid Dynamics\nAcheson (1990): Elementary Fluid Dynamics\n\nAdditional recommended references for analytical solutions:\n\nTurcotte and Schubert (2014): Chapter on viscous flow\nWhite (2006): Viscous Fluid Flow, for comprehensive treatment of exact solutions\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAcheson, D. J. 1990. Elementary Fluid Dynamics. Oxford University Press.\n\n\nBatchelor, G. K. 1967. An Introduction to Fluid Dynamics. Cambridge University Press.\n\n\nTurcotte, D., and G. Schubert. 2014. Geodynamics. 3rd ed. Cambridge University Press.\n\n\nWhite, F. M. 2006. Viscous Fluid Flow. 3rd ed. McGraw-Hill.",
    "crumbs": [
      "Introduction",
      "**Part V: Computational Exercises**",
      "<span class='chapter-number'>9</span>  <span class='chapter-title'>Benchmark Problems: Analytical Solutions for Viscous Flows</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ContinuumMechanics.html",
    "href": "DraftMaterial/ContinuumMechanics.html",
    "title": "Conservation Laws",
    "section": "",
    "text": "Conservation of mass\nWe start by deriving the equations of motion, energy balance and so on through a conservation principle. This will give a useful insight into the different forms of the equations which we will later encounter.\nA general conservation law does not distinguish the quantity which is being conserved – it is a mathematical identity. Consider a quantity \\(\\phi\\) / unit mass which is carried around by a fluid. We can draw an arbitrary volume, \\(\\Omega\\) to contain some amount of this fluid at a given time. We label the surface of the volume \\(\\Omega\\) as \\(\\Gamma\\), and define an outward vector \\(\\mathbf{d}\\boldsymbol{\\Gamma}\\) which is normal to the surface and represents an infinitesimally small element on the surface. \\(\\mathbf{d}\\boldsymbol{\\Gamma}\\) has a magnitude equal to the area of this element.\nIn general, we also need to define a source/sink term, \\(H\\) / unit mass which generates/consumes the quantity \\(\\phi\\), and a flux term, \\(\\mathbf{F}\\) which is the “leakage” occurs across the surface when the fluid is stationary (e.g. this might represent diffusion of \\(\\phi\\)). The rate of change of \\(\\phi\\) is given by combining the contribution due to the source term, the stationary flux term, and the effect of motion of the fluid.\n\\[\n\\frac{d}{dt} \\int_{\\Omega} \\rho \\phi d\\Omega =\n            - \\int_{\\Gamma} \\mathbf{F} \\cdot \\mathbf{d}\\boldsymbol{\\Gamma}\n            + \\int_{\\Omega} \\rho H d\\Omega\n            - \\int _{\\Gamma} \\rho \\phi \\mathbf{v} \\cdot \\mathbf{d}\\boldsymbol{\\Gamma}\n\\tag{10.1}\\]\nwhere the final term is the change due to the fluid carrying \\(\\phi\\) through the volume. Fluxes are positive outward (by our definition of \\(\\mathbf{d}\\boldsymbol{\\Gamma}\\)), so a positive flux reduces \\(\\phi\\) within \\(d\\Omega\\) and negative signs are needed for these terms.\nWe can use Gauss’ theorem to write surface integrals as volume integrals:\n\\[\\int_{\\Gamma} \\phi \\mathbf{u} \\cdot \\mathbf{d}\\boldsymbol{\\Gamma}= \\int_{\\Omega}  \\nabla \\cdot (\\phi \\mathbf{u}) d\\Omega\\]\nOne more thing: the test surface, \\(\\Gamma\\), and volume, \\(\\Omega\\) are assumed to be fixed in the lab reference frame which means that the order of integration and differentiation can be interchanged\n\\[\\frac{d}{dt} \\int_\\Omega \\rho \\phi d\\Omega =\n                \\int_\\Omega \\frac{\\partial \\rho \\phi}{\\partial t} d\\Omega\\]\nThat means we can write \\[\n\\int_{\\Gamma} \\mathbf{F} \\cdot \\mathbf{d}\\boldsymbol{\\Gamma}+\n        \\int _{\\Gamma} \\rho \\phi \\mathbf{v} \\cdot \\mathbf{d}\\boldsymbol{\\Gamma}=\n        \\int_{\\Omega} \\nabla \\cdot (\\mathbf{F} +\n        \\rho \\phi \\mathbf{v}) d\\Omega\n\\]\nand then rewrite the general conservation equation Equation 10.1 as\n\\[\n\\int_{\\Omega} \\left[ \\frac{d \\rho \\phi}{dt} +\n            \\nabla \\cdot (\\mathbf{F} + \\rho \\phi \\mathbf{v})\n            -\\rho H \\right] d\\Omega =0\n\\]\nNow this conservation law has to work no matter what shape we draw for the volume \\(\\Omega\\) and so the integral can only be zero for arbitrary \\(\\Omega\\) if the enclosed term is zero everywhere, i.e.\n\\[\n\\frac{d \\rho \\phi}{dt} +\n            \\nabla \\cdot (\\mathbf{F} + \\rho \\phi \\mathbf{v})\n            -\\rho H =0\n\\tag{10.2}\\]\nThis is the general conservation rule for any property \\(\\phi\\) of a moving fluid. We now consider several quantities and develop specific conservation laws.\nIn this case \\(\\phi=1\\) because\n\\[\\int_\\Omega \\rho d\\Omega \\rightarrow \\mbox{mass}\\]\nOf course, we also know that we cant diffuse or create mass which means \\(\\mathbf{F} = H = 0\\) and equation Equation 10.2 simplifies to give\n\\[\n{\\color{red} \\frac{\\partial \\rho}{\\partial t} +\n                \\nabla \\cdot \\rho \\mathbf{v} = 0}\n\\tag{10.3}\\]",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Conservation Laws</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ContinuumMechanics.html#conservation-of-heat-energy",
    "href": "DraftMaterial/ContinuumMechanics.html#conservation-of-heat-energy",
    "title": "Conservation Laws",
    "section": "Conservation of (heat) energy",
    "text": "Conservation of (heat) energy\nThe thermal energy / unit mass is \\(C_p T\\) and the conductive heat flux \\(\\mathbf{F}\\) is given by \\(\\mathbf{F} = -k \\nabla T\\), (\\(k\\) is the thermal conductivity).\nThen the general conservation equation Equation 10.2 reduces to this\n\\[\\frac{\\partial (\\rho C_p T)}{\\partial t} +\n             \\nabla \\cdot \\left(-k \\nabla T +\n             \\rho C_p T \\mathbf{v}\\right) - \\rho H = 0\\]\nand if we rearrange these terms in the right way we find\n\\[\\frac{C_p T}{\\rho} \\left[ \\frac{\\partial \\rho}{\\partial t} +\n            \\nabla \\cdot \\rho \\mathbf{v} \\right] +\n            \\frac{\\partial C_p T}{\\partial t} +\n            \\mathbf{v} \\cdot \\nabla C_p T =\n            \\frac{1}{\\rho} \\nabla \\cdot k \\nabla T + H\\]\nThe term in square brackets is simply the statement of mass conservation and we know immediately that this is zero.\nIf the heat capacity, \\(C_p\\) and thermal conductivity, \\(k\\) are constants, then the conservation equation becomes\n\\[\n{\\color{red}  \\left( \\frac{\\partial T}{\\partial t} + \\mathbf{v} \\cdot \\nabla T \\right)=\n                        \\kappa \\nabla^2 T + \\frac{H}{C_p} }\n\\tag{10.4}\\] where \\(\\kappa\\) is the thermal diffusivity, \\(\\kappa = k/\\rho C_p\\).\nIt probably did not go unnoticed that we assumed \\(\\rho\\) to be constant to get to this point. It is quite common to assume a material is near-enough incompressible that density changes can be ignored. In fact, this is a reasonable assumption even for air if the velocity is well below the speed of sound. It is also possible to keep assuming incompressibility even when accounting for density variations whose buoyancy effects drive deformation. There is a lot more detail on this in Ricard, 20151 and we will come back to it soon.\n\nA new bit of notation has appeared in the process of this derivation. The the \\(\\mathbf{v} \\cdot \\nabla\\) operator is a derivative that lies along the direction of motion \\(\\mathbf{v}\\):\n\\[\\mathbf{v} \\cdot \\nabla \\equiv v_j \\frac{\\partial}{\\partial x_j}\\]\nFor later reference, this is how it looks: \\[(\\mathbf{v} \\cdot \\nabla) T = v_1 \\frac{\\partial T}{\\partial x_1} +\n                v_2 \\frac{\\partial T}{\\partial x_2} + v_3 \\frac{\\partial T}{\\partial x_3}\\]\nThe Laplacian, \\(\\nabla^2\\), is this expression (for scalar \\(T\\))\n\\[\\nabla^2 T \\equiv \\frac{\\partial^2 T}{\\partial x_1^2} + \\frac{\\partial^2 T}{\\partial x_2^2} + \\frac{\\partial^2 T}{\\partial x_3^2}\\]",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Conservation Laws</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ContinuumMechanics.html#conservation-of-momentum",
    "href": "DraftMaterial/ContinuumMechanics.html#conservation-of-momentum",
    "title": "Conservation Laws",
    "section": "Conservation of momentum",
    "text": "Conservation of momentum\nMomentum is a vector quantity, so the form of Equation 10.1 is different. The source term in the momentum equation represents a body force, and the surface flux term represents a stress.\n\\[\n\\frac{d}{dt}\\int_{\\Omega} \\rho \\mathbf{v} d\\Omega =\n            -   \\int_{\\Omega} \\rho g \\hat{\\mathbf{z}} d\\Omega  \n            +   \\int_{\\Gamma} \\boldsymbol{\\sigma} \\cdot \\mathbf{d}\\boldsymbol{\\Gamma}-\n                \\int_{\\Gamma} \\rho \\mathbf{v} (\\mathbf{v} \\cdot \\mathbf{d}\\boldsymbol{\\Gamma})\n\\tag{10.5}\\] Gravity provides a body force acting in the vertical direction, \\(\\hat{\\mathbf{z}}\\). We have introduced the stress tensor, \\(\\boldsymbol{\\sigma}\\); the force / unit area exerted on an arbitrarily oriented surface with normal \\(\\hat{\\mathbf {n}}\\) is\n\\[f_i = \\sigma_{ij} n_j\\]\nThe application of Gauss’ theorem, and the equality holds for any choice of the volume gives this result:\n\\[\n\\frac{\\partial}{\\partial t}(\\rho \\mathbf{v})\n            +\\rho g \\hat{\\mathbf{z}} - \\nabla \\cdot \\sigma + \\nabla \\cdot (\\rho \\mathbf{v} \\mathbf{v}) = 0\n\\tag{10.6}\\]\nVector notation allows us to keep a number of equations written as one single equation. However, at this point, keeping the equations in vector notation makes the situation more confusing. What does that last term on the left hand side of Equation 10.6 mean ? It is clearer if we use the index notation instead\nEquation Equation 10.6 is equivalent to this:\n\\[\n{\\color{green}  \\frac{\\partial \\rho v_i}{\\partial t}} + \\rho g \\delta_{i3} -\n            \\frac{\\partial \\sigma_{ij}}{\\partial x_j} +\n            \\textcolor[rgb]{0.0,0.0,0.7}{ \\frac{\\partial(\\rho v_i v_j)}{\\partial x_j}} = 0\n\\tag{10.7}\\]\nwhere that peculiar final term on the left hand side is unambiguous. Repeated indeces in each term are implicitly summed. \\(\\delta_{ij}\\) is the kronecker delta which obeys:\n\\[\\delta_{ij} = \\begin{cases}\n                0 & \\text{if $i \\neq j$}, \\\\\n                1 & \\text{if $i = j$}.\n            \\end{cases}\\]\nIf we expand the derivatives of products of two terms and recombine them in the right way:\n\\[v_i \\left[{\\color{green}  \\frac{\\partial \\rho}{\\partial t}} +\n             {\\color{blue}   \\frac{\\partial \\rho v_j}{\\partial x_j}} \\right]\n            + {\\color{green}  \\rho \\frac{\\partial v_i}{\\partial t}} + {\\color{blue}  \\rho v_j \\frac{\\partial v_i}{\\partial x_j}} =\n            \\frac{\\partial \\sigma_{ij}}{\\partial x_j} -\\rho g \\delta_{i3}\\]\nThe term in square brackets is, in fact, a restatement of the conservation of mass derived above and must vanish. The remaining terms can now be written out in vector notation as\n\\[\n{\\color{red}    \\rho \\left( \\frac{\\partial \\mathbf{v}}{\\partial t}\n                            + (\\mathbf{v} \\cdot \\nabla) \\mathbf{v} \\right) =\n                         \\nabla \\cdot \\boldsymbol{\\sigma} - g\\rho\\hat{\\mathbf{z}}      }\n\\tag{10.8}\\]\nNote: The \\(\\mathbf{v} \\cdot \\nabla\\) notation we introduced earlier is now an operator on a vector. Written out it looks like this:\n\\[\\begin{split}\n                    (\\mathbf{v} \\cdot \\nabla) \\mathbf{u} =\n                        & \\hat{\\boldsymbol{\\imath}} \\left( v_1 \\frac{\\partial u_1}{\\partial x_1} +\n                        v_2 \\frac{\\partial u_1}{\\partial x_2} + v_3 \\frac{\\partial u_1}{\\partial x_3} \\right) \\\\\n                            & \\hat{\\boldsymbol{\\jmath}} \\left( v_1 \\frac{\\partial u_2}{\\partial x_1} +\n                        v_2 \\frac{\\partial u_2}{\\partial x_2} + v_3 \\frac{\\partial u_2}{\\partial x_3} \\right) \\\\\n                            & \\hat{\\boldsymbol{k}} \\left( v_1 \\frac{\\partial u_3}{\\partial x_1} +\n                        v_2 \\frac{\\partial u_3}{\\partial x_2} + v_3 \\frac{\\partial u_3}{\\partial x_3} \\right) \\\\                \n                \\end{split}\\]",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Conservation Laws</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ContinuumMechanics.html#footnotes",
    "href": "DraftMaterial/ContinuumMechanics.html#footnotes",
    "title": "Conservation Laws",
    "section": "",
    "text": "Ricard, Y. “Physics of Mantle Convection.” In Treatise on Geophysics, 23–71. Elsevier, 2015. https://doi.org/10.1016/B978-0-444-53802-4.00127-5.↩︎",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>10</span>  <span class='chapter-title'>Conservation Laws</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NavierStokes.html",
    "href": "DraftMaterial/NavierStokes.html",
    "title": "Navier-Stokes Equation",
    "section": "",
    "text": "Viscosity\nIn the previous section ({doc}./ContinuumMechanics), we looked a very general way use conservation principles to construct equations describing how sources, fluxes and material transport of varous quantities balance one another through time. This approach can also be used to generate conservation equations for additional physical variables (for example, angular momentum, electric current).\nOne thing is still missing, though, and that is how we express the flux term for a quantity in terms of gradients in the quantity itself. We did this without any comment in the conservation of heat energy because we used Fourier’s law \\(\\mathbf{F} = -k \\nabla T\\) to express the heat flux as a linear function of the temperature gradient. This is an empirical relationship that contains a physical constant that we are not able to derive from first principles. This missing relationship is known as a constitutive law.\nFor a fluid, the constitutive relationship relating momentum flux to momentum gradients introduces a new physical parameter, viscosity which relates stress to rates of change in velocity gradients and a second viscosity relating to rates of volume change.\nIf we make the assumption that the fluid is incompressible (\\(\\nabla \\cdot \\mathbf{v}\\)) which we already mentioned in deriving the temperature equation, we only have to worry about the viscosity that relates to velocity gradients\n\\[\n\\sigma_{ij} = \\eta \\left( \\frac{\\partial v_i}{\\partial x_j} + \\frac{\\partial v_j}{\\partial x_i}\\right) - p\\delta_{ij}\n\\]\n(An expanded derivation for this is in Landau & Lifschitz[REF] and they also talk extensively about rate of volume change effects).\nIf the viscosity is constant, then we can substitute the constitutive law into the stress-divergence term of the momentum conservation equation. In index notation once again,\n\\[\n\\begin{split}\n                \\nabla \\cdot \\boldsymbol{\\sigma} & =\n                    \\frac{\\partial}{\\partial x_j} \\eta\n                        \\left( \\frac{\\partial v_i}{\\partial x_j} +  \\frac{\\partial v_j}{\\partial x_i} \\right)\n                        - \\frac{\\partial p}{\\partial x_j} \\delta_{ij} \\\\\n                & = \\eta \\frac{\\partial^2 v_i}{\\partial x_j \\partial x_j} +\n                            \\eta \\frac{\\partial^2 v_j}{\\partial x_i \\partial x_j} -\n                                \\frac{\\partial p}{\\partial x_i}\\\\\n                & = \\eta \\nabla^2 \\mathbf{v} +\n                             \\eta \\textcolor[rgb]{0.0,0.7,0.0}{ \\nabla (\\nabla \\cdot \\mathbf{v})} - \\nabla p       \n\\end{split}\n\\]\nthe second (green) term in this final form must vanish because of the incompressibility assumption, so the momentum conservation equation becomes\nThis is the Navier-Stokes equation. Once again some new notation has shown up uninvited. The Laplacian operator \\(\\nabla^2\\) is defined (in a scalar context) as\nand in a vector context as\n\\[\n\\begin{split}\n\\nabla^2 \\mathbf{u} & = \\nabla \\nabla \\cdot \\mathbf{u} - \\nabla \\times (\\nabla \\times \\mathbf{u}) \\\\\n                    & = \\mathbf{i} \\nabla \\cdot \\nabla u_x +\n                        \\mathbf{j} \\nabla \\cdot \\nabla u_y +\n                        \\mathbf{k} \\nabla \\cdot \\nabla u_z\n                        \\mathrm{\\hspace{1cm} (Cartesian)}\n\\end{split}\n\\]\nIn Cartesian coordinates, the Laplacian operator has a simple form, and the vector Laplacian is simply the scalar operator applied in each direction. In other coordinate systems this operator becomes substantially more complicated but this notation is handy because the equations always look the same no matter the coordinate system.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Navier-Stokes Equation</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NavierStokes.html#boussinesq-approximation-equation-of-state-density-variations",
    "href": "DraftMaterial/NavierStokes.html#boussinesq-approximation-equation-of-state-density-variations",
    "title": "Navier-Stokes Equation",
    "section": "Boussinesq Approximation, Equation of State, Density Variations",
    "text": "Boussinesq Approximation, Equation of State, Density Variations\nThe equation which relates pressure, temperature and density is known as the equation of state. For the equations derived so far, we have specified an incompressible fluid and that means the density can’t change at all.\nCan you see the problem ? We have also included a source term for momentum which relies on gravity acting on density variations. This conflict is typical in fluid mechanics: simplifying assumptions if taken to their logical limit imply only trivial solutions (no motions are possible, that sort of thing)\nWe have to do something to get around this problem and the simplest thing to do is assume density changes are typically small relative to the magnitude of the density. Any terms in the equations which are multiplied by density can therefore assume that density is a large, constant value. Terms which contain gradients of density or density variations (where the constant terms cancel out) need to consider the equation of state.\nWe call this the Boussinesq approximation and it is only good for nearly- incompressible fluids. In the Navier-Stokes equation, the hydrostatic pressure does not influence the velocity field at all. Only differences in density drive fluid flow, and so the only term where we need to worry about density not being constant is in the gravitational body forces.\nIn the case of density variations due to temperature, the equation of state is this:\n\\[\n\\rho = \\rho_0 \\left(1 - \\alpha ( T-T_0 )\\right)\n\\tag{11.1}\\] where \\(\\rho_0\\) is the density at a reference temperature \\(T_0\\). \\(\\alpha\\) is the coefficient of thermal expansion. \\(\\alpha\\) is generally much smaller than one which justifies making the approximation in the first place.\nThe energy and momentum conservation equations are now coupled through the buoyancy forces,\n\\[\ng\\rho\\hat{\\mathbf{z}} = g \\rho_0 \\left(1 - \\alpha(T-T_0)\\right)\n\\]\nDensity variations due to pressure produce a perfectly vertical, isotropic forcing term on the momentum conservation equation. In the steady state case, this is balanced by the hydrostatic pressure gradient. (The isotropic term does not contribute at all the the deviatoric part of the stress equation and thus cannot induce steady flow). This is the reason we can ignore the vertical density gradient due to the weight of the fluid.\nAnother density variation is the one that results from variation in chemical composition from one fluid element to another. An example would be where two immiscible fluids live in the same region. Now density variations might be large – the fluid domains must be considered separately if we still want to assume small density changes due to temperature.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Navier-Stokes Equation</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NavierStokes.html#fluid-motion-eulerian-v.-lagrangian",
    "href": "DraftMaterial/NavierStokes.html#fluid-motion-eulerian-v.-lagrangian",
    "title": "Navier-Stokes Equation",
    "section": "Fluid Motion: Eulerian v. Lagrangian",
    "text": "Fluid Motion: Eulerian v. Lagrangian\nWe have seen the \\(\\mathbf{v} \\cdot \\nabla\\) operator a number of times now. The presence of this term causes major complications when we want to find solutions to the equations of continuum mechanics since it introduces a strong non-linearity. It is this term which is behind turbulence in high speed flows.\nThis term describes the advection of a quantity which accounts for the passive transport of something (temperature, momentum), by the motion of the fluid. Advection also presents some serious headaches in numerical methods and has spawned a vast literature devoted to efficient and accurate solution methods.\nOne way to side-step\nthe complexity of advection is to consider an elemental volume of space which moves with the fluid. The surface flux term from equation Equation 10.1 vanishes at once if there is no motion of material in or out of the boundary. In reality, we are just sweeping the problem under the rug – it doesn’t actually go away altogether – but it can be useful to do this because every once in a while that term will cancel out before we need to actually do anything with it ! And, sometimes, when it comes to numerical methods, different views of the equations can lead to better approximations.\nMathematically, we introduce a new notation:\n\\[\n\\frac{D \\phi}{D t} = \\frac{d}{dt} \\phi\\left[ x_1(t),x_2(t),x_3(t),t \\right]\n\\]\nwhere the change in the reference position \\((x_1(t),x_2(t),x_3(t))\\) is governed by the local flow velocity:\n\\[\n\\frac{d x_1}{d t} = v_1 \\;\\;\\;\\;\n                    \\frac{d x_2}{d t} = v_2  \\;\\;\\;\\;\n                    \\frac{d x_3}{d t} = v_3\n\\]\nand this keeps the reference point moving with the fluid. Differentiating gives\n\\[\n\\frac{D \\phi}{D t} =    \\frac{\\partial \\phi}{\\partial t} +\n                                \\frac{\\partial \\phi}{\\partial x_1}\\frac{d x_1}{d t} +\n                                \\frac{\\partial \\phi}{\\partial x_2}\\frac{d x_2}{d t} +\n                                \\frac{\\partial \\phi}{\\partial x_3}\\frac{d x_3}{d t}\n\\]\nwhich leads to\n\\[\n\\frac{D \\phi}{D t} =   \\frac{\\partial \\phi}{\\partial t} +\n                                    v_1 \\frac{\\partial \\phi}{\\partial x_1} +\n                                    v_2 \\frac{\\partial \\phi}{\\partial x_2} +\n                                    v_3 \\frac{\\partial \\phi}{\\partial x_3}\n\\]\nwhich is equivalent to\n\\[\n\\frac{D \\phi}{D t} = \\frac{\\partial \\phi}{\\partial t} +\n                (\\mathbf{v} \\cdot \\nabla) \\phi\n\\]\nIf we think of \\(\\phi\\) as the concentration of a dye in the fluid, then the above is a conservation equation assuming the dye does not diffuse and has no sources or sinks.\nViewed from a reference frame locked to a particular fluid element, the energy conservation equation becomes\n\\[\n\\frac{D T}{Dt} =\n        \\kappa \\nabla^2 T + \\frac{H}{C_p}\n\\]\nand the momentum conservation equation now becomes\n\\[\n\\frac{D \\mathbf{v} }{D t} =\n                \\eta \\nabla^2 \\mathbf{v} - \\nabla P     \n                - g\\rho\\hat{\\mathbf{z}}\n\\]\nThis is a considerably more compact way of writing the equations, but it is now necessary to use a coordinate system which is locked into the fluid and rapidly deforms as the fluid flows. Before long, the coordinate system is unimaginably complex – the advection problem returns in another guise. This formulation is known as the Lagrangian formulation and contrasts with the Eulerian viewpoint which is fixed in space.\nFrom the numerical point of view, however, this approach can have some distinct advantages. The computer can often track the distorted coordinate system far better than it can handle successive applications of the \\(\\mathbf{v} \\cdot \\nabla\\) operator at a fixed point in space. We will return to this point later.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Navier-Stokes Equation</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NavierStokes.html#reading-material",
    "href": "DraftMaterial/NavierStokes.html#reading-material",
    "title": "Navier-Stokes Equation",
    "section": "Reading Material",
    "text": "Reading Material\nG. F. Davies. Dynamic Earth. Cambridge University Press, New York, 1999.\nJ. Grotzinger, T. H. Jordan, F. Press, and R. Siever. Understanding Earth. W. H. Freeman & Co, 5 edition, 2006. URL http://bcs.whfreeman.com/understandingearth5e/.\nL. D. Landau and E. M. Lifshitz. Fluid Mechanics, volume 6 of Course of Theoretical Physics. Pergamon Press, 1959.\nG. Schubert, D. L. Turcotte, and P. Olson. Mantle Convection in Earth and Planets. Cambridge University Press, UK, 2001.\nD.L. Turcotte and G. Schubert. Geodynamics. John Wiley and Sons, New York, 1982.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Navier-Stokes Equation</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NavierStokes.html#exercises",
    "href": "DraftMaterial/NavierStokes.html#exercises",
    "title": "Navier-Stokes Equation",
    "section": "Exercises",
    "text": "Exercises\n\n\n\n\n\n\nWarning🚧 Under Review\n\n\n\n\n\nThis exercises section was newly added and adapted from MTH3360 Fluid Mechanics course materials. The exercises have been modified to include geodynamic applications and use the book’s notation conventions, but may need further refinement for pedagogical flow and difficulty progression.\nChanges made: - Adapted 8 exercises from ICFM Chapter 2 (Equations of Motion) - Added 2 new exercises on Boussinesq approximation and Reynolds number for geodynamic scenarios - Converted LaTeX notation to Quarto format with global math macros - Added detailed solutions to 5 exercises in collapsible callout blocks - Modified examples to use geodynamic contexts where appropriate\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nExercises marked with ⭐ have worked solutions provided.\n\n\n\nExercise 1: Material Derivative ⭐\nUnder what condition is the advective rate-of-change equal to the total rate-of-change? In other words, when does: \\[\n\\frac{D\\mathbf{f}}{Dt} = (\\mathbf{u}\\cdot \\nabla) \\mathbf{f}\n\\]\nExplain the physical meaning of this condition.\n\n\nExercise 2: Isothermal Atmosphere ⭐\nShow that, in hydrostatic equilibrium, the pressure and density in an isothermal (constant temperature) atmosphere vary with height according to: \\[\np(z) = p(0)\\exp(-z/H_s) \\quad \\text{and} \\quad \\rho(z) = \\rho(0)\\exp(-z/H_s)\n\\]\nwhere \\(H_s = RT/g\\), \\(R = 287\\) J K\\(^{-1}\\) kg\\(^{-1}\\) is the specific gas constant, and \\(z\\) points vertically upwards.\nShow that for realistic values of \\(T\\) in the troposphere, the e-folding height scale \\(H_s\\) is on the order of 8 km.\n\n\nExercise 3: Vector Differential Operators ⭐\nThe vector differential operator del (nabla) is defined as: \\[\n\\nabla= \\left(\\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}, \\frac{\\partial}{\\partial z}\\right)\n\\]\nExpress in full Cartesian form the quantities: - \\(\\nabla\\cdot\\mathbf{u}\\) (divergence) - \\(\\nabla\\times\\mathbf{u}\\) (curl) - \\(\\mathbf{u}\\cdot \\nabla\\) (directional derivative) - \\(\\nabla\\cdot \\nabla\\equiv \\nabla^2\\) (Laplacian)\nIdentify and explain the physical meaning of each operator.\n\n\nExercise 4: Material Derivative and Pollutant Transport ⭐\nConsider a homogeneous, incompressible fluid with velocity \\(\\mathbf{u}= (\\alpha x, -\\alpha y, 0)\\) where \\(\\alpha\\) is constant. The concentration of a pollutant in the fluid is: \\[\nc(x,y,z,t) = c_0 + \\gamma t + \\beta x^2 y e^{-\\alpha t}\n\\]\nwhere \\(c_0\\), \\(\\gamma\\), and \\(\\beta\\) are constants.\n\nWhat is the (time) rate of change of concentration at a particular point (Eulerian perspective)?\nHow does the concentration change following fluid parcels (Lagrangian perspective)?\nConsider a parcel at point \\((1, 1, 0)\\) at \\(t = 0\\). What is its concentration at \\(t = 1\\)?\n\n\n\nExercise 5: Commutation of Derivatives\nShow that: \\[\n\\frac{\\partial}{\\partial x}\\left(\\frac{Df}{Dt}\\right) = \\frac{D}{Dt}\\left(\\frac{\\partial f}{\\partial x}\\right) + \\frac{\\partial \\mathbf{u}}{\\partial x} \\cdot \\nabla f\n\\]\nClarify the meaning of the final term using index notation.\nHint: Expand \\(D/Dt\\) and use the product rule carefully.\n\n\nExercise 6: Incompressibility Condition\nIs the velocity field \\(\\mathbf{u}= (\\cos x, xz^2, z\\sin x)\\) kinematically admissible for an incompressible fluid? Justify your answer.\n\n\nExercise 7: Pressure Field in Inviscid Flow ⭐\nFind the pressure field in the inviscid, incompressible flow with velocity field \\(\\mathbf{u}= (kx, -ky, 0)\\), where \\(k\\) is a constant. Assume the flow is steady and the only body force is gravity.\nHint: Use the Euler equation (Navier-Stokes without viscosity).\n\n\nExercise 8: Cylindrical Polar Coordinates ⭐\nShow that the continuity equation in cylindrical polar coordinates \\((r, \\theta, z)\\) is: \\[\n\\frac{1}{r}\\frac{\\partial(ru_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial u_\\theta}{\\partial \\theta} + \\frac{\\partial u_z}{\\partial z} = 0\n\\]\nwhere \\(\\mathbf{U} = (u_r, u_\\theta, u_z)\\) is the velocity in cylindrical coordinates.\nHint: Transform from Cartesian coordinates using the chain rule.\n\n\nExercise 9: Boussinesq Approximation Application\nConsider mantle convection where the temperature difference between the surface and CMB is \\(\\Delta T = 3000\\) K, thermal expansivity \\(\\alpha = 3 \\times 10^{-5}\\) K\\(^{-1}\\), and reference density \\(\\rho_0 = 4000\\) kg m\\(^{-3}\\).\n\nCalculate the density variation \\(\\Delta \\rho = \\rho_0 \\alpha \\Delta T\\)\nWhat percentage of the reference density is this?\nIs the Boussinesq approximation valid for mantle convection?\nUnder what conditions might the Boussinesq approximation break down in planetary interiors?\n\n\n\nExercise 10: Reynolds Number Estimation\nCalculate the Reynolds number for the following geodynamic scenarios:\n\nMantle convection: \\(U = 50\\) mm/yr, \\(L = 2900\\) km, \\(\\nu = 10^{17}\\) m\\(^2\\)/s\nMagma flow in a dike: \\(U = 1\\) m/s, \\(L = 1\\) m, \\(\\nu = 10^3\\) m\\(^2\\)/s\nCore convection: \\(U = 0.1\\) mm/s, \\(L = 3000\\) km, \\(\\nu = 10^{-6}\\) m\\(^2\\)/s\n\nComment on whether inertial effects are important in each case.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Navier-Stokes Equation</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NavierStokes.html#solutions-to-selected-exercises",
    "href": "DraftMaterial/NavierStokes.html#solutions-to-selected-exercises",
    "title": "Navier-Stokes Equation",
    "section": "Solutions to Selected Exercises",
    "text": "Solutions to Selected Exercises\n\n\n\n\n\n\nTipSolution to Exercise 1: Material Derivative\n\n\n\n\n\nThe material derivative is: \\[\n\\frac{D\\mathbf{f}}{Dt} = \\frac{\\partial \\mathbf{f}}{\\partial t} + (\\mathbf{u}\\cdot \\nabla)\\mathbf{f}\n\\]\nFor the advective term to equal the total derivative, we need: \\[\n\\frac{\\partial \\mathbf{f}}{\\partial t} = 0\n\\]\nPhysical meaning: This occurs when the flow is steady (time-independent at fixed points in space). In steady flow, all changes experienced by a fluid parcel are due to its motion through spatially varying fields, not due to temporal changes at fixed locations.\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 2: Isothermal Atmosphere\n\n\n\n\n\nIn hydrostatic equilibrium: \\(\\frac{dp}{dz} = -\\rho g\\)\nFor an ideal gas: \\(p = \\rho RT\\) where \\(T\\) is constant.\nTherefore: \\(\\rho = \\frac{p}{RT}\\)\nSubstituting into the hydrostatic equation: \\[\n\\frac{dp}{dz} = -\\frac{pg}{RT} = -\\frac{p}{H_s}\n\\]\nwhere \\(H_s = RT/g\\) is the scale height.\nIntegrating: \\[\np(z) = p(0)\\exp\\left(-\\frac{z}{H_s}\\right)\n\\]\nAnd from the equation of state: \\[\n\\rho(z) = \\frac{p(z)}{RT} = \\rho(0)\\exp\\left(-\\frac{z}{H_s}\\right)\n\\]\nFor the troposphere, take \\(T \\approx 250\\) K: \\[\nH_s = \\frac{287 \\times 250}{9.81} \\approx 7.3 \\text{ km}\n\\]\nThis is indeed on the order of 8 km.\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 3: Vector Differential Operators\n\n\n\n\n\nDivergence (scalar): \\[\n\\nabla\\cdot\\mathbf{u}= \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} + \\frac{\\partial w}{\\partial z}\n\\] Index notation: \\(\\nabla_k u_k\\) or \\(\\partial u_k/\\partial x_k\\)\nPhysical meaning: Rate of volume expansion per unit volume.\nCurl (vector): \\[\n\\nabla\\times\\mathbf{u}= \\left(\\frac{\\partial w}{\\partial y} - \\frac{\\partial v}{\\partial z}, \\frac{\\partial u}{\\partial z} - \\frac{\\partial w}{\\partial x}, \\frac{\\partial v}{\\partial x} - \\frac{\\partial u}{\\partial y}\\right)\n\\] Index notation: \\(\\varepsilon_{ijk}\\partial u_k/\\partial x_j\\)\nPhysical meaning: Local rotation or vorticity of the fluid.\nDirectional derivative (scalar operator): \\[\n\\mathbf{u}\\cdot \\nabla= u\\frac{\\partial}{\\partial x} + v\\frac{\\partial}{\\partial y} + w\\frac{\\partial}{\\partial z}\n\\] Index notation: \\(u_k \\partial/\\partial x_k\\)\nPhysical meaning: Rate of change along the direction of velocity.\nLaplacian (scalar): \\[\n\\nabla^2 = \\frac{\\partial^2}{\\partial x^2} + \\frac{\\partial^2}{\\partial y^2} + \\frac{\\partial^2}{\\partial z^2}\n\\] Index notation: \\(\\partial^2/\\partial x_k \\partial x_k\\)\nPhysical meaning: Measure of how much a field differs from its average over neighboring points.\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 4: Pollutant Transport\n\n\n\n\n\nGiven: \\(\\mathbf{u}= (\\alpha x, -\\alpha y, 0)\\) and \\(c = c_0 + \\gamma t + \\beta x^2 y e^{-\\alpha t}\\)\n(a) Eulerian rate of change (at fixed point): \\[\n\\frac{\\partial c}{\\partial t} = \\gamma - \\alpha\\beta x^2 y e^{-\\alpha t}\n\\]\n(b) Lagrangian rate of change (following parcels): \\[\n\\frac{Dc}{Dt} = \\frac{\\partial c}{\\partial t} + \\mathbf{u}\\cdot \\nabla c\n\\]\nFirst calculate \\(\\nabla c\\): \\[\n\\nabla c = \\left(2\\beta xy e^{-\\alpha t}, \\beta x^2 e^{-\\alpha t}, 0\\right)\n\\]\nThen: \\[\n\\begin{aligned}\n\\mathbf{u}\\cdot \\nabla c &= \\alpha x(2\\beta xy e^{-\\alpha t}) + (-\\alpha y)(\\beta x^2 e^{-\\alpha t}) \\\\\n&= 2\\alpha\\beta x^2y e^{-\\alpha t} - \\alpha\\beta x^2 y e^{-\\alpha t} \\\\\n&= \\alpha\\beta x^2 y e^{-\\alpha t}\n\\end{aligned}\n\\]\nTherefore: \\[\n\\frac{Dc}{Dt} = \\gamma - \\alpha\\beta x^2 y e^{-\\alpha t} + \\alpha\\beta x^2 y e^{-\\alpha t} = \\gamma\n\\]\nThe concentration increases at constant rate \\(\\gamma\\) following fluid parcels!\n(c) Concentration at \\(t = 1\\):\nFirst find the particle path. The trajectory satisfies: \\[\n\\frac{dx}{dt} = \\alpha x, \\quad \\frac{dy}{dt} = -\\alpha y\n\\]\nSolutions: \\(x(t) = x_0 e^{\\alpha t}\\), \\(y(t) = y_0 e^{-\\alpha t}\\)\nStarting at \\((x_0, y_0, 0) = (1, 1, 0)\\) at \\(t = 0\\): - At \\(t = 1\\): \\(x(1) = e^\\alpha\\), \\(y(1) = e^{-\\alpha}\\)\nSince \\(Dc/Dt = \\gamma\\): \\[\nc(t) = c(0) + \\int_0^t \\gamma \\, dt' = c(0) + \\gamma t\n\\]\nInitial concentration: \\(c(0) = c_0 + \\beta(1)^2(1)e^0 = c_0 + \\beta\\)\nFinal concentration: \\(c(1) = c_0 + \\beta + \\gamma\\)\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 7: Pressure in Inviscid Flow\n\n\n\n\n\nGiven: \\(\\mathbf{u}= (kx, -ky, 0)\\) (steady, inviscid, incompressible)\nCheck incompressibility: \\[\n\\nabla\\cdot\\mathbf{u}= k - k + 0 = 0 \\quad \\checkmark\n\\]\nCalculate the advective acceleration: \\[\n(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}= \\left(kx\\frac{\\partial}{\\partial x} - ky\\frac{\\partial}{\\partial y}\\right)(kx, -ky, 0)\n\\]\n\\[\n= (k^2 x, k^2 y, 0) = \\nabla\\left(\\frac{k^2x^2}{2} + \\frac{k^2y^2}{2}\\right)\n\\]\nEuler equation (inviscid Navier-Stokes): \\[\n(\\mathbf{u}\\cdot \\nabla)\\mathbf{u}= -\\frac{1}{\\rho}\\nabla p - g\\hat{\\mathbf{k}}\n\\]\nTherefore: \\[\n\\nabla\\left(\\frac{k^2x^2}{2} + \\frac{k^2y^2}{2}\\right) = -\\frac{1}{\\rho}\\nabla p - \\nabla(gz)\n\\]\nIntegrating: \\[\np = p_0 - \\rho\\left(\\frac{k^2x^2}{2} + \\frac{k^2y^2}{2} + gz\\right)\n\\]\nwhere \\(p_0\\) is the pressure at the origin.\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 8: Cylindrical Continuity Equation\n\n\n\n\n\nTransform from Cartesian \\((x, y, z)\\) to cylindrical \\((r, \\theta, z)\\): \\[\nx = r\\cos\\theta, \\quad y = r\\sin\\theta, \\quad z = z\n\\]\nVelocity transformation: \\[\nu_r = u\\cos\\theta + v\\sin\\theta, \\quad u_\\theta = -u\\sin\\theta + v\\cos\\theta, \\quad u_z = w\n\\]\nUsing the chain rule: \\[\n\\frac{\\partial}{\\partial x} = \\cos\\theta\\frac{\\partial}{\\partial r} - \\frac{\\sin\\theta}{r}\\frac{\\partial}{\\partial \\theta}\n\\]\n\\[\n\\frac{\\partial}{\\partial y} = \\sin\\theta\\frac{\\partial}{\\partial r} + \\frac{\\cos\\theta}{r}\\frac{\\partial}{\\partial \\theta}\n\\]\nSubstitute into the Cartesian continuity equation \\(\\partial u/\\partial x + \\partial v/\\partial y + \\partial w/\\partial z = 0\\) and use the velocity transformations. After simplification using trigonometric identities: \\[\n\\frac{1}{r}\\frac{\\partial(ru_r)}{\\partial r} + \\frac{1}{r}\\frac{\\partial u_\\theta}{\\partial \\theta} + \\frac{\\partial u_z}{\\partial z} = 0\n\\]",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>11</span>  <span class='chapter-title'>Navier-Stokes Equation</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/MantleDynamics.html",
    "href": "DraftMaterial/MantleDynamics.html",
    "title": "Non-dimensional equations & dimensionless numbers",
    "section": "",
    "text": "The stream function\nBefore too long it would be a good idea to get a feeling for the flavour of these equations which continual rearrangements will not do — it is necessary to examine some solutions.\nFirst of all it is a good idea to make some simplifications based on the kinds of problems we will want to attack. The first thing to do, as is often the case when developing a model, is to test whether any of the terms in the equations are negligibly small, or dominant. To do this, we are going to need to have some physical insight into the kinds of problems we are going to solve - for example, some terms may be negligible for slow moving flow but not if the flow is fast (but what does ‘fast’ really mean ?)\nOne trick that is very common in fluid dynamics is to re-scale the equations using units that are in some way natural to the problem we are trying to solve. This helps us to answer the question that came up a moment ago: if a typical velocity is 1, then ‘slow’ is \\(v \\ll 1\\) and ‘fast’ is when \\(v \\gg 1\\).\nRemember that even very rational systems of units like the SI system are still arbitrary and based on the scale of human experience: a metre is not far off the length of a step when we walk, a second is our heartbeat, carry a litre of water when you go walking.\nWe don’t need to define and name a whole new system of units any time we start analysing a new problem, but the fact that we could do this suggests there is a way to consider the scale of a problem independenly to the underlying character of the way things balance each other as the system changes through time.\nWhat we can do is consider ‘typical values’ for the independent dimensions of a system (mass, length, time, temperature, that sort of thing) which can be used to rescale the standard units. For example, we might rescale all lengths by the size of the system we are studying, \\(d\\) (e.g. mantle thickness or depth of fluid in a lab tank), time according to the characteristic time for diffusion of heat over that distnace, and temperature by maximum temperature difference we observe at the start.\nVarious scalings result, with the new variables indicated using a prime (\\('\\)).\n\\[\n\\begin{array}{llll}\n    x = d.x' & \\partial / \\partial x =  (1/d) \\partial / \\partial x' & \\nabla = (1/d) \\nabla '  \\\\\n    t = (d^2/\\kappa) t'  &  \\partial / \\partial t = (\\kappa/d^2) \\partial / \\partial t' & \\\\\n    T = \\Delta T T' & & \\\\\n    v = (\\kappa / d) v' && \\\\\n    p= p_0 + (\\eta \\kappa / d^2) p'\n\\end{array}\n\\]\nwhere \\(\\nabla p_0 = - g \\rho_0\\)\nSubstituting for all the existing terms in the Navier-Stokes equation (?eq-navstokes) using the equation of state for thermally induced variation in density (?eq-state) gives:\n\\[\n\\frac{\\rho_0 \\kappa}{d^2} \\frac{D}{Dt'} \\left( \\frac{\\kappa}{d} \\mathbf{v}' \\right) =\n                \\frac{\\eta}{d^2} \\acute{\\nabla}^2 \\left( \\frac{\\kappa}{d} \\mathbf{v}' \\right)\n                - \\frac{\\eta \\kappa}{d^3}  \\acute{\\nabla} p' + g \\rho_0 \\alpha \\Delta T T' \\hat{\\mathbf{z}}\n\\]\nCollecting everything together gives\n\\[\n\\frac{\\rho_0 \\kappa^2}{d^3} \\frac{D\\mathbf{v}'}{Dt'}  =\n                \\frac{\\eta \\kappa}{d^3} \\acute{\\nabla}^2  \\mathbf{v}'\n                - \\frac{\\eta \\kappa}{d^3}  \\acute{\\nabla} p' + g \\rho_0 \\alpha \\Delta T T' \\hat{\\mathbf{z}}\n\\]\nDivide throughout by \\(\\eta \\kappa / d^3\\) gives\n\\[\n\\begin{aligned}\n    \\frac{\\rho \\kappa}{\\eta} \\frac{D\\mathbf{v}'}{Dt'}  & =\n                     \\acute{\\nabla}^2  \\mathbf{v}'  -  \\acute{\\nabla} p' +\n                     \\frac{g \\rho_0 \\alpha \\Delta T d^3}{\\kappa \\eta} T' \\hat{\\mathbf{z}} \\nonumber \\\\\n            \\textrm{or}  \\;\\;\\;\n     \\frac{1}{{\\rm Pr}} \\frac{D\\mathbf{v}'}{Dt'} & =\n                    \\acute{\\nabla}^2  \\mathbf{v}'  -  \\acute{\\nabla} p' + {\\rm Ra} T' \\hat{\\mathbf{z}}\n\\end{aligned}\n\\]\n\\(\\rm Pr\\) is known as the Prandtl number, and \\(\\rm Ra\\) is known as the Rayleigh number; both are non-dimensional numbers. By choosing to scale the equations (and this is still perfectly general as we haven’t forced any particular choice of scaling yet), we have condensed the different physical variable quantities into just two numbers. The benefit of this procedure is that it tells us how different quantities trade off against one another. For example, we see that if the density doubles, and the viscosity doubles, then the solution should remain unchanged.\nIn fact, the main purpose of this particular exercise is about to be revealed. The value of mantle viscosity is believed to lie somewhere between \\(10^{19}\\) and \\(10^{23}\\) \\({\\rm Pa . s}\\), the thermal diffusivity is around \\(10^{-6}{\\rm m}^2{\\rm s}^{-1}\\), and density around \\(3300 {\\rm kg . m}^{-3}\\). This gives a Prandtl number greater than \\(10^{20}\\). Typical estimates for the Rayleigh number are between \\(10^6\\) and \\(10^8\\) depending on the supposed depth of convection, and the uncertain mantle viscosity.\nObviously, the time-dependent term can be neglected for the mantle, since it is at least twenty orders of magnitude smaller than other terms in the equations. The benefit of this is that the nasty advection term for momentum is eliminated – flow in the mantle is at the opposite extreme to turbulent flow. The disadvantage is that the equations now become non-local: changes in the stress field are propogated instantly from point to point which can make the equations a lot harder to solve. This can be counter-intuitive but the consequences are important when considering the dynamic response of the Earth to changes in, for example, plate configurations.\nIncidentally, a third, independent dimensionless number can be derived for the thermally driven flow equations. This is the Nusselt number\n\\[\n{\\rm Nu} = \\frac{Q}{k\\Delta T}\n\\]\nand is the ratio of actual heat transported by fluid motions in the layer compared to that transported conductively in the absence of fluid motion.\nAll other dimensionless quantities for this system can be expressed as some combination of the Nusselt, Rayleigh and Prandtl numbers. The Prandtl number is a property of the fluid itself – typical values are: air, $$1; water, \\(\\sim\\) 6; non-conducting fluids \\(10^3\\) or more; liquid metal, $$0.1. Rayleigh number and Nusselt number are both properties of the chosen geometry.\nFor incompressible flows in two dimensions it can be very convenient to work with the stream-function – a scalar quantity which defines the flow everywhere. The stream function is the scalar quantity,\\(\\psi\\), which satisfies\n\\[\nv_1 = -\\frac{\\partial \\psi}{\\partial x_2} \\mbox{\\hspace{1cm}}\n                        v_2 = \\frac{\\partial \\psi}{\\partial x_1}\n\\tag{12.1}\\]\nso that, automatically,\n\\[\n\\frac{\\partial v_1}{\\partial x_1} + \\frac{\\partial v_2}{\\partial x_2} = 0\n\\]\nImportantly, computing the following\n\\[\n(\\mathbf{v} \\cdot \\nabla) \\psi =\n                        v_1 \\frac{\\partial \\psi}{\\partial x_1} +\n                        v_2 \\frac{\\partial \\psi}{\\partial x_2} =\n                        \\frac{\\partial \\psi}{\\partial x_2} \\frac{\\partial \\psi}{\\partial x_1} -\n                        \\frac{\\partial \\psi}{\\partial x_1} \\frac{\\partial \\psi}{\\partial x_2} = 0\n\\]\ntells us that \\(\\psi\\) does not change due to advection – in other words, contours of constant \\(\\psi\\) are streamlines of the fluid.\nProvided we limit ourselves to the xy plane, it is possible to think of equation (Equation 12.1) as\n\\[\n\\mathbf{v} = \\nabla \\times (\\psi \\hat{\\mathbf{k}})\n\\]\nThis form can be used to write down the 2D axisymetric version of equation (Equation 12.1)\n\\[\n\\begin{aligned}\n                    u_r = -\\frac{1}{r}\\frac{\\partial \\psi}{\\partial \\theta} & &\n                    u_\\theta = \\frac{\\partial \\psi}{\\partial r}\n\\end{aligned}\n\\]\nwhich automatically satisfies the incompressibility condition in plane polar coordinates \\[\n\\frac{1}{r}\\frac{\\partial}{\\partial r}(ru_r) + \\frac{1}{r}\\frac{\\partial u_\\theta}{\\partial \\theta} = 0\n\\]",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Non-dimensional equations & dimensionless numbers</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/MantleDynamics.html#vorticity",
    "href": "DraftMaterial/MantleDynamics.html#vorticity",
    "title": "Non-dimensional equations & dimensionless numbers",
    "section": "Vorticity",
    "text": "Vorticity\nVorticity is defined by \\[\n\\boldsymbol{\\omega} = \\nabla \\times \\mathbf{v}\n\\]\nIn 2D, the vorticity can be regarded as a scalar as it has only one component which lies out of the plane of the flow.\n\\[\n\\omega = \\frac{\\partial v_2}{\\partial x_1} -\n         \\frac{\\partial v_1}{\\partial x_2}\n\\]\nwhich is also exactly equal to twice the local measure of the spin in the fluid. Local here means that it applies to an infinitessimal region around the sample point but not to the fluid as a whole.\nThis concept is most useful in the context of invicid flow where vorticity is conserved within the bulk of the fluid provided the fluid is subject to only conservative forces – that is ones which can be described as the gradient of a single-valued potential.\nIn the context of viscous flow, the viscous effects acts cause diffusion of vorticity, and in our context, the fact that buoyancy forces result from to (irreversible) heat transport means that vorticity has sources. Taking the curl of the Navier-Stokes equation, and substituting for the vorticity where possible gives\n\\[\n\\frac{1}{\\rm Pr} \\left( \\frac{D \\boldsymbol{\\omega}}{D t} -\n                (\\boldsymbol{\\omega} \\cdot \\nabla) \\mathbf{v} \\right) =\n                    \\eta \\nabla ^2 \\boldsymbol{\\omega} + {\\rm Ra} \\frac{\\partial T}{\\partial x_1}\n\\]\nThe pressure drops out because \\(\\nabla \\times \\nabla P = 0 \\mbox{\\hspace{0.5cm}} \\forall P\\).",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Non-dimensional equations & dimensionless numbers</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/MantleDynamics.html#stream-function-vorticity-and-the-biharmonic-equation",
    "href": "DraftMaterial/MantleDynamics.html#stream-function-vorticity-and-the-biharmonic-equation",
    "title": "Non-dimensional equations & dimensionless numbers",
    "section": "Stream-function, vorticity and the biharmonic equation",
    "text": "Stream-function, vorticity and the biharmonic equation\nIn the context of highly viscous fluids in 2D, the vorticity equation is\n\\[\n\\nabla ^2 \\omega = - Ra \\frac{\\partial T}{\\partial x_1}\n\\tag{12.2}\\]\nand, by considering the curl of \\((-\\partial \\psi / \\partial x_2, \\partial \\psi / \\partial x_1, 0)\\) the stream function can be written\n\\[\n\\nabla ^2 \\psi = \\omega\n\\tag{12.3}\\]\nThis form is useful from a computational point of view because it is relatively easy to solve the Laplacian, and the code can be reused for each application of the operator. The Laplacian is also used for thermal diffusion – one subroutine for three different bits of physics which is elegant in itself if nothing else.\nThe biharmonic operator is defined as\n\\[\n\\nabla^4 \\equiv \\nabla^2 ( \\nabla ^2) \\equiv\n                    \\left( \\frac{\\partial ^4}{\\partial x_1^4} +\n                    \\frac{\\partial ^2}{\\partial x_1^2} \\frac{\\partial ^2}{\\partial x_2^2} +\n                    \\frac{\\partial ^4}{\\partial x_2^4} \\right)\n\\]\nThe latter form being the representation in Cartesian coordinates.\nUsing this form, it is easy to show that equations (Equation 12.2) and (Equation 12.3) can be combined to give\n\\[\n\\nabla^4 \\psi = -{\\rm Ra} \\frac{\\partial T}{\\partial x_1}\n\\tag{12.4}\\]",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Non-dimensional equations & dimensionless numbers</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/MantleDynamics.html#poloidaltoroidal-velocity-decomposition",
    "href": "DraftMaterial/MantleDynamics.html#poloidaltoroidal-velocity-decomposition",
    "title": "Non-dimensional equations & dimensionless numbers",
    "section": "Poloidal/Toroidal velocity decomposition",
    "text": "Poloidal/Toroidal velocity decomposition\nThe stream-function / vorticity form we have just used is a simplification of the more general case of the poloidal / toroidal velocity decomposition which turns out to be useful when we want to understand the balance of different contributions to the governing equation.\nWe can make a Helmholtz decomposition of the velocity vector field:\n\\[\n\\mathbf{u} = \\nabla \\phi + \\nabla \\times \\mathbf{A}\n\\]\nThen for an incompressible flow, since \\(\\nabla \\cdot \\mathbf{u} = 0\\), \\[\n\\mathbf{u} = \\nabla \\times \\mathbf{A}\n\\tag{12.5}\\]\nNow suppose there is some direction (\\(\\hat{\\mathbf{z}}\\)) which we expect to be physically favoured in the solutions, we can rewrite Equation 12.5 as\n\\[\n\\mathbf{u} = \\textcolor[rgb]{0.7,0.0,0.0}{\\nabla \\times(\\Psi \\hat{\\mathbf{z}})} +\n                 \\textcolor[rgb]{0.0,0.0,0.7}{ \\nabla \\times\\nabla \\times(\\Phi \\hat{\\mathbf{z}})}\n\\tag{12.6}\\]\nWhere the first term on the right is the Toroidal part of the flow, and the second term is the Poloidal part. Why is this useful ? Let’s substitute (Equation 12.6) into the Stokes’ equation for a constant viscosity fluid\n\\[\n\\eta \\nabla^2 \\mathbf{u} - \\nabla p = g \\rho \\hat{\\mathbf{z}}\n\\tag{12.7}\\]\nwhere \\(\\hat{\\mathbf{z}}\\) is the vertical unit vector (defined by the direction of gravity) and is clearly the one identifiable special direction, then equate coefficients in the \\(\\hat{\\mathbf{z}}\\) direction, and using the following results:\n\\[\n\\hat{\\mathbf{z}} \\cdot \\nabla \\times \\nabla^2 \\mathbf{u} =\n        - \\nabla^2 \\nabla_h^2\\Psi\n\\]\n\\[\n\\hat{\\mathbf{z}} \\cdot \\nabla \\times \\nabla \\times \\nabla^2 \\mathbf{u} =\n          \\nabla^2 \\nabla^2 \\nabla_h^2\\Phi\n\\]\nwhere\n\\[\n\\nabla_h = \\left( \\frac{\\partial}{\\partial x}, \\frac{\\partial}{\\partial y}, 0 \\right)\n\\]\nis a gradient operator limited to the plane perpendicular to the special direction, \\(\\hat{\\mathbf{z}}\\).\nIf we first take the curl of (Equation 12.7), and look at the \\(\\hat{\\mathbf{z}}\\) direction,\n\\[\n\\hat{\\mathbf{z}} \\cdot \\eta \\nabla \\times \\nabla^2 \\mathbf{u} =\n        -\\eta \\nabla^2 \\nabla_h^2\\Psi =\n        \\hat{\\mathbf{z}} \\cdot \\left( g \\nabla \\times \\left( \\rho \\hat{\\mathbf{z}}\\right)\\right) = 0\n\\]\nwe see that there is no contribution of the toroidal velocity field to the force balance. This balance occurs entirely through the poloidal part of the velocity field. If we take the curl twice and, once again, look at the \\(\\hat{\\mathbf{z}}\\) direction:\n\\[\n\\hat{\\mathbf{z}} \\cdot \\eta \\nabla \\times \\nabla \\times \\nabla^2 \\mathbf{u} =\n        \\eta \\nabla^2 \\nabla^2 \\nabla_h^2 \\Phi =\n        \\hat{\\mathbf{z}} \\cdot g \\nabla \\times \\nabla \\times \\left( \\rho \\hat{\\mathbf{z}}\\right) =\n         \\nabla_h^2 (\\rho g)\n\\]\nWhich is the 3D equivalent of the biharmonic equation that we derived above.\nNote: if the viscosity varies in the \\(\\hat{\\mathbf{z}}\\) direction, then this same decoupling still applies: bouyancy forces do not drive any toroidal flow. Lateral variations in viscosity (perpendicular to \\(\\hat{\\mathbf{z}}\\)) couple the buoyancy to toroidal motion. This result is general in that it applies to the spherical geometry equally well assuming the radial direction (of gravity) to be special.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Non-dimensional equations & dimensionless numbers</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/MantleDynamics.html#exercises",
    "href": "DraftMaterial/MantleDynamics.html#exercises",
    "title": "Non-dimensional equations & dimensionless numbers",
    "section": "Exercises",
    "text": "Exercises\n\n\n\n\n\n\nWarning🚧 Under Review\n\n\n\n\n\nThis exercises section is newly added as a placeholder for future content. These exercises are currently conceptual prompts that need to be developed with detailed problem statements, worked examples, and solutions.\nChanges made: - Created 5 placeholder exercises aligned with chapter content - Added 1 worked solution for stream function properties - Exercises need expansion with numerical values and step-by-step guidance - Additional exercises should be added covering: dimensional analysis, scaling laws, corner flow details\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nExercises marked with ⭐ have worked solutions provided. Additional exercises will be added as the chapter develops.\n\n\n\nExercise 1: Non-dimensionalizing the Stokes Equation\nStarting from the dimensional Stokes equation, derive the non-dimensional form showing all intermediate steps. Identify where the Rayleigh number appears and explain its physical significance.\n\n\nExercise 2: Poloidal-Toroidal Decomposition\nFor the velocity field in spherical coordinates:\n\nShow that any solenoidal (divergence-free) vector field can be decomposed into poloidal and toroidal components\nExplain why toroidal flow cannot generate buoyancy-driven convection\nGive examples of geophysical flows that are predominantly toroidal\n\n\n\nExercise 3: Estimating Mantle Rayleigh Numbers\nUsing typical mantle values, calculate the Rayleigh number for:\n\nWhole mantle convection\nUpper mantle only convection\nThermal boundary layer at the CMB (use appropriate length scale)\n\nCompare your results and discuss the implications for convection vigor.\n\n\nExercise 4: Stream Function Properties ⭐\nFor 2D incompressible flow, the stream function \\(\\psi\\) is defined such that: \\[\nu = \\frac{\\partial \\psi}{\\partial y}, \\quad v = -\\frac{\\partial \\psi}{\\partial x}\n\\]\n\nShow that this automatically satisfies incompressibility\nDemonstrate that streamlines are curves of constant \\(\\psi\\)\nShow that the volume flux between two streamlines equals the difference in \\(\\psi\\) values\n\n\n\nExercise 5: Corner Flow Solution\nExamine the corner flow solution for subduction zones:\n\nVerify that the given velocity field satisfies incompressibility\nCalculate the strain rate tensor for this flow\nWhere is the maximum strain rate located?\nHow does the solution change with the dip angle of the subducting slab?",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Non-dimensional equations & dimensionless numbers</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/MantleDynamics.html#solutions-to-selected-exercises",
    "href": "DraftMaterial/MantleDynamics.html#solutions-to-selected-exercises",
    "title": "Non-dimensional equations & dimensionless numbers",
    "section": "Solutions to Selected Exercises",
    "text": "Solutions to Selected Exercises\n\n\n\n\n\n\nTipSolution to Exercise 4: Stream Function Properties\n\n\n\n\n\n(a) Incompressibility:\nThe divergence of the velocity field is: \\[\n\\nabla\\cdot\\mathbf{u}= \\frac{\\partial u}{\\partial x} + \\frac{\\partial v}{\\partial y} = \\frac{\\partial^2 \\psi}{\\partial x \\partial y} - \\frac{\\partial^2 \\psi}{\\partial y \\partial x} = 0\n\\]\nThe mixed partial derivatives are equal (Schwarz’s theorem), so incompressibility is automatically satisfied.\n(b) Streamlines:\nA streamline is tangent to the velocity vector at every point: \\[\n\\frac{dy}{dx} = \\frac{v}{u}\n\\]\nAlong a curve of constant \\(\\psi\\): \\[\nd\\psi = \\frac{\\partial \\psi}{\\partial x}dx + \\frac{\\partial \\psi}{\\partial y}dy = -v\\,dx + u\\,dy = 0\n\\]\nTherefore: \\(\\frac{dy}{dx} = \\frac{v}{u}\\), confirming that lines of constant \\(\\psi\\) are streamlines.\n(c) Volume flux:\nThe volume flux through a curve from point A to point B is: \\[\nQ = \\int_A^B \\mathbf{u}\\cdot \\hat{\\mathbf{n}} \\, ds\n\\]\nwhere \\(\\hat{\\mathbf{n}}\\) is the normal to the curve. Using the stream function definition and Stokes’ theorem, this equals: \\[\nQ = \\psi_B - \\psi_A\n\\]\nThe volume flux between streamlines is simply the difference in their \\(\\psi\\) values.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>12</span>  <span class='chapter-title'>Non-dimensional equations & dimensionless numbers</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/StokesFlowApplications.html",
    "href": "DraftMaterial/StokesFlowApplications.html",
    "title": "Applications of Stokes Flow",
    "section": "",
    "text": "Rayleigh-Taylor Instability & Diapirism\nA number of related solutions exist to problems such as unstable layering breaking down, buckling of viscous layers and rebound of topography when surface loading changes.\nDiapirism is the buoyant upwelling of rock which is lighter than its surroundings. This can include mantle plumes and other purely thermal phenomena but it often applied to compositionally distinct rock masses such as melts infiltrating the crust (in the Archean) or salt rising through denser sediments.\nSalt layers may result from the evaporation of seawater. If subsequent sedimentation covers the salt, a gravitionally unstable configuration results with heavier material (sediments) on top of light material (salt). The rheology of salt is distinctly non-linear and also sensitive to temperature. Once buried, the increased temperature of the salt layer causes its viscosity to decrease to the point where instabilities can grow. Note, since there is always a strong density contrast between the two rock types, the critical Rayleigh number argument does not apply – this situation is always unstable, but instabilities can only grow at a reasonable rate once the salt has become weak.\nThe geometry is outlined above in Figure 13.1. We suppose initially that the surface is slightly perturbed with a form of\n\\[\nw_m = w_{m0} \\cos kx\n\\]\nwhere \\(k\\) is the wavenumber, \\(k=2\\pi / \\lambda\\), \\(\\lambda\\) being the wavelength of the disturbance. We assume that the magnitude of the disturbance is always much smaller than the wavelength.\nThe problem is easiest to solve if we deal with the biharmonic equation for the stream function. Experience leads us to try to separate variables and look for solutions of the form\n\\[\n\\psi = \\left( A \\sin kx + B \\cos kx \\right ) Y(y)\n\\]\nwhere the function \\(Y\\) is to be determined. The form we have chosen for \\(w_m\\) in fact means \\(A=1,B=0\\) which we can assume from now on to simplify the algebra.\nSubstituting the trial solution for \\(\\psi\\) into the biharmonic equation gives\n\\[\n\\frac{d^4 Y}{d y^4} -2k^2 \\frac{d^2 Y}{dy^2} +k^4 Y = 0\n\\]\nwhich has solutions of the form\n\\[\nY = A \\exp(m y)\n\\]\nwhere \\(A\\) is an arbitrary constant. Subtituting gives us an equation for \\(m\\)\n\\[\nm^4 - 2 k^2 m^2 + k^4 = (m^2 - k^2)^2 = 0\n\\tag{13.1}\\]\nor\n\\[\nm = \\pm k\n\\]\nBecause we have degenerate eigenvalues (i.e. of the four possible solutions to the auxilliary equation Equation 13.1, two pairs are equal) we need to extend the form of the solution to\n\\[\nY = (By+A) \\exp(m y)\n\\]\nto give the general form of the solution in this situation to be\n\\[\n\\begin{aligned}\n            \\psi &= \\sin kx \\left( A e^{-ky} + B y e^{-ky} + C e^{ky} + D y e^{ky} \\right)\n\\\\\n        \\mathrm{or, equivalently}\n            \\psi &= \\sin kx \\left( A_1 \\cosh ky + B_1 \\sinh ky + C_1 y \\cosh ky + D_1 y \\sinh ky  \\right)\n\\end{aligned}\n\\tag{13.2}\\]\nThis equation applies in each of the layers separately. We therefore need to find two sets of constants \\(\\{A_1,B_1,C_1,D_1\\}\\) and \\(\\{A_2,B_2,C_3,D_4\\}\\) by the application of suitable boundary conditions. These are known in terms of the velocities in each layer, \\(\\mathbf{v}_1 = \\mathbf{i} u_1 +\\mathbf{j} v_1\\) and \\(\\mathbf{v}_2 = \\mathbf{i} u_2 +\\mathbf{j} v_2\\):\n\\[\n\\begin{aligned}\n                u_1 = v_1 &= 0 \\mathrm{\\hspace{1cm} on \\hspace{1cm}} y = -b \\\\\n                u_2 = v_2 &= 0 \\mathrm{\\hspace{1cm} on \\hspace{1cm}} y = b\n\\end{aligned}\n\\]\ntogether with a continuity condition across the interface (which we assume is imperceptibly deformed\n\\[\nu_1 = u_2  \\mathrm{\\hspace{1cm} and \\hspace{1cm}}\n                v_1 = v_2 \\mathrm{\\hspace{1cm} on \\hspace{1cm}} y = 0\n\\]\nThe shear stress (\\(\\sigma_{xy}\\)) should also be continuous across the interface, which, if we assume equal viscosities, gives\n\\[\n\\frac{\\partial u_1}{\\partial y} + \\frac{\\partial v_1}{\\partial x} =\n    \\frac{\\partial u_2}{\\partial y} + \\frac{\\partial v_2}{\\partial x} \\mathrm{\\hspace{1cm} on \\hspace{1cm}} y = 0\n\\]\nand, to simplify matters, if the velocity is continuous across \\(y=0\\) then any velocity derivatives in the \\(x\\) direction evaluated at \\(y=0\\) will also be continuous (i.e. \\(\\partial v_2 / \\partial x = \\partial v_1 / \\partial x\\)).\nThe expressions for velocity in terms of the solution Equation 13.2 are\n\\[\n\\begin{aligned}\n    u  = -\\frac{\\partial \\psi}{\\partial y} & = -\\sin kx \\left(\n                    (A_1 k + D_1 + C_1 k y) \\sinh ky + (B_1 k + C_1 + D_1 ky) \\cosh ky  \\right) \\\\\n    v  = \\frac{\\partial \\psi}{\\partial x} & = k \\cos kx \\left(\n                    (A_1 +C_1 y)\\cosh ky + (B_1 +D_1 y)  \\sinh ky   \\right)\n\\end{aligned}\n\\]\nFrom here to the solution requires much tedious rearrangement, and the usual argument based on the arbitrary choice of wavenumber \\(k\\) but we finally arrive at\n\\[\n\\begin{gathered}\n            \\psi_1 = A_1 \\sin kx \\cosh ky + \\\\\n                            A_1 \\sin kx \\left[\n                                \\frac{y}{k b^2} \\tanh kb \\sinh ky +\n                                        \\left( \\frac{y}{b} \\cosh ky    \\frac{1}{kb} \\sinh ky \\right) \\cdot\n                                        \\left( \\frac{1}{kb} +\n                                        \\frac{1}{\\sinh bk \\cosh bk} \\right) \\right] \\times \\\\\n                            \\left[ \\frac{1}{\\sinh bk \\cosh bk} - \\frac{1}{(b^2k^2} \\tanh bk \\right] ^{-1}\n\\end{gathered}\n\\tag{13.3}\\]\nThe stream function for the lower layer is found by replacing \\(y\\) with \\(-y\\) in this equation. This is already a relatively nasty expression, but we haven’t finished since the constant \\(A_1\\) remains. This occurs because we have so far considered the form of flows which satisfy all the boundary conditions but have not yet considered what drives the flow in each layer.\nTo eliminate \\(A_1\\), we have to consider the physical scales inherent in the problem itself. We are interested (primarily) in the behaviour of the interface which moves with a velocity \\(\\partial w / \\partial t\\). As we are working with small deflections of the interface,\n\\[\n\\frac{\\partial w}{\\partial t} = \\left. v \\right|_{y=0}\n\\]\nConsider what happens when the fluid above the interface is lighter than the fluid below – this situation is stable so we expect the layering to be preserved, and if the interface is disturbed the disturbance to decay. This implies that there must be a restoring force acting on an element of fluid which is somehow displaced across the boundary at \\(y=0\\) (Figure 13.2).\nThis restoring force is due to the density difference between the displaced material and the layer in which it finds itself. The expression for the force is exactly that from Archimedes principle which explains how a boat can float (only in the opposite direction)\n\\[\n\\left. F_2 \\right|_{y=0} = \\delta x g w (\\rho_2 - \\rho_1)\n\\]\nwhich can be expressed as a normal stress difference (assumed to apply, once again, at the boundary). The viscous component of the normal stress turns out to be zero – proven by evaluating \\(\\partial v / \\partial y\\) at \\(y=0\\) using the expression for \\(\\phi\\) in equation Equation 13.3. Thus the restoring stress is purely pressure\n\\[\n\\left. P_2 \\right|_{y=0} = g w (\\rho_2 - \\rho_1)\n\\]\nThe pressure in terms of the solution (so far) for \\(\\psi\\) is found from the equation of motion in the horizontal direction (substituting the stream function formulation) and is then equated to the restoring pressure above.\n\\[\n(\\rho_1-\\rho_2) g w = -\\frac{4 \\eta k A_1}{b} \\cos kx\n    \\left(\\frac{1}{kb} + \\frac{1}{\\sinh bk \\cosh bk} \\right) \\cdot\n    \\left(   \\frac{1}{\\sinh bk \\cosh bk} - \\frac{1}{(b^2k^2} \\tanh bk \\right)^{-1}\n\\]\nwhich allows us to substitute for \\(A_1\\) in our expression for \\(\\partial w / \\partial t\\) above. Since \\(A_1\\) is independent of \\(t\\), we can see that the solution for \\(w\\) will be of a growing or decaying exponential form with growth/decay constant coming from the argument above.\n\\[\nw(t) = w_0 \\exp((t-t_0)/\\tau)\n\\]\nwhere\n\\[\n\\tau = \\frac{4 \\eta}{(\\rho_1-\\rho_2) g b}\n        \\left( \\frac{1}{kb} + \\frac{1}{\\sinh bk \\cosh bk} \\right) \\cdot\n        \\left(   \\frac{1}{k^2b^2} \\tanh kb - \\frac{1}{\\sinh kb \\cosh kb}     \\right)^{-1}\n\\]\nSo, finally, an answer – the rate at which instabilities on the interface between two layers will grow (or shrink) which depends on viscosity, layer depth and density differences, together with the geometrical consideration of the layer thicknesses.\nA stable layering results from light fluid resting on heavy fluid; a heavy fluid resting on a light fluid is always unstable (no critical Rayleigh number applies) although the growth rate can be so small that no deformation occurs in practice. The growth rate is also dependent on wavenumber. There is a minimum in the growth time as a function of dimensional wavenumber which occurs at \\(k b = 2.4\\), so instabilities close to this wavenumber are expected to grow first and dominate.\nRemember that this derivation is simplified for fluids of equal viscosity, and layers of identical depth. Remember also that the solution is for infinitessimal deformations of the interface. If the deformation grows then the approximations of small deformation no longer hold. This gives a clue as to how difficulties dealing with the advection term of the transport equations arise.\nAt some point it becomes impossible to obtain meaningful results without computer simulation. However, plenty of further work has already been done on this area for non-linear fluids, temperature dependent viscosity &c and the solutions are predictably long and tedious to read, much less solve. When the viscosity is not constant, the use of a stream function notation is not particularly helpful as the biharmonic form no longer appears.\nThe methodology used here is instructive, as it can be used in a number of different applications to related areas. The equations are similar, the boundary conditions different.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Applications of Stokes Flow</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/StokesFlowApplications.html#rayleigh-taylor-instability-diapirism",
    "href": "DraftMaterial/StokesFlowApplications.html#rayleigh-taylor-instability-diapirism",
    "title": "Applications of Stokes Flow",
    "section": "",
    "text": "Figure 13.1: Salt diapirs result when a buried layer of salt(a,b) becomes convectively unstable and rises through the overlying sediment layers (c,d). The idealized geometry for the Rayleigh-Taylor instability problem is outlined in the lower diagram.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nFigure 13.2: The restoring force for a stable layering is proportional to the excess density when a fluid element is displaced across the boundary.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Applications of Stokes Flow</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/StokesFlowApplications.html#post-glacial-rebound",
    "href": "DraftMaterial/StokesFlowApplications.html#post-glacial-rebound",
    "title": "Applications of Stokes Flow",
    "section": "Post-Glacial Rebound",
    "text": "Post-Glacial Rebound\n\n\n\n\n\n\nFigure 13.3: The relaxation of the Earth’s surface after removal of an ice load.\n\n\n\nIn the postglacial rebound problem, consider a viscous half space with an imposed topography at \\(t=0\\). The ice load is removed at \\(t=0\\) and the interface relaxes back to its original flat state.\nThis can be studied one wavenumber at a time — computing a decay rate for each component of the topography. The intial loading is computed from the fourier transform of the ice bottom topography.\nThe system is similar to that of the diapirs except that the loading is now applied to one surface rather than the interface between two fluids.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Applications of Stokes Flow</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/StokesFlowApplications.html#phase-changes-in-the-mantle",
    "href": "DraftMaterial/StokesFlowApplications.html#phase-changes-in-the-mantle",
    "title": "Applications of Stokes Flow",
    "section": "Phase Changes in the mantle",
    "text": "Phase Changes in the mantle\nA different interface problem is that of mantle phase changes. Here a bouyancy anomaly results if the phase change boundary is distorted. This can result from advection normal to the boundary bringing cooler or warmer material across the boundary.\nThe buoyancy balance argument used above can be recycled here to determine a scaling for the ability of plumes/downwellings to cross the phase boundary.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Applications of Stokes Flow</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/StokesFlowApplications.html#kernels-for-surface-observables",
    "href": "DraftMaterial/StokesFlowApplications.html#kernels-for-surface-observables",
    "title": "Applications of Stokes Flow",
    "section": "Kernels for Surface Observables",
    "text": "Kernels for Surface Observables\nThe solution method used for the Rayleigh Taylor problem can also be used in determining spectral Green’s functions for mantle flow in response to thermal perturbations. This is a particularly abstract application of the identical theory.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Applications of Stokes Flow</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/StokesFlowApplications.html#folding-of-layered-viscous-medium",
    "href": "DraftMaterial/StokesFlowApplications.html#folding-of-layered-viscous-medium",
    "title": "Applications of Stokes Flow",
    "section": "Folding of Layered (Viscous) Medium",
    "text": "Folding of Layered (Viscous) Medium\n\n\n\n\n\n\nFigure 13.4: Instability in a thin, viscous layer compressed from both ends.\n\n\n\nIf a thin viscous layer is compressed from one end then it may develop buckling instabilities in which velocities grow perpendicular to the plane of the layer.\nIf the layer is embedded between two semi-infinite layers of viscous fluid with viscosity much smaller than the viscosity of the layer, then Biot theory tells us the wavelength of the initial buckling instability, and the rate at which it grows.\nThe fold geometry evolves as\n\\[\nw=w_m \\cos(kx) e^{\\frac{t}{\\tau_a}}\n\\]\nwhere\n\\[\n\\tau_a = \\frac{1}{\\bar{P}}\\left[ \\frac{4 \\eta_0}{k} + \\frac{\\eta_1 h^3}{3k^2} \\right]\n\\]\nand the fastest growing wavenumber is\n\\[\nk = \\frac{6}{h}\\left( \\frac{\\eta_1}{\\eta_0} \\right)^{\\frac{1}{3}}\n\\]\nFor large deformations we eventually must resort to numerical simulation.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Applications of Stokes Flow</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/StokesFlowApplications.html#gravity-currents",
    "href": "DraftMaterial/StokesFlowApplications.html#gravity-currents",
    "title": "Applications of Stokes Flow",
    "section": "Gravity Currents",
    "text": "Gravity Currents\n\n\n\n\n\n\nFigure 13.5: A gravity current is the spreading of a dense fluid under its own weight across a horizontal surface (or a buoyant fluid under a surface). Open the fridge door and the cold air falls out as a gravity current.\n\n\n\nGravity currents can occur when a viscous fluid flows under its own weight as shown in Figure 13.5.\nWe assume that the fluid has constant viscosity, \\(\\eta\\) and that the length of the current is considerably greater than its height. The fluid is embedded in a low viscosity medium of density \\(\\rho-\\Delta \\rho\\) where \\(\\rho\\) is the density of the fluid itself.\nThe force balance is between buoyancy and viscosity. The assumptions of geometry allow us to simplify the Stokes equation by assuming horizontal pressure gradients due to the surface slope drive the flow.\n\\[\n\\nabla p = \\eta\\nabla^2 u \\approx   g \\Delta \\rho \\frac{\\partial h}{\\partial x}\n\\]\nWe assume near-zero shear stress at the top of the current to give\n\\[\n\\frac{\\partial u}{\\partial z} (x,h,t) = 0\n\\]\nand zero velocity at the base of the current. Hence\n\\[\nu(x,z,t) = -\\frac{1}{2} \\frac{g \\Delta \\rho}{\\eta} \\frac{\\partial h}{\\partial x}  z(2h-z)\n\\]\nContinuity integrated over depth implies\n\\[\n\\frac{\\partial h}{\\partial t} + \\frac{\\partial }{\\partial x} \\int_0^h u dz = 0\n\\]\nCombining these equations gives\n\\[\n\\frac{\\partial h}{\\partial t} -\\frac{1}{3} \\frac{g \\Delta \\rho}{\\eta}\n                     \\frac{\\partial }{\\partial x}  \\left( h^3 \\frac{\\partial h}{\\partial x} \\right) = 0\n\\]\nFinally, a global constraint fixes the total amount of fluid at any given time\n\\[\n\\int_0^{x_N(t)} h(x,t)dx = qt^\\alpha\n\\]\nThe latter term being a fluid source at the origin, and \\(x_{N(t)}\\) the location of the front of the current. A similarity variable is the key to solving this problem:\n\\[\n\\nu = \\left( \\frac{1}{3} g\\Delta \\rho q^3 / \\eta \\right)^{-\\frac{1}{5}} x t^{-(3\\alpha +1) / 5}\n\\]\ngiving a solution of the form\n\\[\nh(x,t) = \\nu_N^{2/3} (3q^2 \\eta / (g\\Delta\\rho))^{1/5} t^{(2\\alpha -1) / 5} \\phi(\\nu/\\nu_N)\n\\]\nwhere \\(\\nu_N\\) is the value of \\(\\nu\\) at \\(x=x_N(t)\\). Substituting into the equation for \\(\\partial h / \\partial t\\) we find that \\(\\phi(\\nu/\\nu_N)\\) satisfies\n\\[\n\\phi({\\nu}/{\\nu_N}) = \\left[ \\frac{3}{5}(3\\alpha+1)\\right]^{\\frac{1}{3}}\n                \\left(1-\\frac{\\nu}{\\nu_N} \\right)^{\\frac{1}{3}} \\left[\n                1 - \\frac{3\\alpha-4}{24(3\\alpha+1)}\\left(1-\\frac{\\nu}{\\nu_N} \\right) + O \\left(1-\\frac{\\nu}{\\nu_N} \\right)^2\n                \\right]\n\\]\nWhich has an analytic solution if \\(\\alpha=0\\) (only constant sources or sinks)\n\\[\n\\begin{split}\n            \\phi({\\nu}/{\\nu_N}) &= \\left( \\frac{3}{10}\\right)^{\\frac{1}{3}}\n            \\left( 1-\\left(\\frac{\\nu}{\\nu_N}\\right)^2 \\right)^{\\frac{1}{3}}  \\\\\n        \\nu_N &= \\left[ \\frac{1}{5} \\left( \\frac{3}{10}\\right)^{\\frac{1}{3}}  \\pi^{\\frac{1}{2}}\n    \\Gamma (1/3) / \\Gamma (5/6) \\right]^{-\\frac{3}{5}} = 1.411\n\\end{split}\n\\]\nFor all other values of \\(\\alpha\\) numerical integration schemes must be used for \\(\\phi\\).\nIt is also possible to obtain solutions if axisymmetric geometry is used.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>13</span>  <span class='chapter-title'>Applications of Stokes Flow</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ThermalConvection.html",
    "href": "DraftMaterial/ThermalConvection.html",
    "title": "Thermal Convection",
    "section": "",
    "text": "Critical Rayleigh Number for a layer\nThermal convection describes the a process in which a fluid organizes itself into a structured flow pattern on a macroscopic scale to transport energy. Convection may be mechanically driven by stirring, but more commonly we refer to natural convection in which buoyancy due to a source of heat (and/or compositional variation) induces flow which transports and dissipates this anomalous buoyancy.\nThe Earth’s interior, on a geological timescale is a highly viscous fluid which is heated from below by heat escaping from the core, and internally by the decay of radioactive elements. In this respect\nDescription - what is involved ...\nGoal is to understand finite amplitude convection with complicated rheology and realistic initial, boundary conditions.\nDoes convection always occur in a layer heated from below ? In principle this would always provide a way to transport additional heat, but how much work would convection have to do in order to transport this extra heat ? One way to determine the answer is to consider small disturbances to a layer with otherwise uniform temperature and see under what conditions the perturbations grow (presumably into fully developed convection). This approach allows us to make linear approximations to the otherwise non-linear equations by dropping the small, high order non-linear terms.\nWe solve the incompressible flow equations (stream function form, Equation 12.4) and energy conservation equation in stream function form:\n\\[\n\\frac{\\partial T}{\\partial t} +\n                 \\left[     -\\frac{\\partial \\psi}{\\partial x_2}\\frac{\\partial T}{\\partial x_1}\n                            +\\frac  {\\partial \\psi}{\\partial x_1}\\frac{\\partial T}{\\partial x_2} \\right]\n                        = \\nabla^2 T\n\\]\nBy substituting throughout for a temperature which is a conductive profile with a small amplitude disturbance, \\(\\theta \\ll 1\\)\n\\[\nT = 1- x_2 + \\theta\n\\]\nRemember that the equations are non-dimensional so that the layer depth is one, and the temperature drop is one.\nThe advection term\n\\[\n-\\frac{\\partial \\psi}{\\partial x_2}\\frac{\\partial T}{\\partial x_1}\n                            +\\frac  {\\partial \\psi}{\\partial x_1}\\frac{\\partial T}{\\partial x_2} \\rightarrow\n                    -\\frac{\\partial \\psi}{\\partial x_2}\\frac{\\partial \\theta}{\\partial x_1} -\\frac{\\partial \\psi}{\\partial x_1}\n                    +\\frac  {\\partial \\theta}{\\partial x_2}\\frac{\\partial \\psi}{\\partial x_1}\n\\]\nis dominated by the \\(\\partial \\psi / \\partial x_1\\) since all others are the product of small terms. (Since we also know that \\(\\psi \\sim \\theta\\) from equation (Equation 12.4)). Therefore the energy conservation equation becomes\n\\[\n\\frac{\\partial \\theta}{\\partial t} - \\frac{\\partial \\psi}{\\partial x_1} = \\nabla^2 \\theta\n\\]\nwhich is linear.\nBoundary conditions for this problem are zero normal velocity on \\(x_2 = 0,1\\) which implies \\(\\psi=0\\) at these boundaries. The form of the perturbation is such that \\(\\theta =0\\) on \\(x_2 = 0,1\\), and we allow free slip along these boundaries such that\n\\[\n\\sigma_{12} = \\frac{\\partial v_1}{\\partial x_2} + \\frac{\\partial v_2}{\\partial x_1} =0\n\\]\nwhen \\(x_2 = 0,1\\) which implies \\(\\nabla^2 \\psi =0\\) there.\nNow introduce small harmonic perturbations to the driving terms and assuming a similar (i.e. harmonic) response in the flow. This takes the form\n\\[\n\\begin{split}\n                    \\theta &= \\Theta(x_2) \\exp(\\sigma t) \\sin kx_1 \\\\\n                    \\psi &= \\Psi(x_2) \\exp(\\sigma t) \\cos kx_1\n                \\end{split}\n\\]\nSo that we can now separate variables. \\(\\sigma\\) is unknown, however, if \\(\\sigma &lt; 0\\) then the perturbations will decay, whereas if \\(\\sigma &gt; 0\\) they will grow.\nSubstituting for the perturbations into the biharmonic equation and the linearized energy conservation equation gives\n\\[\n\\left(\\frac{d^2}{d{x_2}^2} -k^2 \\right)^2 \\Psi = -{\\rm Ra} k \\Theta\n\\tag{14.1}\\]\nand\n\\[\n\\sigma \\Theta + k \\Psi =    \\left(\\frac{d^2}{d{x_2}^2} -k^2 \\right) \\Theta\n\\]\nHere we have shown and used the fact that\n\\[\n\\nabla^2 \\equiv \\left(\\frac{\\partial^2}{\\partial {x_2}^2} -k^2 \\right)\n\\tag{14.2}\\]\nwhen a function is expanded in the form \\(\\phi(x,z) = \\Phi(z).\\sin kx\\) – more generally, this is the fourier transform of the Laplacian operator.\nEliminating \\(\\Psi\\) between (Equation 14.1) and (Equation 14.2) gives\n\\[\n\\sigma \\left(\\frac{d^2}{d {x_2}^2 } - k^2 \\right)^2 -{\\rm Ra} k^2 \\Theta =\n                \\left(\\frac{d^2}{d {x_2}^2} -k^2 \\right)^3 \\Theta\n\\]\nThis has a solution\n\\[\n\\Theta = \\Theta_0 \\sin \\pi z\n\\]\nwhich satisfies all the stated boundary conditions and implies\n\\[\n\\sigma =  \\frac{k^2 {\\rm Ra}}{(\\pi^2 + k^2)^2} -(\\pi^2 + k^2)\n\\]\na real function of \\(k\\) and \\(\\rm Ra\\).\nFor a given wavenumber, what is the lowest value of \\(\\rm Ra\\) for which perturbations at that wavenumber will grow ?\n\\[\n= \\frac{(\\pi^2 + k^2)^3}{k^2}\n\\]\nThe absolute minimum value of \\({\\rm Ra}\\) which produces growing perturbations is found by differentiating \\({\\rm Ra_0}\\) with respect to \\(k\\) and setting equal to zero to find the extremum.\n\\[\n{\\rm Ra_c} = \\frac{27}{4} \\pi^4 = 657.51\n\\]\nfor a wavenumber of\n\\[\nk = \\frac{\\pi}{2^{1/2}} = 2.22\n\\]\ncorresponding to a wavelength of 2.828 times the depth of the layer.\nDifferent boundary conditions produce different values of the critical Rayleigh number. If no-slip conditions are used, for example, then the \\(\\Theta\\) solution applied above does not satisfy the boundary conditions. In general, the critical Rayleigh number lies between about 100 and 3000.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Thermal Convection</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ThermalConvection.html#critical-rayleigh-number-for-a-layer",
    "href": "DraftMaterial/ThermalConvection.html#critical-rayleigh-number-for-a-layer",
    "title": "Thermal Convection",
    "section": "",
    "text": "Figure 14.1: Critical Rayleigh Number determination. A plot of growth rates for harmonic perturbations as a function of wavenumber for different \\({\\rm Ra}\\). The critical value occurs when the maximum of the curve just touches the horizontal axis at zero.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Thermal Convection</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ThermalConvection.html#boundary-layer-theory-boundary-rayleigh-number",
    "href": "DraftMaterial/ThermalConvection.html#boundary-layer-theory-boundary-rayleigh-number",
    "title": "Thermal Convection",
    "section": "Boundary layer theory, Boundary Rayleigh Number",
    "text": "Boundary layer theory, Boundary Rayleigh Number\nHaving determined the conditions under which convection will develop, we next consider what can be calculated about fully developed convection – i.e. when perturbations grow well beyond the linearization used to study the onset of instability.\nLet’s consider fully developed convection with high Rayleigh number. From observations of real fluids in laboratory situations, it is well known how this looks. High Rayleigh number convection is dominated by the advection of heat. Diffusion is too slow to carry heat far into the fluid before the buoyancy anomaly becomes unstable. This leads to thin, horizontal “boundary layers” where diffusive heat transfer into and out of the fluid occurs. These are separated by approximately isothermal regions in the fluid interior. The horizontal boundary layers are connected by vertical boundary layers which take the form of sheets or cylindrical plumes depending on a number of things including the Rayleigh number. For the time being we consider only the sheet like downwellings since that allows us to continue working in 2D.\n\n\n\n\n\n\nFigure 14.2: Boundary Layer Theory in its simplest form\n\n\n\nBoundary layer analysis is a highly sophisticated field, and is used in a broad range of situations where differences in scales between different physical effects produce narrow accommodation zones where the ‘weaker’ term dominates (e.g viscosity in ‘invicid’ flow around an obstacle).\nHere we first make a wild stab at an approximate theory describing the heat flow from a layer with a given Rayleigh number. The convective flow is shown in Figure 1 together with our rough sketch of what actually happens.\nAssuming the simplified flow pattern of the sketch, steady state, and replacing all derivatives by crude differences we obtain (using a vorticity form)\n\\[\n\\kappa \\nabla^2 T = (\\mathbf{v} \\cdot \\nabla) T\n                    \\mbox{\\hspace{1cm}} \\longrightarrow \\mbox{\\hspace{1cm}}\n                \\frac{v \\Delta T}{d} \\sim \\frac{\\Delta T \\kappa}{\\delta^2}\n\\] and\n\\[\n\\nabla^2 \\omega = \\frac{g \\rho \\alpha}{\\eta} \\frac{\\partial T}{\\partial x}\n                    \\mbox{\\hspace{1cm}} \\longrightarrow \\mbox{\\hspace{1cm}}\n                \\frac{\\omega}{\\delta ^2}    \\sim  \\frac{g \\rho \\alpha \\Delta T}{\\eta \\delta}\n\\]\nwhere \\(\\omega\\sim v / d\\) from the local rotation interpretation of vorticity and the approximate rigid-body rotation of the core of the convection cell, and \\(v/d \\sim \\kappa / \\delta^2\\).\nThis gives\n\\[\n\\begin{aligned}\n            \\frac{\\delta}{d} & \\sim {\\rm Ra}^{-1/3} \\\\\n            v & \\sim \\frac{\\kappa}{d} {\\rm Ra}^{2/3}\n        \\end{aligned}\n\\]\nThis theory balances diffusion of vorticity and temperature across and out of the boundary layer with advection of each quantity along the boundary layer to maintain a steady state.\nThe Nusselt number is the ratio of advected heat transport to that purely conducted in the absence of fluid motion, or, using the above approximations,\n\\[\n\\begin{split}   \n                {\\rm Nu}    & \\sim \\frac{\\rho C_p v \\Delta T \\delta}{(k \\Delta T/d)d} \\\\\n                                & \\sim {\\rm Ra}^{1/3}\n            \\end{split}\n\\]\nThis latter result being observed in experiments to be in reasonably good agreement with observation.\nIf we define a boundary Rayleigh number\n\\[\n{\\rm Ra_b} = \\frac{g \\rho \\alpha \\Delta T \\delta^3}{\\kappa \\eta}\n\\]\nthen the expression for \\(\\delta\\) gives\n\\[\n{\\rm Ra_b} \\sim 1\n\\]\nso the boundary layer does not become more or less stable with increasing Rayleigh number (this is not universal – for internal heating the boundary layer becomes less stable at higher Rayleigh number).\n\n\n\n\n\n\nFigure 14.3: Boundary Layer Theory which accounts for the thickness variations along the boundary layer as it matures.\n\n\n\nAnother wrinkle can be added to the boundary layer theory by trying to account for the variation in the boundary layer thickness as it moves along the horizontal boundary. This refinement in the theory can account for the form of this thickness, the potential energy change in rising or sinking plumes, and the aspect ratio of the convection (width to height of convection roll) by maximizing Nusselt number as a function of aspect ratio.\nConsider the boundary layer to be very thin above the upwelling plume (left side). As it moves to the right, it cools and the depth to any particular isotherm increases (this is clearly seen in the simulation). This can be treated exactly like a one dimensional problem if we work in the Lagrangian frame of reference attached to the boundary layer. That is, take the 1D half-space cooling model and replace the time with \\(x_1/v\\) (cf. the advection equation in which time and velocity / lengths are mixed).\nThe standard solution is as follows. Assume a half-space at an intial temperature everywhere of \\(T_0\\) to which a boundary condition, \\(T=T_s\\) is applied at \\(t=0,x_2=0\\).\nWe solve for \\(T(x_2,t)\\) by first making a substitution,\n\\[\n\\theta = \\frac{T-T_0}{T_s-T_0}\n\\]\nwhich is a dimensionless temperature, into the standard diffusion equation to obtain\n\\[\n\\frac{\\partial \\theta(x_2,t)}{\\partial t} = \\kappa \\frac{\\partial ^2 \\theta(x_2,t)}{\\partial {x_2}^2}\n\\tag{14.3}\\]\nThe boundary conditions on \\(\\theta\\) are simple:\n\\[\n\\begin{aligned}\n                & \\theta(x_2,0) = 0 \\\\\n                & \\theta(0,t) = 1   \\\\\n                & \\theta(\\infty,0) = 0      \n            \\end{aligned}\n\\]\n\n\n\n\n\n\nFigure 14.4: Cooling half-space calculation\n\n\n\nIn place of \\(t,x_2\\), we use the similarity transformation,\n\\[\n\\eta = \\frac{x_2}{2\\sqrt{\\kappa t}}\n\\]\nwhich is found (more or less) intuitively. Now we need to substitute\n\\[\n\\begin{aligned}\n            \\frac{\\partial \\theta}{\\partial t} & = -\\frac{d \\theta}{d\\eta}(\\eta/2t) \\\\\n            \\frac{\\partial^2 \\theta}{\\partial {x_2}^2} & = \\frac{1}{4\\kappa t}\\frac{d^2 \\theta}{d \\eta^2}\n        \\end{aligned}\n\\]\nto transform (Equation 14.3) into\n\\[\n-\\eta \\frac{d \\theta}{d\\eta} = \\frac{1}{2} \\frac{d^2 \\theta}{d \\eta^2}\n\\tag{14.4}\\]\nBoundary conditions transform to give\n\\[\n\\begin{aligned}\n                & \\theta(\\eta=\\infty) = 0   \\\\\n                & \\theta(\\eta=0) = 1    \n            \\end{aligned}\n\\]\nWrite \\(\\phi = d\\theta / d\\eta\\) (for convenience only) to rewrite (Equation 14.4) as\n\\[\n\\begin{aligned}\n                -\\eta \\phi &= \\frac{1}{2} \\frac{d \\phi}{d \\eta}     \\\\\n            \\intertext{or}\n                -\\eta d\\eta &= \\frac{1}{2} \\frac{d\\phi}{\\phi}   \n            \\end{aligned}\n\\]\nThis is a standard integral with solution\n\\[\n\\begin{aligned}\n                & -\\eta^2 = \\log_e \\phi -\\log_e c_1 \\\\\n            \\intertext{such that}\n                & \\phi = c_1 \\exp(-\\eta^2) = \\frac{d\\theta}{d\\eta}\n            \\end{aligned}\n\\]\nThis latter form is then integrated to give the solution:\n\\[\n\\theta = c_1 \\int_0^\\eta    \\exp(-{\\eta'}^2) d\\eta' +1\n\\]\nBoundary conditions give\n\\[\n\\theta = 1- \\frac{2}{\\sqrt{\\pi}} \\int_0^\\eta\\exp(-{\\eta'}^2) d\\eta'\n\\]\nWhich is the definition of the complementary error function (\\(\\mbox{\\rm erfc}(\\eta)\\)).\nUndoing the remaining substitutions gives\n\\[\n\\frac{T-T_0}{T_s-T_0}   = \\mbox{\\rm erfc}\\left(   \\frac{x_2}{2\\sqrt{\\kappa t}} \\right)\n\\]\nIn our original context of the cooling boundary layer, then, the \\(T_    s\\) is the surface temperature, \\(T_0\\) is the interior temperature of the convection cell (\\(\\Delta T /2\\)) and \\(t \\leftarrow x_1/v\\). The thickness of the boundary layer is found by assuming it is defined by a characteristic isotherm (doesn’t much matter which). The progression of this isotherm is\n\\[\n\\delta \\propto \\sqrt{\\kappa t}\n\\]\nor, in the Eulerian frame\n\\[\n\\delta \\propto \\sqrt{\\kappa x_1 / v}\n\\]",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Thermal Convection</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ThermalConvection.html#internal-heating",
    "href": "DraftMaterial/ThermalConvection.html#internal-heating",
    "title": "Thermal Convection",
    "section": "Internal Heating",
    "text": "Internal Heating\nThe definition of the Rayleigh number when the layer is significantly internally heated is\n\\[\n{\\rm Ra} = \\frac{g \\rho^2 \\alpha H d^5}{\\eta \\kappa k}\n\\] where \\(H\\) is the rate of internal heat generation per unit mass.\nThe rigorous definition of the Nusselt number is the heat flow through the upper surface divided by the average basal temperature. This allows a Nusselt number to be calculated for internally heated convection where the basal temperature is not known a priori\nInternally heated convection is a problem to simulate in the lab, directly, but the same effect is achieved by reducing the temperature of the upper surface as a function of time.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Thermal Convection</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ThermalConvection.html#when-viscosity-is-not-constant",
    "href": "DraftMaterial/ThermalConvection.html#when-viscosity-is-not-constant",
    "title": "Thermal Convection",
    "section": "When Viscosity is Not Constant",
    "text": "When Viscosity is Not Constant\nWhen viscosity is not constant, the equations are considerably complicated. It is no longer possible to form a pure biharmonic equation since \\(\\eta(x,z)\\) cannot be taken outside the differential operators. Nor can stream-function / vorticity formulations be used directly for the same reasons. Spectral methods — the decomposition of the problem into a sum of independent problems in the wavenumber domain — is no longer simple since the individual problems are coupled, not independent.\nThe Rayleigh number is no longer uniquely defined for the system since the viscosity to which it refers must take some suitable average over the layer — the nature of this average depends on the circumstances.\nThe form of convection changes since boundary layers at the top and bottom of the system (cold v hot) are no longer symmetric with each other.\nThe convecting system gains another control parameter which is a measure of the viscosity contrast as a function of temperature.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Thermal Convection</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ThermalConvection.html#applications-and-discussion",
    "href": "DraftMaterial/ThermalConvection.html#applications-and-discussion",
    "title": "Thermal Convection",
    "section": "Applications and Discussion",
    "text": "Applications and Discussion\nThe application of realistic convection models to the Earth and other planets — particularly Venus.\nThe simplest computational and boundary layer solutions to the Stokes’ convection equations made the simplifying assumption that the viscosity was constant. Despite the experimental evidence which suggests viscosity variations should dominate in the Earth, agreement with some important observations was remarkably good.\nThe simulations were not able to produce plate-like motions at the surface (instead producing smoothly distributed deformation) but the average velocity, the heat flow and the observed pattern of subsidence of the ocean floor were well matched.\n\nMantle Rheology\nExperimental determination of the rheology of mantle materials gives\n\\[\n\\dot{\\epsilon} \\propto \\sigma^n d^{-m} \\exp\\left( -\\frac{E+PV}{RT} \\right)\n\\]\nwhere \\(\\sigma\\) is a stress, \\(d\\) is grain size, \\(E\\) is an activation energy, \\(V\\) is an activation volume, and \\(T\\) is absolute temperature. (\\(R\\) is the universal gas constant).\nThis translates to a viscosity\n\\[\n\\eta \\propto \\sigma^{1-n} d^m exp\\left( \\frac{E+PV}{RT} \\right)\n\\]\nIn the mantle two forms of creep are possible, dislocation creep with \\(n ~ 3.0\\), \\(m~0\\), \\(E ~ 430-540 KJ/mol\\), \\(V ~ 10 - 20 cm^3/mol\\); and diffusion creep with \\(n ~ 1.0\\), \\(m~2.5\\), \\(E ~ 240-300 KJ/mol\\), \\(V ~ 5-6 cm^3/mol\\). This is for olivine — other minerals will produce different results, of course.\n\n\nConvection with Temperature Dependent Viscosity\nMore sophisticated models included the effect of temperature dependent viscosity as a step towards more realistic simulations. In fact, the opposite was observed: convection with temperature dependent viscosity is a much worse description of the oceanic lithosphere than constant viscosity convection. It may, however, describe Venus rather well.\nTheoretical studies of the asymptotic limit of convection in which the viscosity variation becomes very large (comparable to values determined for mantle rocks in laboratory experiments) find that the upper surface becomes entirely stagnant with little or no observable motion. Vigorous convection continues underneath the stagnant layer with very little surface manifestation.\nThis theoretical work demonstrates that the numerical simulations are producing correct results, and suggests that we should look for physics beyond pure viscous flow in explaining plate motions.\n\n\nNon-linear Viscosity and localisation\nRealistic rheological laws show the viscosity may depend upon stress. This makes the problem non-linear since the stress clearly depends upon viscosity. In order to obtain a solution it is necessary to iterate velocity and viscosity until they no longer change.\nThe obvious association of plate boundaries with earthquake activity suggests that relevant effects are to be found in the brittle nature of the cold plates. Brittle materials have a finite strength and if they are stressed beyond that point they break. This is a familiar enough property of everyday materials, but rocks in the lithosphere are non-uniform, subject to great confining pressures and high temperatures, and they deform over extremely long periods of time. This makes it difficult to know how to apply laboratory results for rock breakage experiments to simulations of the plates.\nAn ideal, very general rheological model for the brittle lithosphere would incorporate the effects due to small-scale cracks, faults, ductile shear localization due to dynamic recrystalization, anisotropy (... kitchen sink). Needless to say, most attempts to date to account for the brittle nature of the plates have greatly simplified the picture. Some models have imposed weak zones which represent plate boundaries, others have included sharp discontinuities which represent the plate-bounding faults, still others have used continuum methods in which the yield properties of the lithosphere are known but not the geometry of any breaks. Of these approaches, the continuum approach is best able to demonstrate the spectrum of behaviours as convection in the mantle interacts with brittle lithospheric plates. For studying the evolution of individual plate boundaries methods which explicitly include discontinuities work best.\nThe simplest possible continuum formulation includes a yield stress expressed as an non-linear effective viscosity.\n\\[\n\\eta_{\\rm eff} = \\frac{\\tau_{\\rm yield}}{\\dot{\\varepsilon}}\n\\]\nThis formulation can be incorporated very easily into the mantle dynamics modeling approach that we have outlined above as it involves making modifications only to the viscosity law. There may be some numerical difficulties, however, as the strongly non-linear rheology can lead to dramatic variations in the viscosity across relatively narrow zones.\n\n\nThermochemical Convection\nThe Rayleigh number is defined in terms of thermal buoyancy but other sources of buoyancy are possible in fluids.\nFor example, in the oceans, dissolved salt makes water heavy. When hot salty water (e.g. the outflows of shallow seas such as the Mediterranean) mixes with cold less salty water, there is a complicated interaction.\nThis is double diffusive convection and produces remarkable layerings etc since the diffusion coefficients of salt and heat are different by a factor of 100.\nIn the mantle, bulk chemical differences due to subduction of crustal material can be treated in a similar manner. From the point of view of the diffusion equations, the diffusivity of bulk chemistry in the mantle is tiny (pure advection).\nFluid flows with chemical v. thermal bouyancy are termed thermochemical convection problems.",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Thermal Convection</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ThermalConvection.html#exercises",
    "href": "DraftMaterial/ThermalConvection.html#exercises",
    "title": "Thermal Convection",
    "section": "Exercises",
    "text": "Exercises\n\n\n\n\n\n\nWarning🚧 Under Review\n\n\n\n\n\nThis exercises section is newly added and tailored to thermal convection theory. The exercises focus on key concepts from the chapter but need expansion with additional problems on linear stability analysis and numerical methods.\nChanges made: - Created 6 exercises aligned with thermal convection concepts - Added 2 worked solutions with detailed explanations - Exercises cover: critical Rayleigh number, Nusselt number, boundary layers, time-dependence, internal heating, and compressibility - Need to add: exercises on linear stability theory, perturbation analysis, experimental validation\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nExercises marked with ⭐ have worked solutions provided. Additional exercises will be added as the chapter develops.\n\n\n\nExercise 1: Critical Rayleigh Number ⭐\nFor thermal convection in a layer heated from below:\n\nExplain physically why there is a critical Rayleigh number below which convection cannot occur\nHow does the critical Rayleigh number depend on the boundary conditions (free-slip vs. no-slip)?\nWhy is the critical Rayleigh number different for different wavelengths of perturbations?\n\n\n\nExercise 2: Nusselt Number Scaling\n\nDerive the definition of the Nusselt number as the ratio of total heat flux to conductive heat flux\nExplain why \\(Nu = 1\\) for pure conduction\nFor mantle convection with \\(Ra \\sim 10^7\\), estimate the Nusselt number using the scaling \\(Nu \\sim Ra^\\beta\\). What value of \\(\\beta\\) is appropriate?\n\n\n\nExercise 3: Thermal Boundary Layer Thickness ⭐\nUsing boundary layer theory:\n\nEstimate the thermal boundary layer thickness \\(\\delta\\) as a function of Rayleigh number\nFor Earth’s mantle with \\(Ra \\sim 10^7\\) and layer depth \\(h = 2900\\) km, calculate \\(\\delta\\)\nCompare this to estimates from seismic observations of the D” layer\n\n\n\nExercise 4: Steady vs. Time-Dependent Convection\n\nAt what Rayleigh number does the transition from steady to time-dependent convection typically occur?\nDescribe the physical mechanism that causes time-dependence at high \\(Ra\\)\nHow does this relate to plate tectonics on Earth?\n\n\n\nExercise 5: Internal Heating\nModify the governing equations to include internal heating rate \\(H\\) (W/kg):\n\nAdd the internal heating term to the energy equation\nDefine an appropriate internal heating Rayleigh number\nDiscuss how internal heating changes the convection pattern compared to bottom heating only\n\n\n\nExercise 6: Compressibility Effects\n\nUnder what conditions can the Boussinesq approximation be used for planetary mantles?\nDerive the anelastic approximation starting from the full compressible equations\nCalculate the adiabatic temperature gradient for Earth’s mantle and compare to the actual geotherm",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Thermal Convection</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/ThermalConvection.html#solutions-to-selected-exercises",
    "href": "DraftMaterial/ThermalConvection.html#solutions-to-selected-exercises",
    "title": "Thermal Convection",
    "section": "Solutions to Selected Exercises",
    "text": "Solutions to Selected Exercises\n\n\n\n\n\n\nTipSolution to Exercise 1: Critical Rayleigh Number\n\n\n\n\n\n(a) Physical explanation:\nConvection requires that buoyancy forces overcome viscous resistance. At low Rayleigh numbers, viscous forces are too strong and any perturbation is damped. The critical \\(Ra_c\\) represents the threshold where buoyancy and viscous forces balance.\nBelow \\(Ra_c\\): Conduction is stable (viscous damping dominates) Above \\(Ra_c\\): Convection occurs (buoyancy dominates)\n(b) Boundary condition dependence:\n\nFree-slip boundaries: \\(Ra_c \\approx 657\\) (easier to convect)\nNo-slip boundaries: \\(Ra_c \\approx 1708\\) (harder to convect)\nOne free, one no-slip: \\(Ra_c \\approx 1101\\) (intermediate)\n\nNo-slip boundaries require higher \\(Ra\\) because they impose additional constraints on the flow, increasing viscous dissipation.\n(c) Wavelength dependence:\nThe Rayleigh number in linear stability analysis is wavelength-dependent: \\[\nRa(\\lambda) = \\frac{g\\alpha \\Delta T h^3}{\\kappa \\nu} \\cdot f(\\lambda/h)\n\\]\nEach wavelength has its own critical value. The global \\(Ra_c\\) is the minimum over all wavelengths. Typically, the most unstable mode has wavelength \\(\\lambda \\sim 2h\\) (aspect ratio ~ 1), which physical intuition: cells that are too wide or too narrow are less efficient at heat transport.\n\n\n\n\n\n\n\n\n\nTipSolution to Exercise 3: Thermal Boundary Layer\n\n\n\n\n\n(a) Boundary layer scaling:\nFrom boundary layer theory, heat balance gives: \\[\n\\delta \\sim h \\cdot Ra^{-1/3}\n\\]\nThis comes from balancing vertical advection with vertical diffusion in the thermal boundary layer.\n(b) Mantle calculation:\nWith \\(Ra = 10^7\\) and \\(h = 2900\\) km: \\[\n\\delta \\sim 2900 \\text{ km} \\times (10^7)^{-1/3} \\sim 2900/215 \\sim 13.5 \\text{ km}\n\\]\n(c) Comparison with D” layer:\nSeismic observations suggest the D” layer (thermal boundary layer at CMB) is $$100-300 km thick. Our estimate is much thinner, suggesting:\n\nThe D” layer may not be purely thermal (could include chemical layering)\nLocal Rayleigh number near CMB might be lower than whole-mantle value\nTime-dependent effects and plumes complicate the simple boundary layer picture\nThe scaling assumes steady state, but Earth’s convection is time-dependent\n\nThis discrepancy is an active research topic!",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>14</span>  <span class='chapter-title'>Thermal Convection</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/LithosphericDynamics.html",
    "href": "DraftMaterial/LithosphericDynamics.html",
    "title": "Dynamics of the Lithosphere",
    "section": "",
    "text": "Elastic flexure\nShear bands ?\nExamples from UW Geo etc",
    "crumbs": [
      "Introduction",
      "**Draft: Geodynamics**",
      "<span class='chapter-number'>15</span>  <span class='chapter-title'>Dynamics of the Lithosphere</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods1.html",
    "href": "DraftMaterial/NumericalMethods1.html",
    "title": "Numerical Modeling in Solid Earth Dynamics",
    "section": "",
    "text": "Introductory Remarks\n\\[\n\\newcommand{\\mathbf{d}\\boldsymbol{\\Gamma}}{\\mathbf{d}\\boldsymbol{\\Gamma}}\n\\newcommand{\\mathop{\\mathrm{erfc}}}{\\mbox{\\rm erfc}}\n\\newcommand{\\curly}{\\sf }\n\\newcommand{\\Red     }[1]{\\textcolor[rgb]{0.7,0.0,0.0}{ #1}}\n\\newcommand{\\Green   }[1]{\\textcolor[rgb]{0.0,0.7,0.0}{ #1}}\n\\newcommand{\\Blue    }[1]{\\textcolor[rgb]{0.0,0.0,0.7}{ #1}}\n\\newcommand{\\Emerald }[1]{\\textcolor[rgb]{0.0,0.7,0.3}{ #1}}\n\\]\nWe have considered the application of mathematical reasoning to construct models of the behaviour of physical systems. Unfortunately, most of these models do not have analytic solutions or the solutions are so complicated that they don’t help us understand the problem. The alternative is to solve such problems numerically (approximately). Such solutions are also possible for far more elaborate systems than we would even consider trying to obtain exact solutions for.\nOn the other hand, numerical modeling only provides solutions to mathematical equations and only approximate solutions at that. Unless the modeler has an understanding of the methods and the models themselves, then the output of some computer code may be terribly misleading.\nIt is always necessary to design a numerical experiment as carefully as one would a physical experiment — although it won’t blow up and kill you. It is possible to change the laws of physics in the numerical model often inadvertantly, so a careful analysis of the problem first is not a bad idea.\nThis part of the course contains some really hard material. This is deliberate because the workings of most computer codes are actually based on some astonishingly intricate mathematics. This is really intended to provide a decent reference for people coming back to use finite elements or other numerical methods later.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Numerical Modeling in Solid Earth Dynamics</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods1.html#numerical-modeling-primer",
    "href": "DraftMaterial/NumericalMethods1.html#numerical-modeling-primer",
    "title": "Numerical Modeling in Solid Earth Dynamics",
    "section": "Numerical modeling primer",
    "text": "Numerical modeling primer\nWe start with the numerical solution of a very simple differential equation. In fact we choose something simple enough that we already know the answer.\n\\[\n\\frac{d\\theta}{dt} = - k \\theta\n\\tag{16.1}\\]\nThis is the equation which governs radioactive decay, in which case \\(\\theta\\) is the amount of the radioactive isotope remaining and \\(d\\theta /  dt\\) is the activity that we can measure. \\(k\\) is closely related to the half life.\nThe solution to this equation is\n\\[\n\\theta(t) = \\theta_0 e^{-kt}\n\\]\nwhere \\(\\theta_0\\) is the amount of the radioactive material remaining. The same equation also describes the cooling of, say, a cup of coffee. In this case we interpret \\(\\theta\\) as the excess temperature (above room temperature).\n!\nWe want to march forward in time from our starting point where \\(\\theta = \\theta_0\\) to obtain the value of \\(\\theta\\) at later times. To do this, we need to approximate the original differential equation, and, in particular, the value of the time derivative at each time. There are a number of ways to do this.\n\nA first order numerical approximation}\nAssume that the variation in \\(\\theta(t)\\) is linear, i.e.\n\\[\n\\theta(t') = \\theta_n + \\beta t'\n\\]\nwhere we use a local time coordinate \\(t' = t - n\\Delta t\\), so that when we differentiate\n\\[\n\\frac{d \\theta}{dt} = \\beta\n\\]\nTo determine the approximation for the derivative therefore becomes the solution to the following equation:\n\\[\n\\begin{split}\n        & \\theta_{n+1} = \\theta_n + \\beta \\Delta t \\\\\n        & \\Rightarrow   \\beta = \\frac{d \\theta}{dt} = \\frac{\\theta_{n+1} - \\theta_n}{\\Delta t}\n    \\end{split}\n\\]\nThis is a first order difference expression for the derivative which we substitute into the original differential equation (Equation 16.1) at the current timestep\n\\[\n\\frac{\\theta_{n+1} - \\theta_n}{\\Delta t} = - k \\theta_n\n\\]\nThis rearranges to give us a time-marching algorithm:\n\\[\n\\theta_{n+1} = \\theta_n (1-k \\Delta t)\n\\]\nIt is an indication of the fact that this problem is really not all that difficult that this difference equation can be written recursively to give:\n\\[\n\\theta_{n+1} = \\theta_0 (1-k \\Delta t)^n\n\\]\nIn a moment we will compute some values for this expression to see how accurate it is. First we consider whether we can improve the accuracy of the approximation by doing a bit more work.\n\n\nHigher order expansion\nFirst we try fitting the local expansion for \\(\\theta\\) through an additional point. This time we assume that the variation in \\(\\theta(t)\\) is quadratic, i.e.\n\\[\n\\theta(t') = \\theta_{n-1} + \\beta t' + \\gamma {t'}^2\n\\]\nThe local time coordinate is \\(t' = t - (n-1)\\Delta t\\), and when we differentiate\n\\[\n\\frac{d \\theta}{dt} = \\beta + 2 \\gamma t'\n\\tag{16.2}\\]\nTo solve for \\(\\beta\\) and \\(\\gamma\\) we fit the curve through the sample points:\n\\[\n\\begin{split}\n    \\theta_n &= \\theta_{n-1} + \\beta \\Delta t + \\gamma (\\Delta t)^2 \\\\\n    \\theta_{n+1} &= \\theta_{n-1} + 2 \\beta \\Delta t + 4 \\gamma (\\Delta t)^2\n    \\end{split}\n\\]\nWhich we can solve to give this:\n\\[\n\\begin{split}\n            \\beta &= \\left( 4 \\theta_n - \\theta_{n+1} - 3\\theta_{n-1} \\right) \\frac{1}{2\\Delta t} \\\\\n            \\gamma &= \\left( \\theta_{n+1} + \\theta_{n-1} -2 \\theta_n \\right) \\frac{1}{2\\Delta t^2}\n    \\end{split}\n\\]\nBy substituting into \\( (Equation 16.2) \\), and then into the original differential equation \\( (Equation 16.1) \\) we obtain the following\n\\[\n\\left. \\frac{d\\theta}{dt} \\right|_{t=n\\Delta t} = \\beta + 2\\gamma \\Delta t =\n                \\frac{1}{2\\Delta t} \\left( \\theta_{n+1} - \\theta_{n-1} \\right)  = -k \\theta_n\n\\]\nThe difference approximation to the derivative turns out to be the average of the expressions for the previous derivative and the new derivative. We have now included information about the current timestep and the previous timestep in our expression for the value of \\(\\theta\\) at the forthcoming timestep: \\[\n\\theta_{n+1} = \\theta_{n-1} -2k \\theta_n \\Delta t\n\\]\n\n\nA comparison of the two schemes\nHow well do these two methods perform, and what difference does the choice of \\(\\Delta t\\) make on the accuracy ?\n\n\n\n\n\n\n\n\n\n\n\nt\n\\(^1\\theta_H\\)\n\\(^1\\theta_h\\)\n\\(^2\\theta_H\\)\n\\(^2\\theta_h\\)\nExact\n\n\n\n\n0.0\n1.0000\n1.0000\n1.0000\n1.0000\n1.0000\n\n\n0.1\n—\n0.9000\n—\n0.9000\n0.9048\n\n\n0.2\n0.8000\n0.8100\n0.8000\n0.8200\n0.8187\n\n\n0.3\n—\n0.7290\n—\n0.7360\n0.7408\n\n\n0.4\n0.6400\n0.6561\n0.6800\n0.6728\n0.6703\n\n\n0.5\n—\n0.5905\n—\n0.6014\n0.6063\n\n\n0.6\n0.5120\n0.5314\n0.5280\n0.5525\n0.5488\n\n\n0.7\n—\n0.4783\n—\n0.4909\n0.4966\n\n\n0.8\n0.4096\n0.4305\n0.4688\n0.4543\n0.4483\n\n\n0.9\n—\n0.3874\n—\n0.4001\n0.4066\n\n\n1.0\n0.3277\n0.3487\n0.3405\n0.3743\n0.3679\n\n\n\n\n\n\nResults of the numerical simulation of the decay equation. \\(^1\\theta_H\\) is from the first order expansion of \\(\\theta(t)\\), at a timestep of \\(\\Delta t=0.2\\), and \\(^2\\theta_H\\) is the second order expansion at \\(\\Delta t=0.2\\); other calculations are at \\(\\Delta t = 0.1\\). \\(^1\\theta_h\\) is the linear expansion, \\(^2\\theta_h\\) results from the quadratic expansion of \\(\\theta(t)\\). The actual solution is also shown.\n\n\nThe results are more accurate when a smaller timestep is used although it requires more computation to achieve the greater accuracy. Higher order expansion also increases the accuracy and may be more efficient in terms of the number of computations required for a given level of accuracy. Note, however, that the supposedly better quadratic expansion produces an error which oscillates as time increases. Does this error grow ? Does this make second order expansions useless ?\n\n\nSecond Order Runge-Kutta\n!\nThe Runge-Kutta approach to higher order integration methods is illustrated in the figure. The idea is to estimate the gradient \\(d \\theta / d t\\) at the half way point between two timestep values. This is done in two stages. Initially a first order estimate, \\(\\hat{\\theta}\\) is made for the value of the function \\(\\theta\\) at \\(t=t+\\Delta t /2\\) in the future. This value is then subsituted into the differential equation to obtain the estimate for the gradient at this time. The revised gradient is then used to update the original \\(\\theta(t)\\) by an entire timestep.\nThe first order step is \\[\n\\begin{split}\n        \\hat{\\theta}(t+\\Delta t /2) & = \\theta(t) + \\left.  \\frac{d \\theta}{d t} \\right|_t \\frac{\\Delta t}{2} \\\\\n            &= \\theta(t) \\left[ 1-\\frac{k\\Delta t}{2} \\right]\n    \\end{split}\n\\] Substitute to estimate the gradient at the mid-point \\[\n\\left. \\frac{d \\theta}{d t} \\right|_{t+\\Delta t /2} \\approx -k \\theta(t)  \\left[ 1-\\frac{k\\Delta t}{2} \\right]\n\\] Use this value as the average gradient over the interval \\(t\\rightarrow t+\\Delta t\\) to update \\(\\theta\\) \\[\n\\begin{split}\n        \\theta(t+\\Delta t) & \\approx \\theta(t) + \\delta t \\left(  -k \\theta(t)  \\left[ 1-\\frac{k\\Delta t}{2} \\right]  \\right) \\\\\n            & \\approx \\theta(t) \\left( 1 - k \\Delta t + k^2 \\frac{\\Delta t^2}{2} \\right)\n    \\end{split}\n\\] It’s worth noting that the Taylor expansion of the solution should look like \\[\ne^{-kt} = 1 - kt + \\frac{k^2 t^2}{2!} - \\frac{k^3 t^3}{3!} + \\ldots\n\\]\nThe Runge Kutta method can be extended by repeating the estimates on smaller regions of the interval. The usual choice is fourth order RK. This is largely because, obviously, it’s accurate to fourth order, but also because the number of operations to go higher than fourth order is disproportionately large. See Numerical Recipes for a discussion on this and better methods for ODE’s.\n\n\nOur First Code\nThe simplest way to answer our earlier question is to code the methods and see. The following is a script which computes the first and second order expressions and the Runge-Kutta method, and compares with the “exact” solution (which is numerical as well, of course, but computed through series expansions and the like).\n# Compare various ways to integrate the \n# ODE for radioactive decay / Newton's law of cooling.\n# Assume decay constant of 1.0\n\nimport math\n\ntimestep=0.1;\n\n# Initial value ... \n\ntheta1_0   = 1.0\ntheta2_0   = 1.0\nthetaRK2_0 = 1.0\n\n# First timestep (by hand, then automate for subsequent cases)\n\ntheta1_1   = 0.9\ntheta2_1   = 0.9\nthetaRK_1  = 0.905\n\n# Now we have enough information to automate all the methods \n\nfor i in range(2,1001):\n\n    time = timestep * i\n    exact = 1.0 * math.exp(-1.0 * time)\n\n    theta1_2  = theta1_1 * (1.0 - timestep)\n    theta2_2  = theta2_0 - 2.0 *  theta2_1 * timestep\n    thetaRK_2 = thetaRK_1 * (1.0 - timestep + 0.5 * timestep * timestep)\n\n  # output data every 25th step\n    if not (i % 25):\n        print \"Timestep {:04d} {:.4f}\\t {:.4e} \\t {:.4e} \\t {:.4e} \\t {:.4e}\".format(i,time,theta1_2,theta2_2,thetaRK_2,exact)\n                \n  # keep old values (not all are needed, of course)\n\n    theta1_0  = theta1_1\n    theta2_0  = theta2_1\n    thetaRK_0 = thetaRK_1\n\n    theta1_1  = theta1_2\n    theta2_1  = theta2_2\n    thetaRK_1 = thetaRK_2\n\n\"\"\" Output:\nTimestep 0025 2.5000     +7.1790e-02     +5.2117e-02     +8.2455e-02     +8.2085e-02\nTimestep 0050 5.0000     +5.1538e-03     +3.7201e-01     +6.7987e-03     +6.7379e-03\nTimestep 0075 7.5000     +3.6999e-04     -4.4304e+00     +5.6059e-04     +5.5308e-04\nTimestep 0100 10.0000    +2.6561e-05     +5.3757e+01     +4.6223e-05     +4.5400e-05\nTimestep 0125 12.5000    +1.9068e-06     -6.5219e+02     +3.8113e-06     +3.7267e-06\nTimestep 0150 15.0000    +1.3689e-07     +7.9124e+03     +3.1426e-07     +3.0590e-07\nTimestep 0175 17.5000    +9.8274e-09     -9.5993e+04     +2.5912e-08     +2.5110e-08\nTimestep 0200 20.0000    +7.0551e-10     +1.1646e+06     +2.1366e-09     +2.0612e-09\nTimestep 0225 22.5000    +5.0648e-11     -1.4129e+07     +1.7617e-10     +1.6919e-10\nTimestep 0250 25.0000    +3.6360e-12     +1.7141e+08     +1.4526e-11     +1.3888e-11\nTimestep 0275 27.5000    +2.6103e-13     -2.0796e+09     +1.1977e-12     +1.1400e-12\nTimestep 0300 30.0000    +1.8739e-14     +2.5230e+10     +9.8758e-14     +9.3576e-14\nTimestep 0325 32.5000    +1.3453e-15     -3.0609e+11     +8.1431e-15     +7.6812e-15\nTimestep 0350 35.0000    +9.6578e-17     +3.7135e+12     +6.7143e-16     +6.3051e-16\nTimestep 0375 37.5000    +6.9333e-18     -4.5052e+13     +5.5363e-17     +5.1756e-17\nTimestep 0400 40.0000    +4.9774e-19     +5.4658e+14     +4.5649e-18     +4.2484e-18\nTimestep 0425 42.5000    +3.5733e-20     -6.6311e+15     +3.7640e-19     +3.4873e-19\nTimestep 0450 45.0000    +2.5652e-21     +8.0449e+16     +3.1036e-20     +2.8625e-20\nTimestep 0475 47.5000    +1.8416e-22     -9.7602e+17     +2.5590e-21     +2.3497e-21\nTimestep 0500 50.0000    +1.3221e-23     +1.1841e+19     +2.1100e-22     +1.9287e-22\nTimestep 0525 52.5000    +9.4911e-25     -1.4366e+20     +1.7398e-23     +1.5832e-23\nTimestep 0550 55.0000    +6.8137e-26     +1.7429e+21     +1.4346e-24     +1.2996e-24\nTimestep 0575 57.5000    +4.8915e-27     -2.1144e+22     +1.1829e-25     +1.0668e-25\nTimestep 0600 60.0000    +3.5116e-28     +2.5653e+23     +9.7532e-27     +8.7565e-27\nTimestep 0625 62.5000    +2.5210e-29     -3.1122e+24     +8.0420e-28     +7.1878e-28\nTimestep 0650 65.0000    +1.8098e-30     +3.7757e+25     +6.6310e-29     +5.9001e-29\nTimestep 0675 67.5000    +1.2993e-31     -4.5807e+26     +5.4675e-30     +4.8431e-30\nTimestep 0700 70.0000    +9.3273e-33     +5.5574e+27     +4.5082e-31     +3.9754e-31\nTimestep 0725 72.5000    +6.6961e-34     -6.7423e+28     +3.7172e-32     +3.2632e-32\nTimestep 0750 75.0000    +4.8071e-35     +8.1797e+29     +3.0650e-33     +2.6786e-33\nTimestep 0775 77.5000    +3.4510e-36     -9.9237e+30     +2.5273e-34     +2.1988e-34\nTimestep 0800 80.0000    +2.4775e-37     +1.2040e+32     +2.0838e-35     +1.8049e-35\nTimestep 0825 82.5000    +1.7786e-38     -1.4606e+33     +1.7182e-36     +1.4815e-36\nTimestep 0850 85.0000    +1.2768e-39     +1.7721e+34     +1.4167e-37     +1.2161e-37\nTimestep 0875 87.5000    +9.1663e-41     -2.1499e+35     +1.1682e-38     +9.9824e-39\nTimestep 0900 90.0000    +6.5805e-42     +2.6082e+36     +9.6321e-40     +8.1940e-40\nTimestep 0925 92.5000    +4.7241e-43     -3.1643e+37     +7.9421e-41     +6.7261e-41\nTimestep 0950 95.0000    +3.3914e-44     +3.8390e+38     +6.5486e-42     +5.5211e-42\nTimestep 0975 97.5000    +2.4347e-45     -4.6575e+39     +5.3996e-43     +4.5320e-43\nTimestep 1000 100.0000   +1.7479e-46     +5.6505e+40     +4.4522e-44     +3.7201e-44\n\"\"\"\n \nClearly, the quadratic expansion does not do a good job in this particular case, since the error is a growing instability which makes the solution useless almost immediately. However, the second order Runge-Kutta method is very accurate. This gives a clear warning that numerical solution of equations is partly an art (though the stability or otherwise of a given method can actually be proven formally in many cases).",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>16</span>  <span class='chapter-title'>Numerical Modeling in Solid Earth Dynamics</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods2.html",
    "href": "DraftMaterial/NumericalMethods2.html",
    "title": "Survey of numerical methods",
    "section": "",
    "text": "Explicit versus implicit methods}\n\\[\n\\newcommand{\\mathbf{d}\\boldsymbol{\\Gamma}}{\\mathbf{d}\\boldsymbol{\\Gamma}}\n\\newcommand{\\mathop{\\mathrm{erfc}}}{\\mbox{\\rm erfc}}\n\\newcommand{\\curly}{\\sf }\n\\newcommand{\\Red     }[1]{\\textcolor[rgb]{0.7,0.0,0.0}{ #1}}\n\\newcommand{\\Green   }[1]{\\textcolor[rgb]{0.0,0.7,0.0}{ #1}}\n\\newcommand{\\Blue    }[1]{\\textcolor[rgb]{0.0,0.0,0.7}{ #1}}\n\\newcommand{\\Emerald }[1]{\\textcolor[rgb]{0.0,0.7,0.3}{ #1}}\n\\]\nThe use of implicit solution methods is crucial when we come to the mantle flow problem (and to elasticity). It is a deceptively simple concept which we use to eliminate oscillatory errors and other problems associated with stiff systems, and in other cases where we want to take large timesteps. Again, Numerical Recipes provides a good example of the way in which implicit methods avoid the shuffling timesteps which result when an otherwise unimportant component of the system blows up. To obtain an implicit solution, we express our updated timestep in terms of values of derivatives etc which are evaluated at that timestep. This may result in dependencies which mean large systems of simultaneous equations need to be solved.\nBut our simple example can also be solved implicitly as follows\n\\[\n\\theta(t+\\Delta t) = \\left. \\frac{d \\theta}{d t} \\right|_{t+\\Delta t} + \\theta(t)\n\\]\nEasy to write down, but \\(\\left. d \\theta/ dt \\right|_{t+\\Delta t}\\) is not known until \\(\\theta(t+\\Delta t)\\) is known. In this case, however, we simply substitute \\(\\left. d \\theta/ dt \\right|_{t+\\Delta t}= -k \\theta(t+\\Delta t)\\) from the differential equation and write\n\\[\n\\begin{split}\n        \\theta(t+\\Delta t)  & = -k \\theta(t+\\Delta t) \\Delta t + \\theta(t) \\\\\n                                        & = \\frac{\\theta(t) }{ 1 + k\\Delta t}\n    \\end{split}\n\\]\nA higher order implicit method can be found by considering how the second order Runge-Kutta method constructs its estimates. In place of the first order approximation above, we try\n\\[\n\\theta(t+\\Delta t) = \\left. \\frac{d \\theta}{d t} \\right|_{t+\\Delta t/2} + \\theta(t)\n\\]\nwhere we assume\n\\[\n\\left. \\frac{d \\theta}{d t} \\right|_{t+\\Delta t/2} =\n        \\frac{1}{2} \\left. \\frac{d \\theta}{d t} \\right|_{t+\\Delta t} +\n        \\frac{1}{2} \\left. \\frac{d \\theta}{d t} \\right|_{t}\n\\]\nSubstituting from our original differential equation now gives\n\\[\n\\begin{split}\n        \\theta(t+\\Delta t) &= -k\\frac{\\theta(t+\\Delta t) + \\theta(t)}{2} \\Delta t + \\theta(t) \\\\\n                    &= \\theta(t) \\frac{1-k\\Delta t / 2}{1+k\\Delta t / 2}\n    \\end{split}\n\\]\nThe first order scheme is of approximately the same accuracy as the explicit scheme, not surprisingly, but the mid-point implicit method has very impressive results considering that there is very little extra work involved in deriving the formulation. Can this strategy stabilize the quadratic expansion which proved to be so unstable in explicit form ?\nEvaluating the derivatives at time \\(t=(n+1)\\Delta t\\) gives\n\\[\n\\left. \\frac{d \\theta}{d t} \\right|_{(n+1)\\Delta t} = 3 \\theta_{n+1} - 4\\theta_n + \\theta_{n-1}\n\\]\nwhich we substitute into the differential equation at \\(t=(n+1)\\Delta t\\) to give (eventually)\n\\[\n\\theta_{n+1} = \\frac{4\\theta_n - \\theta_{n-1}}{3+2k\\Delta t}\n\\]\nThis method is stable although not as accurate as the second order Runge-Kutta Scheme. It is trivial to modify the Python script to demonstrate this.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Survey of numerical methods</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods2.html#explicit-versus-implicit-methods",
    "href": "DraftMaterial/NumericalMethods2.html#explicit-versus-implicit-methods",
    "title": "Survey of numerical methods",
    "section": "",
    "text": "t\n\\(^1\\theta_i\\)\n\\(^2\\theta_i\\)\nExact\n\n\n\n\n0.0\n1.0000\n1.0000\n1.0000\n\n\n0.1\n0.9091\n0.9048\n0.9048\n\n\n0.2\n0.8264\n0.8186\n0.8187\n\n\n0.3\n0.7513\n0.7406\n0.7408\n\n\n0.4\n0.6830\n0.6701\n0.6703\n\n\n0.5\n0.6209\n0.6063\n0.6063\n\n\n\n\n\n\nResults of the two implicit schemes derived above for the numerical integration of the decay equation",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Survey of numerical methods</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods2.html#generalizing-from-the-simplest-example",
    "href": "DraftMaterial/NumericalMethods2.html#generalizing-from-the-simplest-example",
    "title": "Survey of numerical methods",
    "section": "Generalizing from the Simplest Example",
    "text": "Generalizing from the Simplest Example\nWe have learned a number of things — in particular\n\nWe have to know something about the governing equations of the system before modeling can proceed (i.e. a conceptual model, and then a mathematical model).\nBefore the equations can be solved in the computer, it is necessary to render the problem finite.\nThe discretization method chosen may not be effective for a particular problem. Numerical modeling can be an art since experience with different differential equations is often needed to avoid pitfalls.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Survey of numerical methods</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods2.html#the-problem-with-advection",
    "href": "DraftMaterial/NumericalMethods2.html#the-problem-with-advection",
    "title": "Survey of numerical methods",
    "section": "The Problem with Advection",
    "text": "The Problem with Advection\nAdvection is a fundamental concept in fluid mechanics, get it makes the lives of fluid dynamicists much more difficult. It can be particularly problematic in numerical modeling. This is worth having in mind when we discuss different numerical methods because in application to solid Earth dynamics, advection will be a major issue with any method we choose.\n!\nAs we discussed previously in dealing with approximate analytic solutions, the solution to all our advection woes is to deal with a coordinate system locked to the fluid. Unfortunately, while this approach works well in some situations – predominantly solid mechanics and engineering applications where total deformation is generally no more than a few percent strain – in fluids, the local coordinate system becomes quite hard to track. In the figure above , a small, square region of fluid has been tagged and is followed during the deformation induced by a simple convection roll. It is clear that a coordinate system based on initially orthogonal sets of axes rapidly becomes unrecognizably distorted.\nAdvection, in the absence of any diffusion terms, represents a transport of information about the state of an individual parcel of fluid which is different from the state of its neighbours. For example, it might be a dye which tells us whether a parcel of fluid started in on half of the domain or the other. We are dealing with a chaotic system in the sense that parcels of material which start abitrarily close together will wind up exponentially far apart as time progresses. Thus, the dye will become ever more stretched and filamented without ever being mixed (at least in laminar flow).\nIf the dye can diffuse then, the finer scales of the tendrils will in fact be mixed because they are associated with enormous spatial gradients (e.g. compare this with boundary layers). If the dye cannot diffuse then the density of information needed to characterize the system increases without limit. Numerically this is impossible to represent since at some stage, the stored problem has to be kept finite. This can be imagined as an effective diffusion process, although it has an anisotropic and discretization dependent form. The rule of thumb, that arises from this observation is that the real diffusion coefficient must be larger than the numerical one if the method is to give a true representation of the problem.\n\nNumerical Example in 1D\n!\nLet us follow our usual strategy an solve the simplest imaginable advection equation:\n\\[\n\\frac{\\partial \\phi}{\\partial t} = -v \\frac{\\partial \\phi}{\\partial x}\n\\]\nin which \\(v\\) is a constant velocity. Obviously we need to introduce some notation as a warm-up for solving the problem. We break up the spatial domain into a series of points separated by \\(\\delta x\\) as shown and, as we did in the earlier examples, break up time into a discrete set separated by \\(\\delta t\\). The values of \\(\\phi\\) at various times and places are denoted by\n\\[\n\\begin{align}\n    &&  &_{i-1}\\phi_{n-1}   &&_{i}\\phi_{n-1}    && _{i+1}\\phi_{n-1} && \\nonumber \\\\\n    &&  &_{i-1}\\phi_{n}         &&_{i}\\phi_{n}      && _{i+1}\\phi_{n}  &&\\\\\n    &&  &_{i-1}\\phi_{n+1}   &&_{i}\\phi_{n+1}    && _{i+1}\\phi_{n+1} &&\\nonumber\n\\end{align}\n\\]\nwhere the \\(i\\) subscript is the \\(x\\) position and \\(n\\) denotes the timestep:\n\\[\n\\phi(x_i,n\\Delta t) = {_{i}\\phi}_n\n\\]\nA simple discretization gives\n\\[\n\\begin{split}\n    _{i}\\phi_{n+1} &= \\frac{\\partial \\phi}{\\partial t} \\Delta t + {_{i}\\phi_n} \\\\\n                & = -v \\frac{{_{i+1}\\phi_n} - {_{i-1}\\phi_n}}{2 \\delta x} + {_{i}\\phi_n}\n    \\end{split}\n\\]\nFor simplicity, we set \\(v\\delta t = \\delta x /2\\) and write\n\\[\n{_{i}\\phi}_{n+1} = \\frac{1}{4}\\left(  {_{i+1}\\phi}_n - {_{i-1}\\phi}_n \\right)\n\\]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nlocation\n\n\n\n\n\n\n\n\n\n\n\ntime\ni-2\ni-1\ni\ni+1\ni+2\ni+3\n\\(\\int \\phi dx\\)\n\n\nCentred\nt=0\n1\n1\n1\n0\n0\n0\n3\n\n\n\nt=\\(x/2v\\)\n1\n1\n1.25\n0.25\n0\n0\n3.5\n\n\n\nt=\\(x/v \\)\n1\n0.938\n1.438\n0.563\n0.0625\n0\n4.0\n\n\nUpwind\nt=0\n1\n1\n1\n0\n0\n0\n3\n\n\n\nt=\\(x/2v\\)\n1\n1\n1\n0.5\n0\n0\n3.5\n\n\n\nt=\\(x/v \\)\n1\n1\n1\n0.75\n0.25\n0\n4.0\n\n\n\n\n\n\nHand calculation of low order advection schemes\n\n\nWe compute the first few timesteps for a step function in \\(\\phi\\) initially on the location \\(x_i\\) as shown in the diagram. These are written out in the first section of the Table. There are some oddities immediately visible from the table entries. The step has a large overshoot to the left, and its influence gradually propogates in the upstream direction. However, it does preserve the integral value of \\(\\phi\\) on the domain (allowing for the fact that the step is advancing into the domain).\nThese effects can be minimized if we use “upwind differencing”. This involves replacing the advection term with a non-centred difference scheme instead of the symmetrical term that we used above.\n\\[\n\\begin{split}\n    _{i}\\phi_{n+1} &= \\frac{\\partial \\phi}{\\partial t} \\Delta t + {_{i}\\phi_n} \\\\\n                & = -v \\frac{{_{i}\\phi_n} - {_{i-1}\\phi_n}}{\\delta x} + {_{i}\\phi_n}\n    \\end{split}\n\\]\nWhere we now take a difference only in the upstream direction.\nThe results of this advection operator are clearly superior to the centred difference version. Now the step has no influence at all in the upstream direction, and the value does not overshoot the maximum. Again, the total quantity of \\(\\phi\\) is conserved.\nWhy does this apparently ad hoc modification make such an improvement to the solution ? We need to remember that the fluid is moving. In the time it takes to make the update at a particular spatial location, the material at that location is swept downstream. Consider where the effective location of the derivative is computed at the beginning of the timestep — by the end of the timestep the fluid has carried this point to the place where the update will occur. This has some similarity to the implicit methods used earlier to produce stable results.\n\n\nNode/Particle Advection\nContrary to the difficulty in advecting a continuum field, discrete particle paths can be integrated very easily. For example a Runge-Kutta integration scheme can be applied to advance the old positions to the new based on the known velocity field. It is only when the information needs to be recovered back to some regular grid points that the interpolation degradation of information becomes important.\n\nCourant condition\nFor stability, the maximum value of \\(\\delta t\\) should not exceed the time taken for material to travel a distance \\(\\delta x\\). This makes sense as the derivatives come from local information (between a point and its immediate neighbour) and information cannot propogate faster than \\(\\delta x / \\delta t\\). If the physical velocity exceeds the maximum information velocity, then the procedure must fail.\nThis is known as the Courant (or Courant-Friedrichs-Lewy) condition. In multidimensional applications it takes the form\n\\[\n\\delta t \\le \\frac{\\delta x}{\\sqrt{N} |v|}\n\\]\nwhere \\(N\\) is the number of dimensions, and a uniform spacing in all directions, \\(\\delta x\\) is presumed.\nThe exact details of such maximum timestep restrictions for explicit methods vary from problem to problem. It is, however, important to be aware that such restrictions exist so as to be able to search them out before trouble strikes.\nOne of the ugliest problems from advection appears when viscoelasticity is introduced. In this case we need to track a tensor quantity (stress-rate) without diffusion or other distorting effects. Obviously this is not easy, especially in a situation where very large deformations are being tracked elsewhere in the system — e.g. the lithosphere floating about on the mantle as it is being stressed and storing elastic stress.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Survey of numerical methods</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods2.html#a-variety-of-numerical-methods",
    "href": "DraftMaterial/NumericalMethods2.html#a-variety-of-numerical-methods",
    "title": "Survey of numerical methods",
    "section": "A Variety of Numerical Methods",
    "text": "A Variety of Numerical Methods\nWe now discuss a number of different numerical solution techniques which are suitable for solid Earth dynamics problems. Obviously only a brief discussion of any one method is possible, and more methods are inevitably available.\nAs we have already seen, some methods work well for particular problem and others roll over and die with hardly any sign of impending doom. We need to know what the tools in our toolbox are for and what will cause them to break before we try to solve serious problems with them. After all, in uncharted territory, a numerical instability might look enticingly like an exiting new result.\nObviously there is not room to do justice to any particular method — or (god forbid) make some other method seem better than finite elements (though for some things this is obviously true).\n\nFinite Differences\nWe are already familiar with finite differences. The examples we went through in the introductory material use the finite difference philosophy to represent derivatives by differences. We used only primitive versions of finite differences but the methodology is similar: a regular mesh-based discretization of time and space with differential equations being represented as difference equations.\nFinite Difference methods are simple and can be very fast. They can be intuitively easy to understand and program and are also universally applied. They may encounter difficulties when extreme variations in properties occur from one grid point to another.\n\n\nFinite Elements\nFinite elements work from a variational principle (more, much more, later) which is an integral version of the governing equations. They work with a spatial discretization into a mesh spanned by elements with unknowns allocated to their vertices.\nThe application of finite elements to complex problems and those with very complex domains is a programmers joy since the entire methodology match object - oriented programming techniques. The flip-side of this is that the construction of the numerical equations which need to be solved may take considerably longer than the actual solution process.\nThe retention of the integral form can be beneficial for problems with difficult boundary conditions or discontinuities which can be integrated. Variational methods are, however, difficult to constrain particularly when iterative, implicit solution methods are used.\n\n\nFinite Volumes\nIn finite volumes one combines some of the best features of finite elements and finite differences. The method is grid based and works with both the original mesh and its dual. The formulation starts with a weak form of the equations based on volume fluxes into the local volume surrounding a node (based on the dual mesh). These integrals are then converted via Gauss’ theorem, into surface integrals on the edges/faces of the dual mesh. Depending on the subsequent discretization, the resulting algorithm can be akin to finite differences or to finite elements (whether surface integrals remain in the formulation or are replaced by some differencing form) Advantages include the fact that the surface integral formulation can be tailored to satisfy local constraints without additional messing about thus making for very rapid solution times. The formulation can also deal with arbitrary mesh configurations. Disadvantages include a difficulty in applying some boundary conditions since the dual surface is not defined outside the mesh (formally).\n\n\nNatural Elements\nAn extension of finite elements using the theory of Natural Neighbour interpolation schemes to provide shape functions for all grid point arrangements. A best (Delaunay) triangulation is defined for such a set of points and interpolation functions exist which give an optimal representation of the interpolant. These functions can provide a basis for a finite element scheme. Advantages include the fact that elements can be highly distorted but this does not affect the convergence of the method in the same catastrophic way as for normal schemes. Disadvantages include the fact that shape functions overlap other elements and therefore precise integration is difficult. Also this is a relatively novel method and there are some odds and ends to be ironed out.\n\n\nSpectral (time/space)\nWe saw in the theoretical treatment of instabilities in a layer how beneficial it can be to deal with harmonic functions in one or more dimensions. This turns the problem from a partial differential equation into a set of ordinary differential equations for the different wavenumbers. The method works well for systems with homogeneous material properties otherwise spatial variations in these properties are couple the different wavenumbers together and add layer upon layer of complexity to the problem. Due to the existence of the fast fourier transform, these methods, when they can be applied, are potentially very quick. They are limited to relatively regular geometries, however.\n\n\nDiscrete Elements\nMeshless methods which deal with either actual discrete systems such as large systems of granular materials or systems in which notional particles represent elements of the continuum. The method works by treating simple interactions of very many particles dynamically. For each particle an explicit solution of \\(F=ma\\) for translations and \\(L=I\\ddot{\\theta}\\) for the rotations is found in reponse to the interaction forces with every other particle. In discrete elements such interactions are usually local (e.g. only when particles are in contact) and this makes the system manageable in size. Very good for treatment of fracture and dynamic responses of granular systems but can be hampered by the time taken for the fully explicit nature of the algorithm, i.e. elastic waves must be resolved in order to model deformation. Also, these methods are based on particle interaction functions and so properties of the continuum such as viscosity are not direct inputs but have to be computed as an average response of the system (just like the real thing). Compare this to molecular dynamics simulations.\n\n\nSmooth Particle Hydrodynamics\nAnother meshless method in which “particles” are the centres of smooth functions such as gaussians. These can be used to interpolate any field across the solution domain. They are also differentiable and can therefore represent differential equations relatively efficiently. Very useful for high velocity flows and astrophysics type problems. Historically there have been problems representing boundary conditions and viscosity so not ideal for the highly viscous and/or elastic type problems of the solid earth.\n\n\nParticle in Cell methods\nIn these methods both particles and a mesh exist. The mesh supplies the velocities which move particles around, but the particles carry information with them in a Lagrangian sense. Derivatives are computed on the mesh using the values of nodal variables but material property variations are measured by the particles. Advantages include the fact that the method is geometrically simple for relatively complex deformations and uses a horses-for-courses approach with the mesh doing what it is best at - derivatives, fast solutions and the particles doing their part on the Lagrangian components of the problem. Major disadvantages include the fact that the particle properties and the mesh properties must be synchronized and this may involve some averaging to the mesh. Worse, there need to be more particles than grid points for the algorithm to work, but this means there are more particle degrees of freedom than can be constrained by the mesh — this means that multiple particle configurations can produce the same solution on the mesh some of which may be unstable and incapable of being damped during the solution.\n\n\nLagrangian/Eulerian meshes\nAs we hinted earlier, Lagrangian formulations eliminate convective terms from the equations but at the expense of geometrical complexity. Finite elements are not particularly troubled by complex meshes provided the elements do not become too distorted. Thus, for moderate deformations, advection of the grid points provides a simple way to eliminate the much more complicated advection terms from the differential equations. For fluids, however, the deformation ultimately ruins the ability of the mesh to converge on the correct solution and the results have to be interpolated to a new mesh, losing some accuracy as a result.\n\nALE\nAn alternative to this approach is to use ALE which is, sad to say, an acronym for Arbitrary-Lagrangian-Eulerian. The node points are advected but not at the same rate as the flow. This can be used to prevent mesh tangling while still mitigating the worst difficulties associated with the advection term. But, on the other hand, it hasn’t entirely eliminated that term.\n\n\nDLR\nA different method is to start with an optimal, Delaunay, triangulation and allow the grid points to move locked into the fluid so as to eliminate the convection term from the differential equation. The mesh connections are checked at each timestep to see if the triangulation is still optimal. From near-optimal to optimal in this way involves exchanging a few node connections. This continual updating avoids ever being in a situation where full remeshing is required and thus avoids the loss of information during that process. Additional nodes can be introduced to improve resolution where required. The disadvantage of this procedure is in tracking history variables such as stress rate. These are only defined on the element interiors not the nodes, so the result is the tracking of a somewhat smoothed quantity. (brought to you by the Natural Element people)",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>17</span>  <span class='chapter-title'>Survey of numerical methods</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods3.html",
    "href": "DraftMaterial/NumericalMethods3.html",
    "title": "Introduction to the Finite Element Method",
    "section": "",
    "text": "Prelude to Finite Elements: The Variational Calculus\n\\[\n\\newcommand{\\mathbf{d}\\boldsymbol{\\Gamma}}{\\mathbf{d}\\boldsymbol{\\Gamma}}\n\\newcommand{\\mathop{\\mathrm{erfc}}}{\\mbox{\\rm erfc}}\n\\newcommand{\\curly}{\\sf }\n\\newcommand{\\Red     }[1]{\\textcolor[rgb]{0.7,0.0,0.0}{ #1}}\n\\newcommand{\\Green   }[1]{\\textcolor[rgb]{0.0,0.7,0.0}{ #1}}\n\\newcommand{\\Blue    }[1]{\\textcolor[rgb]{0.0,0.0,0.7}{ #1}}\n\\newcommand{\\Emerald }[1]{\\textcolor[rgb]{0.0,0.7,0.3}{ #1}}\n\\]\nThis is something of an aside but it is absolutely necessary to understand the variational method in order to follow how Finite Element Methods work",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Introduction to the Finite Element Method</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods3.html#prelude-to-finite-elements-the-variational-calculus",
    "href": "DraftMaterial/NumericalMethods3.html#prelude-to-finite-elements-the-variational-calculus",
    "title": "Introduction to the Finite Element Method",
    "section": "",
    "text": "Example: How Short is a Straight Line ?\nIt’s intuitively obvious that the shortest distance between two points on a plane is just a straight line. To demonstrate this mathematically is more tricky.\nIn words, the procedure goes like this: of all possible curves between the two points, find one (if it exists) which always becomes longer if it is altered in any way. (Thinking physically, if the points were linked by a rubber band, then to disturb it from the shortest curve would require additional energy, no matter what that disturbance looked like).\n\n!\nWe decide, arbitrarily, that we will make \\(x\\) the independent variable and find a curve \\(y(x)\\) which satisfies the minimum distance requirement.\nThe distance along a curve is a path integral:\n\\[\nS = \\int_{x_1}^{x_2} \\frac{ds}{dx} dx\n\\]\nwhere\n\\[\n\\frac{ds}{dx} = \\sqrt{1 + \\left( \\frac{dy}{dx} \\right)^2}\n\\]\nWe seek to find \\(y(x)\\) which minimizes \\(S\\). First consider the function\n\\[\n\\begin{split}\n    Y(x,\\alpha) &= y(x) + \\alpha \\eta(x) \\\\\n    \\frac{\\partial Y}{\\partial x} \\equiv Y' &= y'(x) + \\alpha \\eta'(x)\n    \\end{split}\n\\]\nwhere \\(\\eta(x)\\) is an arbitrary function which is differentiable and vanishes at \\(x=x_1,x_2\\). This is the variation which we apply to some curve \\(y(x)\\) to see if it gets shorter or longer. Note the notation for the derivative which will be useful as we procede. The optimal path will minimize \\(S(\\alpha)\\), when \\(\\alpha=0\\), i.e.\n\\[\n\\left. \\frac{\\partial S(\\alpha)}{\\partial \\alpha} \\right|_{\\alpha = 0} = 0\n\\]\nIn our current notation\n\\[\nS(\\alpha) = \\int_{x_1}^{x_2} \\sqrt{1 + (Y')^2}\n\\]\nand\n\\[\n\\frac{\\partial S(\\alpha)}{\\partial \\alpha} =\n         \\int_{x_1}^{x_2}  \\frac{1}{2} \\frac{1}{\\sqrt{1 + (Y')^2}} . 2 Y' \\frac{\\partial Y'}{\\partial \\alpha} dx\n\\]\nfrom the definition of \\(Y'(x,\\alpha)\\)\n\\[\n\\frac{\\partial Y'}{\\partial \\alpha} = \\eta'(x)\n\\]\nSo we now must solve\n\\[\n\\left. \\frac{\\partial S(\\alpha)}{\\partial \\alpha} \\right|_{\\alpha = 0} =\n        \\int_{x_1}^{x_2} \\frac{y'(x)\\eta'(x)}{\\sqrt{1 + (y')^2}} dx = 0\n\\]\nWe integrate by parts to give\n\\[\n\\left. \\frac{\\partial S(\\alpha)}{\\partial \\alpha} \\right|_{\\alpha = 0} =\n        \\left[   \\frac{y'(x)\\eta(x)}{\\sqrt{1 + (y')^2}} \\right]_{x_1}^{x_2} -\n        \\int_{x_1}^{x_2} \\eta{x} \\frac{d}{dx} \\frac{y'(x)}{\\sqrt{1 + (y')^2}} dx = 0\n\\]\nThe first term on the RHS vanishes because \\(\\eta\\) vanishes at the boundaries. The second term is valid for arbitrary \\(\\eta(x)\\) which implies\n\\[\n\\frac{d}{dx} \\frac{y'(x)}{\\sqrt{1 + (y')^2}} dx = 0\n\\]\nwhich in turn implies \\(y'=\\)constant, i.e. the equation of a straight line.\nThe important things to note here are that an integral method can be used to solve a simple geometrical problem and that the method itself includes the boundary conditions as a natural consequence of the way it is set up.\nThe variational method can be generalized to solve more important problems. In particular, instead of solving each problem as we have for the straight line / distance question above, we solve a generic problem whose solutions we can apply immediately.\n\n\nGeneralisation\nThe general form works like this. To find the function \\(y(x)\\) which produces a stationary value of the functional\n\\[\nJ=\\int_{x_1}^{x_2} F(x,y,y') dx\n\\]\nwe work through the same procedure as above, and use the same arguments concerning the arbitrary nature of the variation to obtain\n\\[\n\\frac{d}{dx}\\frac{\\partial F}{\\partial y'} - \\frac{\\partial F}{\\partial y} = 0\n\\]\nThis is known as the Euler equation. Hamilton’s principle states that mechanical systems evolve such that the integral\n\\[\nJ=\\int_{t_1}^{t_2} L dt\n\\]\nis stationary. Here \\(L\\) is the Lagrangian of the system which is identified with a combination of the work done on the system and the kinetic energy of the system, e.g. potential energy - kinetic energy.\nApplication of the Euler equation to each direction independently recovers Newton’s law (\\(F=ma\\)). In complex geometries and with difficult boundary conditions, the variational form may be easier to solve than the differential or “strong” form. This shows us that there are equivalent integral representations for the standard mechanical equations we are accustomed to using — variational or weak forms versus differential or strong forms.\nAlthough this may seem complicated and of rather theoretical interest, in fact it runs throughout finite element methods, and the concept must be familiar in order to follow how FEM works. Advantages of using variational forms of the equations include:\n\nThe simplification of the construction of the governing equations in the sense that scalar quantities — energies, potentials — are considered in place of forces, displacements etc. There is also the possibility that such formulations can be derived more-or-less automatically for previously unknown systems.\nGoverning equations may be more directly accessible since “unimportant” variables such as internal forces doing no net work do not appear in the variational form.\nWhen dealing with approximate solutions, the variational form often allows a broader range of trial functions than for the standard differential form. This happens because some boundary conditions are implicit in the formulation and hence are not imposed on the trial functions themselves.\n\n\n\nExample of Variational Forms for FEM\nSee Klaus-Jürgen Bathe’s book for a more complete outline of this approach to FEM. Although this is not the best text to explain how to implement a finite element code, he does a great job of explaining the link between variational methods and weak forms of various equations of progressively increasing complexity.\n\n!\nThe functional governing the temperature in the block of material is\n\\[\n\\Pi = \\int_0^L \\frac{1}{2} k \\left(\\frac{\\partial \\theta}{\\partial x} \\right)^2 dx -  \n                    \\int_0^L \\theta q^B dx - \\theta(0,t) Q\n\\]\nwhere \\(q^B\\) is an internal heat generation rate. The fixed boundary condition is \\(\\theta(L,t) =\\theta_i\\).\nThis is our generalized problem with\n\\[\nF = \\frac{1}{2}k  \\left(\\frac{\\partial \\theta}{\\partial x} \\right)^2 - \\theta q^B\n            = \\frac{1}{2}k {\\theta'}^2 - \\theta q^B\n\\]\nwhich produces a stationary functional if\n\\[\n\\frac{d}{dx}\\frac{\\partial F}{\\partial \\theta'} - \\frac{\\partial F}{\\partial \\theta} = 0\n\\]\nor, in other words\n\\[\nk\\frac{d^2 \\theta}{d x^2} = q^B\n\\]\nWhich we recognize to be the governing differential equation. The variational statement also contains the natural boundary condition\n\\[\nk \\left. \\frac{\\partial \\theta}{\\partial x}    \\right|_{x=0} + Q = 0\n\\]\nThis is a clear demonstration that the standard form of the equations plus certain boundary conditions can be fully wrapped up in integral form and are exactly equivalent to the standard form. The major difficulty is in how we produce the correct functional in the first place, especially if we want to avoid first deriving the differential form of the equations and back-calculating as we done above.\n\n\nExtension to Approximate Methods}\nThe problem above is simple enough that the integral or differential forms of the equations can be solved directly. In general, however, we anticipate dealing with problems where no closed form of solution exists. Under these circumstances approximate solutions are desirable. In particular, there is a class of approximation methods which use families of trial functions to obtain a best fit approximation to the solution. These naturally develop into finite element algorithms as we shall soon see.\n\n\nFormulation of a General Problem\nWe consider a steady-state problem characterized by the following strong form\n\\[\n{\\cal{L}} (\\phi) = f\n\\]\nwhere \\({\\cal{L}}\\) is a linear differential operator acting on the (unknown) state variable \\(\\phi\\) in responce to a forcing function \\(f\\). Boundary conditions are\n\\[\n{\\cal{B}}_i [\\phi] = \\left. q_i \\right|_{\\mbox{\\small at boundary } S_i}    \\;\\;\\; i=1,2,\\ldots\n\\]\nThe operator should be symmetric\n\\[\n\\int_\\Omega v {\\cal{L}}(u) d\\Omega =  \\int_\\Omega u {\\cal{L}}(v) d\\Omega\n\\]\nand positive definite\n\\[\n\\int_\\Omega u {\\cal{L}}(u) d\\Omega &gt; 0\n\\]\n\\(\\Omega\\) is the domain of the operator and \\(u\\) and \\(v\\) are any functions which satisfy the boundary conditions.\n!\nConsider the 1D example of a bar subject to a steady end load. The response is the solution to\n\\[\n-EA\\frac{\\partial^2 u}{\\partial x^2} = 0\n\\]\nsubject to the boundary conditions\n\\[\n\\begin{split}\n        \\left. u \\right|_{x=0} & = 0 \\\\\n        \\left. EA\\frac{\\partial u}{\\partial x} \\right|_{x=L} = R\n    \\end{split}\n\\]\nWe therefore identify\n\\[\n\\begin{eqnarray*}\n     {\\cal{L}}= -EA\\frac{\\partial^2 u}{\\partial x^2} & \\phi = u & f = 0 \\\\\n     & B_1 = 1 ; q_1 = 0 & \\\\\n     & B_2 =  EA\\frac{\\partial }{\\partial x}; q_2 = R &\n\\end{eqnarray*}\n\\]\nTo check symmetry and positive definiteness of the operator we consider \\(R=0\\) since the operator properties are independent of the actual load. Integrating by parts gives\n\\[\n\\begin{split}\n    \\int_0^L-EA\\frac{\\partial^2 u}{\\partial x^2} v dx & =   \n        - \\left. EA\\frac{\\partial u}{\\partial x} v \\right|_0^L + \\int_0^L EA \\frac{\\partial u}{\\partial x} \\frac{\\partial v}{\\partial x} dx \\\\\n         &= - \\left. EA\\frac{\\partial u}{\\partial x} v \\right|_0^L  - \\left. + EA u \\frac{\\partial v}{\\partial x}  \\right|_0^L\n         - \\int_0^L EA\\frac{\\partial^2 v}{\\partial x^2} u dx\n    \\end{split}\n\\]\nApplication of boundary conditions demonstrates that the operator is symmetric by our definition and it is positive definite as well because:\n\\[\n\\int_0^L-EA\\frac{\\partial^2 u}{\\partial x^2} u dx =     \n    - \\left. EA\\frac{\\partial u}{\\partial x} u \\right|_0^L + \\int_0^L EA \\frac{\\partial u}{\\partial x} \\frac{\\partial u}{\\partial x} dx         =\n    0 + \\int_0^L EA \\left(\\frac{\\partial u}{\\partial x}\\right)^2 dx\n\\]\nSuppose we now search for approximate solutions of the form\n\\[\n\\bar{\\phi} = \\sum_{i=1}^{n} a_i \\Phi_i\n\\] where \\(\\Phi_i\\) are linearly independent trial functions and the \\(a_i\\) are the unknown weights for each of the functions.\nIn weighted residuals methods, the expansion is used directly on the strong form of the equations. \\(\\Phi_i\\) are chosen so as to satisfy all boundary conditions and then we seek to minimize a residual\n\\[\nR = f - {\\cal{L}}( \\sum_{i=1}^{n} a_i \\Phi_i    )\n\\]\n\nLeast Squares Method\nMinimize the square of the residual with respect to \\(a_i\\)\n\\[\n\\frac{\\partial}{\\partial a_i} \\int_\\Omega R^2 d\\Omega = 0   \\;\\;\\; i = 1,2,\\ldots\n\\]\nThis method produces a symmetric coefficient matrix regardless of the properties of the operator.\n\n\nGalerkin Method\nTo determine \\(a_i\\), solve the n equation system \\[\n\\int_\\Omega N_i R d\\Omega = 0    \\;\\;\\; i = 1,2,\\ldots\n\\]\nover the solution domain \\(\\Omega\\). This method produces a symmetric, positive definite coefficient matrix if the operator is symmetric and positive definite.\n\n\nRitz Method\nThe Ritz method does not operate on the residual of the strong problem, but minimizes the weak form of the problem with respect to each of the unknown parameters \\(a_i\\) in the usual variational manner. The trial functions no longer need satisfy the natural boundary conditions of the problem as these are wrapped up in the variational form. (Again, see Bathe for discussion and examples).\nThe Galerkin method can be extended to include a term which minimizes the violation of natural boundary conditions, and thus permits the use of a wider range of trial functions\n\\[\n\\int_\\Omega N_i R d\\Omega  + \\int_\\Gamma N_i R_B d\\Gamma = 0     \\;\\;\\; i = 1,2,\\ldots\n\\tag{18.1}\\]\nHowever, it does not now necessarily produce a symmetric matrix even for a symmetric operator. However, if the equation (Equation 18.1 ) is integrated once by parts, it yields a symmetric form and also reduces the order of derivatives inside the integral. This means that the trial functions need be of lower order, and it makes the Galerkin formulation equivalent to the Ritz formulation.\nWeighted residual formulations have one advantage: they can be used whether or not there exists a functional corresponding to the particular problem. As a result is used this method is used extensively in constructing finite element methods.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Introduction to the Finite Element Method</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods3.html#towards-a-matrix-method",
    "href": "DraftMaterial/NumericalMethods3.html#towards-a-matrix-method",
    "title": "Introduction to the Finite Element Method",
    "section": "Towards a Matrix Method",
    "text": "Towards a Matrix Method\nOne of the dominant features of the Finite Element literature is that it is filled with matrix algebra. The fact that differential equations can be rendered into matrices seems at first to be mysterious. However, it results quite naturally from the discretization of the problem, and the parameterization of the discrete equations through a limited set of unknown parameters.\nThus, before getting deeply involved in the arcane lore of Finite Elements, We give one example of a genuinely discrete system and show how it generates a matrix problem quite naturally.\n!\nConsider the system illustrated in the figure (a) above — three freely rolling carts attached by springs. There are three loads applied \\(R_1,R_2,R_3\\), one to each cart, and we wish to determine the equilibrium displacements \\(U_1,U_2,U_3\\). We can illustrate graphically the equilibrium condition for one of the springs based on its internal degrees of freedom and effective external load. This equilibrium is:\n\\[\n\\begin{split}\n        k_2 (U_1 - U_2) &= {F_1}^{(2)} \\\\\n        k_2 (U_2 - U_1) &= {F_2}^{(2)}\n\\end{split}\n\\]\nor\n\\[\nk_2 \\left[  \\begin{array}{cc}  1 & -1 \\\\ -1 & 1 \\end{array} \\right]\n        \\left[      \\begin{array}{c} U_1 \\\\ U_2 \\end{array} \\right] =\n        \\left[      \\begin{array}{c} {F_1}^{(2)} \\\\ {F_2}^{(2)}\\end{array} \\right]\n\\]\nThis is essentially the same for all five spring elements except for \\(k_1\\) which is anchored at one end and so satisfies\n\\[\nk_1 U_1 = {F_1}^{(1)}\n\\]\nThe equilibrium relations for the system as a whole are\n\\[\n\\begin{split}\n    & {F_1}^{(1)} +             {F_1}^{(2)} +           {F_1}^{(3)} +           {F_1}^{(4)} = R_1 \\\\\n    & {F_2}^{(2)} +             {F_2}^{(3)} +           {F_2}^{(5)} = R_2 \\\\\n    & {F_3}^{(4)} +             {F_3}^{(5)} = R_3\n\\end{split}\n\\tag{18.2}\\]\nIf we now write all five equilibrium relations in terms of all available degrees of freedom we obtain a form like this\n\\[\nk_2 \\left[  \\begin{array}{ccc}  k_2 & -k_2 & 0  \\\\ -k_2 & k_2 & 0 \\\\ 0 & 0 & 0 \\end{array} \\right]\n        \\left[      \\begin{array}{c} U_1 \\\\ U_2 \\\\ U_3 \\end{array} \\right] =\n        \\left[      \\begin{array}{c} {F_1}^{(2)} \\\\ {F_2}^{(2)} \\\\ 0\\end{array} \\right]\n\\]\nwhich can also be written\n\\[\n\\mathbf{K}^{(2)}\\mathbf{U} = \\mathbf{F}^{(2)}\n\\]\nin each case.\nThus the global equilibrium requirement of Equation 18.2 become\n\\[\n\\mathbf{K}\\mathbf{U} = \\mathbf{R}\n\\]\nwhere\n\\[\n\\mathbf{K} = \\left[\n    \\begin{array}{ccc}\n        (k_1 + k_2 +k_3 + k_4) & -(k_2+k_3) & -k_4 \\\\\n        -(k_2+k_3) & (k_2 + k_3+k_4) & -k_5 \\\\\n        -k_4 & -k_5 & (k_4 + k_5)\n    \\end{array}\n    \\right]\n\\]\nNote, by the way, that $ $ is symmetric. An important observation is that\n\\[\n\\mathbf{K} = \\sum_{i=1}^{5} \\mathbf{K}^{(i)}\n\\]\nThe individual element stiffnesses can be summed to form a global stiffness matrix. A symmetric, positive definite matrix problem can be solved in numerous different ways, many of which are easy to look up in textbooks ! A very simple problem like this has captured much of what we need to do in arbitrarily complex finite element computations. The construction of local element equilbrium problems based on the interaction of each available degree of freedom with every other is followed by the assembly into a global problem by summing the contributions of the individual elements.\nNote that the formulation of the local equilibrium conditions are done in a symmetric manner (if we change this degree of freedom how does the balance change, and then what if we change this degree of freedom ?) rather than trying to simplify the system.\nThe degrees of freedom are related by elastic spring constants here. In our more abstract formulations we will replace spring constants by coefficients obtained from the variational method but the form is {}.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>18</span>  <span class='chapter-title'>Introduction to the Finite Element Method</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods4.html",
    "href": "DraftMaterial/NumericalMethods4.html",
    "title": "Practical Finite Elements",
    "section": "",
    "text": "Weak Forms of Real Equations\n\\[\n\\newcommand{\\mathbf{d}\\boldsymbol{\\Gamma}}{\\mathbf{d}\\boldsymbol{\\Gamma}}\n\\newcommand{\\mathop{\\mathrm{erfc}}}{\\mbox{\\rm erfc}}\n\\newcommand{\\curly}{\\sf }\n\\newcommand{\\Red     }[1]{\\textcolor[rgb]{0.7,0.0,0.0}{ #1}}\n\\newcommand{\\Green   }[1]{\\textcolor[rgb]{0.0,0.7,0.0}{ #1}}\n\\newcommand{\\Blue    }[1]{\\textcolor[rgb]{0.0,0.0,0.7}{ #1}}\n\\newcommand{\\Emerald }[1]{\\textcolor[rgb]{0.0,0.7,0.3}{ #1}}\n\\]\nAs we discovered earlier, the Galerkin form of weighted residual approximate method can be made equivalent to a full variational problem if integration by parts is employed in the correct manner. This then allows the development of fully automatic variational methods for arbitrary strong forms of the governing equations. From here on we follow the notation of Hughes (The Finite Element Method) which is reasonably clear.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Practical Finite Elements</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods4.html#weak-forms-of-real-equations",
    "href": "DraftMaterial/NumericalMethods4.html#weak-forms-of-real-equations",
    "title": "Practical Finite Elements",
    "section": "",
    "text": "1D Heat Conduction\nThe differential or strong form of the equation we have encountered a number of times is\n\\[\n\\begin{split}\n        \\frac{d^2 u}{d x^2} - {\\curly f} &= 0 \\;\\;\\; \\text{on} \\;\\;\\; \\Omega \\\\\n        u(1) & = {\\curly g} \\\\\n        -\\frac{d u}{d x} (0) &= {\\curly h}\n    \\end{split}\n\\]\nwhere the boundary conditions are supplied at either end of a domain of unit length.\nTo find the weak form of the equation we need to have a set of functions \\(\\curly S\\) to use for the trial functions which satisfy the boundary condition \\(\\curly g\\) on \\(u\\) at \\(x=1\\). We also need a set of weighting functions which are zero at \\(x=1\\) which we call \\(\\curly V\\). The weighting functions play the role of the variations.\nThe statement of the weak form of the problem (as distinct from its solution which will wait till later) is then to find \\(u \\in {\\curly S}\\) such that for all \\(w \\in {\\curly V}\\)\n\\[\n{\\int_0^1 \\frac{d w }{d x} \\frac{d u}{d x} dx - \\int_0^1 w f dx + w(0) h = 0}\n\\]\nThis looks a lot like the variational solutions we found before. How do we get to it ? The procedure is relatively general (except that in higher dimensions it becomes more time consuming). First assume we have found the solution to the strong form, \\(u\\). This must satisfy\n\\[\n0 = \\int_0^1 w( \\frac{d^2 u}{d x^2} - {\\curly f} )dx\n\\]\nby the definition of the problem, as long as \\(w\\) is well behaved, which is ensured by a sensible choice of weighting functions. This starts to look a lot like the Galerkin approach although we are not yet seeking an approximate solution. Now integrate by parts to give\n\\[\n0 = \\int_0^1 \\frac{d w }{d x} \\frac{d u}{d x} dx - \\int_0^1 w f dx - \\left[ w \\frac{d u}{d x} \\right]_0^1\n\\]\nthe boundary conditions on \\(du / dx\\) are substituted to give the weak form as above. We write the equation in terms of the symmetric operators:\n\\[\n\\begin{split}\n    a(w,u) & \\equiv     \\int_0^1 \\frac{d w }{d x} \\frac{d u}{d x} dx \\\\\n    (w,{\\curly f})  & \\equiv  \\int_0^1 w f dx\n    \\end{split}\n\\]\nto obtain an abstract form which can be used for all the finite element formulations we derive here\n\\[\na(w,u) = (w,{\\curly f})  + w(0){\\curly h}\n\\tag{19.1}\\]\nNote, that the partial differentiation step produces a symmetric operator from the non symmetric initial form. This approach also works in 2D as follows.\n\n\n2D Heat Conduction\nDefine a heat flux (vector), \\(\\mathbf{q}\\) related to temperature, \\(u\\) as follows\n\\[\nq_i = -K_{ij} \\frac{\\partial u}{\\partial x_j}\n\\]\nwhere \\(\\mathbf{K}\\) is the symmetric conductivity tensor. (This is the generalized version of Fourier’s law). A volumetric heating rate of \\(\\curly f\\) gives the following strong form\n\\[\n\\begin{split}\n        \\nabla q - {\\curly f} &= 0  \\;\\;\\; \\text{on} \\;\\;\\; \\Omega \\\\\n        u & = {\\curly g} \\;\\;\\; \\text{on} \\;\\;\\;  \\Gamma_{\\curly g} \\\\\n        -q_i n_i &= {\\curly h} \\;\\;\\; \\text{on} \\;\\;\\; \\Gamma_{\\curly h}\n    \\end{split}\n\\]\nwhere \\(\\Gamma_ {\\curly g}\\) and \\(\\Gamma_{\\curly h}\\) are the regions of the boundary with fixed temperatures and fixed fluxes respectively, \\(\\mathbf{n}\\) is the unit normal over \\(\\Gamma_{\\curly h}\\).\nThe corresponding weak form (found in the usual way) is\n\\[\n-\\int_\\Omega  \\frac{\\partial w}{\\partial x_j} q_i d\\Omega = \\int_\\Omega w {\\curly f} d\\Omega + \\int_{\\Gamma_{\\curly h}} w{\\curly h} d\\Gamma\n\\]\nThe symmetry of the operator is not obvious here until we substitute the constitutive law to obtain\n\\[\n\\int_\\Omega  \\frac{\\partial w}{\\partial x_j} q_i d\\Omega =\n     \\int_\\Omega  \\frac{\\partial w}{\\partial x_j} K_{ij} \\frac{\\partial u}{\\partial x_j} d\\Omega =\n     \\int_\\Omega  (\\nabla w)^T \\mathbf{K} (\\nabla u) d\\Omega\n\\]\n\n\n2D/3D Fluid Flow\nNow we finally come around to the problem we really need to solve. The strong form of the Stokes’ flow problem is identical to that of linear elasticity (which is what all the finite element textbooks deal with). The general constitutive law is\n\\[\n\\sigma_{ij} = c_{ijkl} \\epsilon_{kl}\n\\]\nwhich reduces to \\(\\sigma_{ij} = \\eta \\epsilon_{ij}\\) for homogeneous fluid. \\(\\epsilon_{ij}\\) is defined by\n\\[\n\\epsilon_{ij} = \\frac{\\partial u_i}{\\partial x_j} +  \\frac{\\partial u_j}{\\partial x_i}\n\\]\nwhere \\(\\mathbf{u}\\) now represents the fluid velocity.\nThe strong form of the equation is\n\\[\n\\begin{split}\n        \\frac{\\partial \\sigma_{ij}}{\\partial x_j} + {\\curly f}_i = 0  \\;\\;\\; \\text{on} \\;\\;\\;  \\Omega \\\\\n            u_i & = {\\curly g}_i \\;\\;\\; \\text{on} \\;\\;\\;  \\Gamma_{{\\curly g}_i} \\\\\n            \\sigma_{ij} n_i &= {\\curly h}_i \\;\\;\\; \\text{on} \\;\\;\\; \\Gamma_{{\\curly h}_i}\n\\end{split}\n\\]\nwith a corresponding weak form\n\\[\n\\int_\\Omega \\left(  \\frac{\\partial w_i}{\\partial x_j} +  \\frac{\\partial w_j}{\\partial x_i}  \\right) \\sigma_{ij} d \\Omega =\n        \\int_\\Omega w_i {\\curly f}_i d\\Omega +\n        \\sum_{d=1}^{n_{\\rm dim}} \\left[ \\int_{\\Gamma_{{\\curly h}_i}} w_i h_i d\\Gamma \\right]\n\\]\nWhich is symmetric in the trial functions and the unknown velocities since\n\\[\n\\int_\\Omega \\left(  \\frac{\\partial w_i}{\\partial x_j} +  \\frac{\\partial w_j}{\\partial x_i}  \\right) \\sigma_{ij} d \\Omega =\n    \\int_\\Omega \\left(  \\frac{\\partial w_i}{\\partial x_j} +  \\frac{\\partial w_j}{\\partial x_i}  \\right) c_{ijkl}\n        \\left(  \\frac{\\partial u_i}{\\partial x_j} +  \\frac{\\partial u_j}{\\partial x_i} \\right) d \\Omega\n\\]",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Practical Finite Elements</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods4.html#galerkin-approximate-weak-form",
    "href": "DraftMaterial/NumericalMethods4.html#galerkin-approximate-weak-form",
    "title": "Practical Finite Elements",
    "section": "Galerkin Approximate Weak Form",
    "text": "Galerkin Approximate Weak Form\nWe have one last task before we can develop a real numerical method. How do we get away from the highly abstract notion of trial functions, weighting functions, and weak forms to produce a compact system of equations which can be written out in a nice tidy matrix form. The answer lies in the Galerkin approximate solution method. Let us go back to the 1D problem for a moment. We have to express our solution in terms of a sum over basis functions as before\n\\[\nw^h = \\sum_{A=1}^{n} c_A  N_A\n\\] where the \\(h\\) superscript indicates that we have moved from an infinite choice of functions to a finite one based on the discrete functions \\(N_A\\) which we will define in a minute, although for now we need to ensure that they are zero where the boundary conditions apply in the same way as \\(\\curly V\\). We define a corresponding expansion for \\(u\\)\n\\[\n\\begin{split}\n        u^h &= \\sum_{A=1}^{n} d_A  N_A + {\\curly g}N_{n+1} \\\\\n        {\\curly g}^h &= {\\curly g} N_{n+1}\n    \\end{split}\n\\]\nwhich includes an extra basis function to allow the boundary condition (\\(u(1)={\\curly g}\\)) to be satisfied.\nSubstituting into (Equation 19.1) gives\n\\[\na\\left( \\sum_{A=1}^n c_A N_A , \\sum_{B=1}^n d_B N_B \\right) =\n    \\left( \\sum_{A=1}^n c_A N_A , {\\curly f} \\right) + \\left[ \\sum_{A=1}^n c_A N_A(0) \\right] {\\curly h}\n    -a\\left( \\sum_{A=1}^n c_A N_A , {\\curly g} N_{n+1} \\right)\n\\]\nOur operators are symmetric and wholly linear, so the order of summation and application of the operator can be interchanged freely to give: \\[\n0 =     \\sum_{A=1}^n c_A G_A\n\\]\nwhere\n\\[\nG_A = \\sum_{B=1}^n a(N_A,N_B)d_B - (N_A,{\\curly f}) - N_A(0){\\curly h} + a(N_A,A_{n+1}){\\curly g}\n\\]\nAs we have done many times before, we appeal to the argument that the particular choice of variation must be totally arbitrary: this equation must hold no matter what \\(w^h \\in {\\curly S}^h\\) we choose, and hence no matter what the combination of \\(c_A\\) may be. This then means that \\(G_A\\) must be identically zero independent of \\(c_A\\), i.e.\n\\[\n\\sum_{B=1}^n a(N_A,N_B)d_B =  (N_A,{\\curly f} )\n     - N_A(0){\\curly h} +\n      a(N_A,A_{n+1}) {\\curly g}\n\\tag{19.2}\\]\nAs in the standard variational method, we have eliminated all references to the actual variation and left unknowns which only related to the physical variables (i.e. the coefficients of the expansion for \\(u\\)).\nIf we simply write \\[\n\\begin{split}\n        K_{AB} &= a(N_A,N_B)\\\\\n        F_A &= (N_A,{\\curly f}) + N_A(0)h - a(N_A,N_n+1){\\curly g}\n    \\end{split}\n\\tag{19.3}\\]\nthen we have a matrix formulation immediately since (Equation 19.2) now becomes\n\\[\n\\sum_{B=1}^n  K_{AB} d_B = F_A  \\;\\;\\;\\;\\;\\; A=1,2,3,\\ldots\n\\]\nor\n\\[\n\\mathbf{K d} = \\mathbf{F}\n\\]\nThe matrix \\(\\mathbf{K}\\) is known as the stiffness matrix — the association with the matrix of stiffnesses from our discrete set of springs being obvious.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Practical Finite Elements</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods4.html#generalization",
    "href": "DraftMaterial/NumericalMethods4.html#generalization",
    "title": "Practical Finite Elements",
    "section": "Generalization",
    "text": "Generalization\nThe same argument can be applied to higher dimensions, and to problems with different constitutive laws, and vector unknowns, however, the identification of the components of the stiffness matrix with the operator \\(a(\\cdot,\\cdot)\\) acting on every possible combination of the galerkin basis functions still holds. When the unknowns are vectors, the basis functions are used in each respective direction which complicates the notation even more than before. Essentially, though it means that the entries to \\(\\mathbf{K}\\) from each \\(A\\) and \\(B\\) are actually matrices which are \\(n_{\\rm dim} \\times n_{\\rm dim}\\).\nFor example, in the constant viscosity Stokes’ flow problem, we now have\n\\[\n\\left. K_{AB}\\right|_{ij}  =    \\int_\\Omega\n                    \\left(  \\frac{\\partial N_A}{\\partial x_j} +  \\frac{\\partial N_A}{\\partial x_i}  \\right) \\eta\n                    \\left(  \\frac{\\partial N_B}{\\partial x_j} +  \\frac{\\partial N_B}{\\partial x_i} \\right) d \\Omega\n\\tag{19.4}\\]",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Practical Finite Elements</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods4.html#discretization-shape-functions",
    "href": "DraftMaterial/NumericalMethods4.html#discretization-shape-functions",
    "title": "Practical Finite Elements",
    "section": "Discretization & Shape Functions",
    "text": "Discretization & Shape Functions\nAlthough we have now nominally made our problem finite by expressing everything in terms of Galerkin basis functions, we have yet to decide what those functions ought to be. Whatever our choice, it should make the problem easy to compute numerically.\n!\nThe choice of basis functions is very broad but we narrow it down by tying it very closely to the way we choose to split up the domain of our problem. With an integral method, the domain decomposition is simple since\n\\[\n\\int_\\Omega d\\Omega = \\int_{\\Omega_1} d {\\Omega_1} +\n            \\int_{\\Omega_2} d {\\Omega_2} + \\int_{\\Omega_3} d {\\Omega_3} + \\ldots\n\\tag{19.5}\\]\nwhich means that the decomposition shown above is as accurate as the representation of the boundary allows.\nThe functions which interpolate the node points at the corners of subdomains are a suitable set for use as an approximate basis as we require for the Galerkin formulation. This is easy to see if we consider a one dimensional problem.\n!\nIn the one dimensional case, the choice of subdomains is limited to breaking up the line into a number of segments, though not necessarily of equal length. If the approximation to the continuum field, \\(u\\) is made by linear interpolation to give \\(u^h\\), then \\(u^h\\) can also be expressed as a sum on the local triangular functions \\(N_A\\)\n\\[\nu^h = \\sum_{A} u(x_A) N_A(x)\n\\]\nThis is an exact representation of the interpolation provided the \\(N_A\\) takes the value one at node \\(A\\) and zero at all other nodes, and varies in a linear manner in between.\nNote that the functions all take the same form apart from scaling. Also, because the basis functions are localized around a node and its neighbours, the direct interaction between a node and its immediate neighbours is non-zero but the interaction with more distant nodes is zero. This makes the stiffness matrix banded — more importantly it is sparse and therefore the potentially enormous number of interactions (the square of the number of unknowns) is contained. This procedure can be extended to higher dimensions and to higher order interpolations as shown in \n\nNaming of Things and What They are Like}\nThe interpolation functions are known as shape functions. The subdomains are known as elements. The elements correspond to the individual springs of our discrete example. The shape functions are pure interpolation functions of the required order within the element and can be differentiated the appropriate number of times. This means that the order of interpolation must match the order of derivatives in the FE operator. Crossing the element boundaries, the shape functions have discontinuous derivatives (as do the piecewise interpolations). Continuous derivative functions are possible (e.g. splines) but add significant complexity. Shape functions in 2D and 3D can be formed from the product of 1D shape functions in each direction.\n!\n\n\nElement Matrices\nThe domain decomposition illustrated above produces a minature version of the matrix problem on the individual elements themselves.\n\\[\n{k^e}_{ij} {d^e}_j = {f^e}_i\n\\]\nThe interpretation of the local problem is similar to that of the individual springs in the discrete example we derived earlier. By assembling the individual under-constrained element problems into the full problem we obtain a soluble system with the correct number of boundary conditions etc. The local equilibrium problem is identical with that of the global problem. That is, we use the same variational form and the same operators to build the local matrices. In general, finite element methods are designed around the local element frame of reference and large problems assembled from smaller ones. The book-keeping involved is to track which degrees of freedom in the local problem are associated with which others in the global problem. Clearly the interaction coefficient between one degree of freedom and another is derived from the local equilibrium relationships of a number of elements because the shape function for a given nodal point is spread across a number of elements.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Practical Finite Elements</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods4.html#numerical-integration",
    "href": "DraftMaterial/NumericalMethods4.html#numerical-integration",
    "title": "Practical Finite Elements",
    "section": "Numerical Integration",
    "text": "Numerical Integration\nThe real power of finite elements comes from its ability to handle remarkably distorted geometries with ease. (Obviously this only applies in two or more dimensions). This is possible because simple mappings can be derived to convert a distorted element into a regular one (square, cubic, regular-tetrahedral). This takes the form of a change of variables which can be done {} if we make minor restrictions on the choice of distortions we allow the elements to have. This restriction takes the form of ensuring that the mappings which transform the element shape can be described by the shape functions of the element. This means that only linear mappings can be applied to linear elements. If we wish to map a curved boundary exactly, then elements which have the appropriate order shape functions have to be used even if they are not needed for the representation of the differential operator. (e.g. quadratic elements for a circular boundary). This concept produces “isoparametric” elements.\nThe mapping shown in  is achieved by a change of variables\n\\[\n\\int  \\int_{\\Omega^e} \\phi dx dy = \\int  \\int_{\\rm square} \\phi {\\curly j} d \\xi d \\eta\n\\]\nwhere \\({\\curly j}\\) is the jacobian of the transformation defined by\n\\[\n{\\curly j} = {\\rm det} \\frac{\\partial \\mathbf{x}}{\\partial \\boldsymbol{\\xi}} =\n            {\\rm det} \\left[ \\begin{array}{cc}  \n                \\frac{\\partial x_1}{\\partial \\xi_1} &  \\frac{\\partial x_1}{\\partial \\xi_2} \\\\\n                \\frac{\\partial x_2}{\\partial \\xi_1} &  \\frac{\\partial x_2}{\\partial \\xi_2}\n                \\end{array}    \\right]\n\\]\nIn the isoparametric concept, the components of the jacobian can be written as, for example,\n\\[\n\\frac{\\partial x_1}{\\partial \\xi_1} (\\xi_1,\\xi_2) =\n        \\sum_{a=1}^{n_en} \\frac{\\partial N_a}{\\partial \\xi_1} {x_1}_a\n\\]\nNow we have the integral of a number of things defined over a regular, square domain (or cube etc). A number of ways to estimate these integrals is available. For example, in 1D the familiar trapezium rule can integrate linearly interpolated functions exactly. Given that our approximate method has already reduced the degree of polynomial within the element to something manageable, it is possible to find integration schemes which produce the {} integral for our approximation — in other words introducing no further error.\nOne possibility which is commonly used is Gaussian quadrature. This is a textbook method which can be made exact for any order of interpolation function desired. For linear interpolation in 2D, the following rule applies (assuming that we have transformed to a square element)\n\\[\n\\int_{-1}^{1} \\!\\! \\int_{-1}^{1} \\phi(\\xi,\\eta) d\\xi d\\eta  \\ \\ \\ \\cong \\ \\ \\\n    \\sum_{l=1}^{n_{\\rm int}} \\phi( \\tilde{ \\xi_l}, \\tilde{ \\eta_l}) W_l\n\\]\nIn which \\(n_{\\rm int}\\) is the number of points in the quadrature rule with co-ordinates \\((\\tilde{ \\xi_l}, \\tilde{ \\eta_l})\\). Each point has a weight associated with it of \\(W_l\\). For the four point rule:\n\n\n\n\\(l\\)\n\\(\\tilde{\\xi_l}\\)\n\\(\\tilde{\\eta_l}\\)\n\\(W_l\\)\n\n\n\n\n1\n\\(-1/\\sqrt{3}\\) & \\(-1/\\sqrt{3}\\)\n1\n\n\n\n2\n\\(1/\\sqrt{3}\\) & \\(-1/\\sqrt{3}\\)\n1\n\n\n\n3\n\\(-1/\\sqrt{3}\\) & \\(1/\\sqrt{3}\\)\n1\n\n\n\n4\n\\(1/\\sqrt{3}\\) & \\(1/\\sqrt{3}\\)\n1\n\n\n\n\nThe four-point rule in two dimensions is constructed by applying a two point, one dimensional rule to each of the coordinates in turn. The integrals along the edges of the elements which are required to construct the boundary force vectors are therefore should be calculated using the one dimensional, two point rule which, along an edge of the bi-unit master element is\n\n\n\n\\(l\\)\n\\(\\tilde{\\xi_l}\\)\n\\(W_l\\)\n\n\n\n\n1\n\\(-1/\\sqrt{3}\\)\n1\n\n\n2\n\\(1/\\sqrt{3}\\)\n1\n\n\n\nThis naturally extends to three dimensional elements and their two dimensional boundaries.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Practical Finite Elements</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods4.html#standard-form-for-everything",
    "href": "DraftMaterial/NumericalMethods4.html#standard-form-for-everything",
    "title": "Practical Finite Elements",
    "section": "Standard Form for Everything",
    "text": "Standard Form for Everything\nConsider the heat 1D conduction problem one more time. We can rewrite the generalized Fourier law as\n\\[\nq_i = - \\kappa_{ij} \\frac{\\partial u}{\\partial x_j} =\n    -\\kappa_{ij} \\left( \\begin{array}{c} \\frac{\\partial}{\\partial x_1} \\\\ \\frac{\\partial }{\\partial x_2} \\end{array} \\right) u\n\\]\nIf we express \\(u\\) in terms of the shape functions\n\\[\nu = \\sum_A d_A N_A (x)  \\rightarrow\n    q_i = -\\kappa_{ij} \\sum_A \\left( \\begin{array}{c} {\\displaystyle \\frac{\\partial N_A}{\\partial x_1}} \\\\\n    { \\displaystyle \\frac{\\partial N_A}{\\partial x_2}} \\end{array} \\right) d_A\n    q_i = - \\sum_A \\kappa_{ij} \\left. B_A \\right|_{j} d_A\n\\]\nThis allows us to define a matrix \\(\\mathbf{B_A}\\) which comes directly from the operators contained in the constitutive law.\nCompare this with equation ( Equation 19.3) and, the more concrete example (Equation 19.4) and we see that the stiffness matrix coefficients can be obtained from\n\\[\nK_{AB} = a(N_A,N_B) = \\int_{\\Omega} \\mathbf{B}_A^T \\mathbf{D} \\mathbf{B}_B d\\Omega\n\\]\nwhere \\(\\mathbf{D}\\) is a matrix of material properties. This form can be used for all problems and may greatly simplify both programming and the automation of the development of the equations since now we simply need to be able to express the constitutive law in terms of the unknowns, build a material property matrix and plug this into standard machinery.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Practical Finite Elements</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods4.html#constraints",
    "href": "DraftMaterial/NumericalMethods4.html#constraints",
    "title": "Practical Finite Elements",
    "section": "Constraints",
    "text": "Constraints\nWe generally want to solve problems where there is a constraint on the unknowns. For example we wish to find a flow solution which also satisfies mass conservation (not unreasonable !). To see how this constraint may be applied we go back to the variational method and regard the equation \\({\\bf Kd = f}\\) in the light of the functional\n\\[\n{\\cal F} ({\\bf d}) = \\frac{{\\bf d}^T{\\bf Kd}}{2} - {\\bf d}^T {\\bf f}\n\\]\nThe vector which minimizes \\({\\cal F} ({\\bf d})\\) is the solution to \\({\\bf Kd = f}\\) — this can be shown in the usual way. (Start with $ {F}({}) $, where \\(\\varepsilon\\) is a free, real parameter and \\(\\bf c\\) is arbitrary).\nConsider a single constraint,\n\\[\nd_Q = {\\curly g}\n\\]\nwhich corresponds to specifying a value for one of the velocities in the problem having the index \\(Q\\) in the global numbering system. This constraint should be written as a function of \\(\\bf d\\) in the following way:\n\\[\n0 = {\\cal G}({\\bf d}) = {\\bf 1}_Q^T{\\bf d} - {\\curly g}\n\\]\n\\[\n\\begin{eqnarray*}\n{\\bf 1}^T_Q = \\left\\langle 0 \\ldots 0  \\right. & 1 & \\left. 0 \\ldots 0 \\right\\rangle \\\\\n& \\uparrow & \\! \\\\  \n& \\text{  Q'th column} & \\nonumber\n\\end{eqnarray*}\n\\]\nThen finding the stationary value for the following function is equivalent to solving the constrained problem:\n\\[\n{\\cal H}({\\bf d},m) = {\\cal F}({\\bf d}) + m{\\cal G}({\\bf d})\n\\]\nThe condition that \\(\\bf d\\) renders \\(\\cal H\\) stationary is\n\\[\n0 = \\left. \\frac{d}{d\\varepsilon} {\\cal H}({\\bf d}+\\varepsilon{\\bf c},m + \\varepsilon l) \\right|_{\\varepsilon=0}\n\\;\\;\\; \\forall {\\bf c},l\n\\]\nSubstituting for \\(\\cal H\\) gives:\n\\[\n0 = \\left. \\frac{d}{d\\varepsilon} \\left[ {\\cal F}({\\bf d}+\\varepsilon{\\bf c} )+\n     (m+\\varepsilon l){\\cal G}({\\bf d}+\\varepsilon{\\bf c} )\\right] \\right|_{\\varepsilon=0}\n\\]\n\\[\n0= {\\bf c}^T({\\bf Kd -F) }+l {\\cal G}({\\bf d}) + m{\\bf 1}_Q^T {\\bf c}\n\\]\n\\[\n0= {\\bf c}^T({\\bf Kd} + m{\\bf 1}_Q {\\bf -f}) + l ({\\bf 1}_Q^T {\\bf d} -\\mbox{\\curly g})\n\\]\nSince \\(\\bf c\\) and \\(l\\) are strictly arbitrary,\n\\[\n\\begin{eqnarray}\n{\\bf Kd }+m{\\bf 1}_Q &=& {\\bf f}\\\\ \\nonumber\n{\\bf 1}_Q^T {\\bf d} & = & {\\curly g} \\nonumber\n\\end{eqnarray}\n\\]\nEquivalently\n\\[\n\\left[ \\begin{array}{cc} {\\bf K} & {\\bf 1}_Q \\\\\n            {\\bf 1}_Q^T & 0 \\end{array} \\right]\n\\left\\{ \\begin{array}{c} {\\bf d} \\\\ \\nonumber\n             m \\end{array} \\right\\} =\n\\left\\{\\begin{array}{c} {\\bf f} \\\\ \\nonumber\n             {\\curly g} \\end{array} \\right\\}\n\\]\nwhich establishes the pattern expected for adding constraints to the physical problem: augmentation of all the matrices with some forces (\\(\\bf m\\)) as well as velocities (\\(\\bf d\\)) unknown. The coefficient matrix remains symmetric but is no longer positive definite.\nAn alternative way to enforce constraints and one which proves slightly simpler to implement, is to make an approximation to the Lagrange-multiplier as follows:\n\\[\nm \\cong k {\\cal G}({\\bf d})\n\\]\nin which \\(k\\) is a large positive number. Form the following functional,\n\\[\n{\\cal J}({\\bf d}) = {\\cal F}({\\bf d}) + \\frac{k}{2} \\left[{\\cal G} ({\\bf d})\\right]^2\n\\]\nand consider the extremal values for \\(\\cal J\\) which are defined by the following expression\n\\[\n0 = \\left. \\frac{d}{d\\varepsilon} \\left( {\\cal F}({\\bf d}+\\varepsilon {\\bf c} )+\n    \\frac{k}{2} \\left[ {\\cal G} ({\\bf d} + \\varepsilon{\\bf c}) \\right]^2 \\right) \\right| _{\\varepsilon = 0}\n\\]\n\\[\n{\\bf c}^T({\\bf Kd - f}) + k {\\bf G}({\\bf d}) {\\bf 1}_Q^T {\\bf c}\n\\]\nSubstituting for \\(\\cal G\\) gives\n\\[\n{\\bf c}^T \\left[ ({\\bf K} + k{\\bf 1}_Q{\\bf 1}_Q^T){\\bf d} - ({\\bf f} + k {\\curly g} {\\bf 1}_Q) \\right] = 0\n\\]\nSince \\(\\bf c\\) is arbitrary, the following matrix equation is implied\n\\[\n({\\bf K} + k{\\bf 1}_Q{\\bf 1}_Q^T){\\bf d} = ({\\bf f} + k {\\curly g} {\\bf 1}_Q)\n\\]\nNow the dimension of the problem is not changed; the constraints are introduced by addition of another matrix equation. In the limit \\(k \\rightarrow \\infty\\), \\(d_Q \\rightarrow {\\curly g}\\) and the constraint is applied exactly. The constraint of incompressibility is applied as the limiting case of slight compressibility. The large constant is known as the penalty parameter and gives its name to the method; its value is chosen according to the accuracy of the machine used to compute the solution to the problem. A suitable value is somewhere between \\(10^7\\) and \\(10^9\\), any smaller and the fluid volume may not be conserved during hydrostatic loading.\nThe penalty method is computationally very simple, but can be ill conditioned. This becomes a serious issue when the matrix equation is not solved by direct methods. In the latter case, it is preferable to introduce additional variables. These take the form of pressures which, in the slightly compressible flow case can always be eliminated in favour of the constraint, and then recovered as\n\\[\np = - \\lambda \\nabla . {\\bf u}\n\\]\nThe augmented matrix equation then becomes\n\\[\n\\left( \\begin{array}{cc} \\mathbf{K} & \\mathbf{G} \\\\ \\mathbf{G}^T &  0 \\end{array} \\right)\n\\left( \\begin{array}{c} \\mathbf{u} \\\\  \\mathbf{p} \\end{array} \\right)=\n\\left( \\begin{array}{c} \\mathbf{f} \\\\  \\mathbf{0} \\end{array} \\right)\n\\]\nThe components of the \\(\\mathbf{G}\\) matrix are, at the element level found from\n\\[\n\\left.  g^e_{a\\tilde{a}}  \\right|_{i} = -\\int_{\\Omega^e} {\\rm div}(N_a) (\\tilde{N})_{\\tilde{a}} d\\Omega\n\\]\nThe tilde indicates a pressure degree of freedom / shape function as constrasted with the standard velocity shape fucntions. The independent pressures require their own space of trial functions which can be of lower order than the velocity since the derivatives in the equations are also lower. In fact, it is necessary to use lower order functions for the pressure otherwise the problem is overconstrained and no non-trivial solution can be found. This is more of a difficulty when the penalty formulation is used since there are no additional variables and hence no associated trial functions. Instead a trick is used — the constraint terms are integrated using an order lower integration scheme than that required for exact solutions. The result turns out to be equivalent (usually) to the introduction of additional variables and lower order shape functions but the proof of this is another tricky matter.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Practical Finite Elements</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods4.html#stresses",
    "href": "DraftMaterial/NumericalMethods4.html#stresses",
    "title": "Practical Finite Elements",
    "section": "Stresses",
    "text": "Stresses\nNote Derivatives of the shape functions are commonly not defined at the node points and consequently it is not possible to compute stresses etc at the nodal points. They are defined on the interiors of the elements and must be extrapolated to the nodes using some form of best fit procedure.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>19</span>  <span class='chapter-title'>Practical Finite Elements</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods5.html",
    "href": "DraftMaterial/NumericalMethods5.html",
    "title": "Methods for Solving Numerical Problems",
    "section": "",
    "text": "Solving the matrix problem\n\\[\n\\newcommand{\\mathbf{d}\\boldsymbol{\\Gamma}}{\\mathbf{d}\\boldsymbol{\\Gamma}}\n\\newcommand{\\mathop{\\mathrm{erfc}}}{\\mbox{\\rm erfc}}\n\\newcommand{\\curly}{\\sf }\n\\newcommand{\\Red     }[1]{\\textcolor[rgb]{0.7,0.0,0.0}{ #1}}\n\\newcommand{\\Green   }[1]{\\textcolor[rgb]{0.0,0.7,0.0}{ #1}}\n\\newcommand{\\Blue    }[1]{\\textcolor[rgb]{0.0,0.0,0.7}{ #1}}\n\\newcommand{\\Emerald }[1]{\\textcolor[rgb]{0.0,0.7,0.3}{ #1}}\n\\]\nOnce the problem has been rendered into a matrix form, the finite element part is over ! The rest is matrix algebra. There are a number of standard techniques for solving such systems which we briefly outline in the context of the Earth dynamics problem. In most dynamic systems, the FEM can be formulated in a time-explicit manner (cf discrete element methods) that is robust and simple to implement, or using implicit methods which are more elaborate and are often more temperamental but which are capable of covering much larger time increments at each step. In our case, however, the fact that inertia is negligible, leaves the equation of motion independent of time and it can only be solved implicitly.\nThe original implicit solver in FEM was to build the matrix equation and solve it directly using an method such as Crout elimination. This can be done relatively efficiently by exploiting the fact that the finite element matrices are quite tightly banded. Unfortunately, direct solution methods are limited to “small” problems since the solution-time scales very rapidly with the number of unknowns (in the worst case, as \\(N^3\\) where \\(N\\) is the number of unknowns, and even in the best case as \\(N^2\\)).\nIterative methods can achieve much better performance than this once the problems start to become larger. For example, preconditioned conjugate gradient methods can obtain a solution to a given accuracy in a time proportional to \\(N\\log N\\). However, preconditioning can be highly time consuming and may need careful tailoring for different problems as the iterations may not converge (compare this to our need to carefully choose how to discretise problems in our finite difference examples earlier)\nThe optimal method, in theory, for the Stokes problem is multigrid which, when properly formulated, can find a solution in a time proportional to \\(N\\).\nAn additional problem arises with direct methods. The number of unknowns in the vector \\(\\mathbf{d}\\) is slightly less than \\(n_{\\rm dim}\\) times the number of nodal points once the prescribed boundary velocities have been included. For a well-resolved problem the stiffness matrix \\(\\mathbf{K}\\) is often too large to be stored in full, even accounting for its sparsity. Some iterative methods can operate with only the element stiffness matrices which can be built and used on the fly. Although this requires significantly more computations, it can make some large problems soluble where otherwise memory limitations would block solution. It is also possible that computation can be more efficient than retrieving carefully-packed matrix coefficents and, in this case, element-by-element methods can be competitive for speed in their own right.\nSome simple iterative schemes {} are described next. Far more that this exist and many are more efficient but this usually depends on the actual application area.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Methods for Solving Numerical Problems</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods5.html#solving-the-matrix-problem",
    "href": "DraftMaterial/NumericalMethods5.html#solving-the-matrix-problem",
    "title": "Methods for Solving Numerical Problems",
    "section": "",
    "text": "Jacobi relaxation\nOne of the simplest iterative methods of residual reduction is the Jacobi iteration. Given an approximate solution, \\(\\mathbf{d}^{(0)}\\), to \\(\\mathbf{Kd}=\\mathbf{f}\\), an improved solution, $ ^{(1)}$ is found by\n\\[\nd_i^{(1)} = \\left( f_i - \\sum^{n}_{j=1;j\\not=i} k_{ij}d_j^{(0)} \\right) / k_{ii}\n\\]\nIt is clear that each iteration cycle requires only one matrix-vector multiplication. However, the convergence rate for this algorithm is usually poor and a large number of cycles is required.\n\n\nGauss-Seidel relaxation\nA trivial modification to the Jacobi iteration is to use updated information on the \\(\\mathbf{d}\\) componenents immediately they become available. This results in the Gauss-Seidel iteration which is considerably more efficient than Jacobi. It can, however, be harder to code efficiently because the independence of each degree of freedom during one iteration disappears.\n\n\nConjugate Gradients\nA more sophisticated iterative procedure for obtaining solutions to linear systems is the conjugate gradient method. This is a development of the method of steepest descent with better convergence properties. The `search directions’ along which the solution is improved are denoted by \\(\\mathbf{s}\\) and do not coincide with the residual vectors. In the following algorithm an inner product is denoted by \\((\\cdot,\\cdot)\\).\ngvebhegpxvwx Conjugate Gradient Algorithm   1.  $\\quad$ $k=0; \\mathbf{u}_0 = {\\bf 0}; \\mathbf{r}_0 = \\mathbf{f}$     2.  $\\quad$ while $(\\mathbf{r}_k \\not= {\\bf 0})$    3.  $\\quad$ $\\quad$ $k = k + 1$    4.  $\\quad$ $\\quad$  if $(k=1)$     5.  $\\quad$ $\\quad$  $\\quad$ $\\mathbf{s}_1 = \\mathbf{r}_0$    6.  $\\quad$ $\\quad$  else     7.  $\\quad$ $\\quad$  $\\quad$   $\\beta = (\\mathbf{r}_{k-1},\\mathbf{r}_{k-1})/(\\mathbf{r}_{k-2},\\mathbf{r}_{k-2})$    8.  $\\quad$ $\\quad$  $\\quad$   $\\mathbf{s}_k = \\mathbf{r}_{k-1} + \\beta \\mathbf{s}_{k-1}$    9.  $\\quad$ $\\quad$  end   10. $\\quad$ $\\quad$  $\\alpha = (\\mathbf{r}_{k},\\mathbf{r}_{k})/(\\mathbf{s}_{k},{\\bf A s}_{k})$    11. $\\quad$ $\\quad$  $\\mathbf{u}_k = \\mathbf{u}_{k-1} + \\alpha \\mathbf{s}_{k}$    12. $\\quad$ $\\quad$  $\\mathbf{r}_k = \\mathbf{r}_{k-1} - \\alpha {\\bf As}_{k}$    13. $\\quad$ end    14. $\\quad$ $\\mathbf{u} = \\mathbf{u}_k$\nIn this case the use of residual vectors from previous iteration steps is necessary to ensure that there is only one matrix-vector multiplication. The convergence of the conjugate gradient algorithm is fastest when \\(\\mathbf{K}\\) is close to the identity matrix. For a general matrix the reduction of the residual may be slow through the first few iterations then picks up speed as the procedure progresses. This property makes this iterative loop inefficient for relatively small numbers of iterations.\nNote that the reduction of the residual is a measure of “improvement” of the solution which is internal to the iteration. Although the magnitude of the residual is usually reduced monotonically, the true error, when it can be calculated, may increase as well as decrease. In order to improve the rate of convergence it is necessary to reformulate the problem such that the solution to a nearly diagonal system is sought. This procedure is known as preconditioning. The system \\(\\mathbf{Kd} = \\mathbf{f}\\) is transformed to a case which can be solved more rapidly by the conjugate gradient algorithm:\n\\[\n\\tilde{\\mathbf{K}}\\tilde{\\mathbf{u}} = \\tilde{\\mathbf{f}}\n\\]\nwhere\n\\[\n\\begin{align*}\n      \\tilde{\\mathbf{K}} &= {\\bf C}^{-1}\\mathbf{K} {\\bf C}^{-1}\\\\\n      \\tilde{\\mathbf{u}} &= {\\bf Cu}   \\\\\n      \\tilde{\\mathbf{f}} &= {\\bf C}^{-1} {\\bf b}\n    \\end{align*}\n\\]\nThe preconditioning matrix \\(\\bf M\\) is defined by \\({\\bf M} = {\\bf C}^2\\), and the preconditioned conjugate gradient algorithm is then:\ngvebhegpxvwx Preconditioned Conjugate Gradient Algorithm   1.  $\\quad$  $ k = 0; \\mathbf{u}_0 = {\\bf 0}; \\mathbf{r}_0 = \\mathbf{f}$     2.  $\\quad$  while $(\\mathbf{r}_k \\not= {\\bf 0})$     3.  $\\quad$  $\\quad$   _solve_ ${\\bf M z}_k = \\mathbf{r}_k$    4.  $\\quad$  $\\quad$   $ k = k + 1 $    5.  $\\quad$  $\\quad$   if $(k=1)$     6.  $\\quad$  $\\quad$   $\\quad$  $\\mathbf{s}_1 = {\\bf z}_0$    7.  $\\quad$  $\\quad$   else   8.  $\\quad$  $\\quad$   $\\quad$  $\\beta = (\\mathbf{r}_{k-1},{\\bf z}_{k-1})/(\\mathbf{r}_{k-2},{\\bf z}_{k-2})$    9.  $\\quad$  $\\quad$   $\\quad$   $\\mathbf{s}_k = {\\bf z}_{k-1} + \\beta \\mathbf{s}_{k-1}$    10. $\\quad$  $\\quad$   end   11. $\\quad$  $\\quad$   $\\alpha = (\\mathbf{r}_{k},{\\bf z}_{k})/(\\mathbf{s}_{k},{\\bf A s}_{k})$    12. $\\quad$  $\\quad$   $\\mathbf{d}_k = \\mathbf{d}_{k-1} + \\alpha \\mathbf{s}_{k}$    13. $\\quad$  $\\quad$   $\\mathbf{r}_k = \\mathbf{r}_{k-1} - \\alpha \\mathbf{Ks}_{k}$    14. $\\quad$  end    15. $\\quad$  $\\mathbf{d} = \\mathbf{d}\\mathbf{d}_k$\nThe choice of \\(\\bf M\\) has a dramatic effect on the rate of convergence of the method. Not only must the preconditioner improve the convergence properties of the system, but the solution to \\({\\bf Mz} = \\mathbf{r}\\) must be inexpensive. Clearly if \\({\\bf M} = \\mathbf{K}\\) then exact convergence is obtained in one iteration but the solution of the preconditioning step becomes impossible. The simplest preconditioner, and the one employed here, is to set \\({\\bf M} = \\mathrm{diag}(\\mathbf{K})\\). This is not only simple to calculate (and invert) but requires very little storage. For simple systems the reduction of the residual is noticeably improved during the initial iterations. However, it is not clear how well this simple preconditioner will work when strong viscosity contrasts are present and off-diagonal terms in \\(\\mathbf{K}\\) may be large.\n\n\nMultigrid\n!\nThe multigrid method works by formulating the finite element problem on a number of different scales - usually a set of grids which are nested one within the other sharing common nodes. The solution progresses on all of the grids at the same time with each grid eliminating errors at a different scale. The effect is to propogate information very rapidly between different nodes in the grid which would otherwise be prevented by the local support of the element shape functions. In fact, by a single traverse from fine to coarse grid and back, all nodes in the mesh can be directly connected to every other – allowing nodes which are physically coupled but remote in the mesh to communicate directly during each iteration cycle.\nThe multigrid effect relies upon using an iterative solver on each of the grid resolutions which acts like a smoother on the residual error at the characteristic scale of that particular grid. People commonly use Gauss-Seidel iteration because it has exactly this property. On the coarsest grid it is possible to use a direct solver because the number of elements is usually very small.\nFor an elliptic operator such as the Laplacian of the Stokes’ problem encountered in the algorithm above the discretized problem is now written\n\\[\n{\\bf K}_h {\\bf d}_h = {\\bf f}_h\n\\]\nwhere the \\(h\\) subscript indicates that the problem has been discretized to a mesh of fineness \\(h\\). As before an initial estimate of the velocity can be improved by determining the solution to\n\\[\n{\\bf K}_h \\delta {\\bf d}_h = {\\bf r}_h\n\\] where \\({\\bf r}_h\\) is the residual on this mesh, and \\(\\delta {\\bf d}\\) is a correction to \\(\\bf d\\) which reduces \\(\\bf r\\). In the iterative methods described above, the initial approximation and the correction are found by solving a simplified version of the problem at the same gridpoints in such a way that computation time is reduced dramatically. However, another approach to the problem is to obtain an approximate solution by solving the problem on a more coarse grid. The reduction of the number of degrees of freedom also leads to a more manageable problem which can be solved fast. The correction term is therefore:\n\\[\n{\\bf K}_H \\delta{\\bf d}_H = {\\bf r}_H\n\\]\nwhere \\(H\\) indicates a coarser level of discretization. The residual on the coarser mesh is determined by the use of a projection (restriction) operator:\n\\[\n{\\bf r}_H = {\\bf P}_H^h {\\bf r}_h\n\\]\nand the approximate solution is then interpolated from the coarse to fine grid using an interpolation operator:\n\\[\n\\delta{\\bf d}_h = {\\bf I}_H^h \\delta{\\bf d}_H\n\\]\nThe power of the algorithm is in a recursive application. The coarse grid correction is also calculated through the use of a still-coarser grid and so on, until the problem is so small that an exact solution can be obtained very rapidly. One very simple, but instructive, algorithm for hierarchical residual reduction is the sawtooth cycle (the same logical layout as the multigrid V cycle).\ngvebhegpxvwx Multigrid Algorithm   1.  $\\quad$   Obtain approximate solution, ${\\bf d}_h$ at highest level $h$    2.  $\\quad$   Calculate residual: ${\\bf r}_h = {\\bf f}_h - {\\bf K}_h {\\bf d}_h$    3.  $\\quad$   Project residual by N levels to level $h-N$    4.  $\\quad$   $\\quad$  ${\\bf r}_{h-i} = {\\bf  P}_{h-i}^{h-i+1} {\\bf r}_{h-i+1}$    5.  $\\quad$   Solve exactly: $\\delta {\\bf u}_{h-N} = {\\bf A}_{h-N} {\\bf r}_{h-N}$    6.  $\\quad$   Interpolation steps:    7.  $\\quad$   $\\quad$  ${\\bf r}_{h-i+1} += {\\bf I}_{h-i}^{h-i+1} {\\bf K}_{h-i} \\delta {\\bf d}_{h-i}$     8.  $\\quad$   $\\quad$  Improve $\\delta {\\bf d}_{h-i+1}$     9.  $\\quad$   ${\\bf d}_h += \\delta {\\bf d}_h$\nThe step in which the velocity correction is “improved” is an iterative method for reducing the residual at the current level such as those described above. Although many methods of residual reduction are available, the class of methods which often work best with the multigrid approach are relaxation iterations which are also effective {} operators. At each level the smoothing operators reduce the residual most strongly on the scale of the discretization – the hierarchical nesting of different mesh sizes allows the residual to be reduced at each scale very efficiently. (see Parsons and Hall). The Jacobi relaxation above is a suitable algorithm for multigrid enhancement but still converges too slowly to build into an efficient code. Preconditioned conjugate gradient methods can better reduce the residual for the same number of operations but may not possess the smoothing properties which benefit the multigrid approach. The local inverse method appears to have both the smoothing and rapid convergence properties for the Stokes’ problem which are required for effective multigridding.\nThe projection and interpolation operators have to be chosen fairly carefully to avoid poor approximations to the problem at the coarse levels and ineffectual corrections propogated to the fine levels. The interpolation operator is defined naturally from the shape functions at the coarse levels. The projection operator is then defined to complement this choice (the operators should be adjoint).\nThe sawtooth cycle given in this section is the simplest multigrid algorithm. Developments include improving the residual at each level of the {}, known as a v-cycle, and cycles in which the residual is interpolated only part way through the hierarchy before being reprojected and subjected to another set of improvements (a w-cycle).\nThe Full Multigrid Algorithm (see Brandt) introduces a further level of complexity. Instead of simply casting the problem at a single level and projecting/improving the residual on a number of grids, the whole problem is defined for all the grids. In this way the initial fine-grid approximation is obtained by interpolating from the solution to the coarsest grid problem. The solution at each level is still obtained by projecting to the finest level and reducing the residual at each projection step. The result is some sort of “Loch Ness Monster” cycle.\nOne of the major problems in multigrid is knowing how best to represent material properties at different levels of grid coarseness in order to obtain the optimal convergence rate. This has a simple solution in the particle in cell finite element methods which we will discuss later.",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Methods for Solving Numerical Problems</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods5.html#a-practical-mixed-formulation",
    "href": "DraftMaterial/NumericalMethods5.html#a-practical-mixed-formulation",
    "title": "Methods for Solving Numerical Problems",
    "section": "A Practical Mixed Formulation",
    "text": "A Practical Mixed Formulation\nThe fact that the mixed method does not provide a positive definite matrix is a potentially serious difficulty. It can be avoided by the following rearrangement which forms the Schur complement of the original system.Multiplying out the mixed method equations gives the conservation equations for momentum and mass\n\\[\n{\\bf Kd} + {\\bf G}^T{\\bf p} = {\\bf f}\n\\tag{20.1}\\]\n\\[\n{\\bf Gd} = {\\bf 0}\n\\]\nMultiply equation \\( (Equation 20.1) \\) throughout by \\({\\bf G}{\\bf K}^{-1}\\) to give\n\\[\n{\\bf Gd} + {\\bf G K}^{-1}{\\bf G}^T {\\bf p} = {\\bf G K}^{-1}{\\bf  f}\n\\]\nwhere the first term is zero due to the incompressibility condition. Then the equation system is in the form \\(\\hat{\\bf K}{\\bf p} = \\hat{\\bf f}\\), where \\(\\hat{\\bf K}\\) is now positive definite, and so a conjugate gradient method can be used:\ngvebhegpxvwx Conjugate Gradient, Schur Complement    1.  $\\quad$ $\\Red{ k = 0; {\\bf p}_0 = {\\bf 0}; {\\bf r}_0 = \\hat{\\bf f}}$      2.  $\\quad$ while $({\\bf r}_k \\not= {\\bf 0})$      3.  $\\quad$ $\\quad$  $ k = k + 1 $     4.  $\\quad$ $\\quad$  if $(k=1)$      5.  $\\quad$ $\\quad$  $\\quad$ ${\\bf s}_1 = {\\bf r}_0$     6.  $\\quad$ $\\quad$  else      7.  $\\quad$ $\\quad$  $\\quad$  $\\beta = ({\\bf r}_{k-1},{\\bf r}_{k-1})/({\\bf r}_{k-2},{\\bf r}_{k-2})$     8.  $\\quad$ $\\quad$  $\\quad$  ${\\bf s}_k = {\\bf r}_{k-1} + \\beta {\\bf s}_{k-1}$     9.  $\\quad$ $\\quad$  end    10. $\\quad$ $\\quad$  $\\Red{{\\bf w} = \\hat{\\bf K} {\\bf s}}$      11. $\\quad$ $\\quad$  $\\alpha = ({\\bf r}_{k},{\\bf r}_{k})/({\\bf s}_{k},{\\bf w})$     12. $\\quad$ $\\quad$  ${\\bf p}_k = {\\bf p}_{k-1} + \\alpha {\\bf s}_{k}$     13. $\\quad$ $\\quad$  ${\\bf r}_k = {\\bf r}_{k-1} - \\alpha {\\bf w}$     14. $\\quad$ end    15. $\\quad$ ${\\bf d} = {\\bf d}_k$\nHowever, it is not possible to obtain \\(\\hat{\\bf K}\\) or \\(\\hat{\\bf f}\\) directly because the form of \\({\\bf K}^{-1}\\) is not known. This means we are stuck on steps 1 and 10 in this algorithm. Luckily, we can still take these steps because we are only interested in the effect of the operation of the matrix on a given vector. The modification of the algorithm looks like this:\ngvebhegpxvwx Conjugate Gradient Algorithm (No Matrix Construction)    1.   $\\quad$ $\\Green{{\\bf r}_0 = {\\bf G K}^{-1} {\\bf f}}$:     1.   $\\quad$ $\\Green{\\mathrm{solve:} \\;\\; {\\bf K d} = {\\bf f} \\;\\; \\mathrm{for} \\;\\; \\bf d}$    1.   $\\quad$ $\\Green{\\mathrm{set:} \\;\\; {\\bf r}_0 = {\\bf G d} = {\\bf G K}^{-1} {\\bf f}}$    2.   $\\quad$ while $({\\bf r}_k \\not= {\\bf 0})$      3.   $\\quad$ $\\quad$  $ k = k + 1 $     4.   $\\quad$ $\\quad$  if $(k=1)$      5.   $\\quad$ $\\quad$  $\\quad$ ${\\bf s}_1 = {\\bf r}_0$     6.   $\\quad$ $\\quad$  else      7.   $\\quad$ $\\quad$  $\\quad$  $\\beta = ({\\bf r}_{k-1},{\\bf r}_{k-1})/({\\bf r}_{k-2},{\\bf r}_{k-2})$     8.   $\\quad$ $\\quad$  $\\quad$  ${\\bf s}_k = {\\bf r}_{k-1} + \\beta {\\bf s}_{k-1}$     9.   $\\quad$ $\\quad$  end    10.  $\\quad$ $\\quad$  $\\Green{{\\bf w} = \\hat{\\bf G K}^{-1}{\\bf G}^T {\\bf s}}$:    10.  $\\quad$ $\\quad$  $\\Green{\\textrm{solve:} \\;\\; {\\bf K d} = {\\bf G}^T {\\bf s} \\;\\; \\textrm{for} \\;\\; \\bf d}$    10.  $\\quad$ $\\quad$  $\\Green{ \\textrm{set:} \\;\\; {\\bf w} = {\\bf K d} = {\\bf G K}^{-1}{\\bf G}^T {\\bf s}}$    11.  $\\quad$ $\\quad$  $\\alpha = ({\\bf r}_{k},{\\bf r}_{k})/({\\bf s}_{k},{\\bf w})$     12.  $\\quad$ $\\quad$  ${\\bf p}_k = {\\bf p}_{k-1} + \\alpha {\\bf s}_{k}$     13.  $\\quad$ $\\quad$  ${\\bf r}_k = {\\bf r}_{k-1} - \\alpha {\\bf w}$     14.  $\\quad$ end    15.  $\\quad$ ${\\bf d} = {\\bf d}_k$\nOur assumption is that the matrix, \\(\\hat{\\bf K}\\) could not be calculated because it would be too time consuming (and self-defeating) to do so, but it is also possible to imagine a case where we would compute the effect of an operator on a vector as a result of a black-box operation not",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Methods for Solving Numerical Problems</span>"
    ]
  },
  {
    "objectID": "DraftMaterial/NumericalMethods5.html#time",
    "href": "DraftMaterial/NumericalMethods5.html#time",
    "title": "Methods for Solving Numerical Problems",
    "section": "Time",
    "text": "Time\nWe have concentrated on the solution to equibrium equations without really touching on the way time is evolved in elasticity and slow flow where the equations themselves are independent of time. In the mantle dynamics problem, the energy equation contains time derivatives which the equation of motion lacks so it is unsurprising that these equations require entirely different computational methods.\nWe almost always want to know the time-history of our simulations, so we generally solve this equation explicitly or semi-implicitly in time.\nVariational methods are not generally applicable because the energy equation with its strong advection term does not follow an extremum of some functional. In this case even the weak forms of the equation are quite similar to finite difference equations.\n\n&lt;!– %## Ideas on a Particle in Cell Finite Element Code}",
    "crumbs": [
      "Introduction",
      "**Draft: Computational Methods**",
      "<span class='chapter-number'>20</span>  <span class='chapter-title'>Methods for Solving Numerical Problems</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.",
    "crumbs": [
      "Introduction",
      "References",
      "<span class='chapter-number'>21</span>  <span class='chapter-title'>Summary</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Acheson, D. J. 1990. Elementary Fluid Dynamics. Oxford\nUniversity Press.\n\n\nBatchelor, G. K. 1967. An Introduction to Fluid Dynamics.\nCambridge University Press.\n\n\nMoresi, L. N., S. Zhong, and M. Gurnis. 1996. “The Accuracy of\nFinite Element Solutions of Stokes’ Flow with Strongly Varying\nViscosity.” Physics of the Earth and Planetary Interiors\n97 (1-4): 83–94.\n\n\nMoresi, L., and V. Solomatov. 1995. “Numerical Investigation of 2D\nConvection with Extremely Large Viscosity Variations.”\nPhysics of Fluids 7 (9): 2154–62.\n\n\nTackley, P. J. 2008. “Modelling Compressible Mantle Convection\nwith Large Viscosity Contrasts in a Three-Dimensional Spherical Shell\nUsing the Yin-Yang Grid.” Physics of the Earth and Planetary\nInteriors 171 (1-4): 7–18.\n\n\nTurcotte, D., and G. Schubert. 2014. Geodynamics. 3rd ed.\nCambridge University Press.\n\n\nWhite, F. M. 2006. Viscous Fluid Flow. 3rd ed. McGraw-Hill.\n\n\nZhong, S., D. A. Yuen, and L. N. Moresi. 2007. Numerical Methods for\nMantle Convection. Treatise on Geophysics. Vol. 7.",
    "crumbs": [
      "Introduction",
      "References",
      "References"
    ]
  },
  {
    "objectID": "Contributions/contributing.html",
    "href": "Contributions/contributing.html",
    "title": "Contributing to the Computational Geodynamics Primer",
    "section": "",
    "text": "Scope and Objectives\nWe welcome contributions to this book! This primer aims to provide a comprehensive introduction to computational geodynamics, covering both the theoretical foundations and practical computational methods.\nThis book is designed to:",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Contributing to the Computational Geodynamics Primer</span>"
    ]
  },
  {
    "objectID": "Contributions/contributing.html#scope-and-objectives",
    "href": "Contributions/contributing.html#scope-and-objectives",
    "title": "Contributing to the Computational Geodynamics Primer",
    "section": "",
    "text": "Provide a solid mathematical foundation for understanding geodynamic processes\nIntroduce numerical methods commonly used in computational geodynamics\nBridge the gap between theory and practical implementation\nInclude hands-on computational exercises using modern tools",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Contributing to the Computational Geodynamics Primer</span>"
    ]
  },
  {
    "objectID": "Contributions/contributing.html#target-audience",
    "href": "Contributions/contributing.html#target-audience",
    "title": "Contributing to the Computational Geodynamics Primer",
    "section": "Target Audience",
    "text": "Target Audience\n\nGraduate students in geophysics, geodynamics, and related fields\nResearchers transitioning to computational geodynamics\nAdvanced undergraduates with strong mathematics and physics backgrounds",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Contributing to the Computational Geodynamics Primer</span>"
    ]
  },
  {
    "objectID": "Contributions/contributing.html#topics-needed",
    "href": "Contributions/contributing.html#topics-needed",
    "title": "Contributing to the Computational Geodynamics Primer",
    "section": "Topics Needed",
    "text": "Topics Needed\nWe are actively seeking contributions in the following areas:\n\nMathematical Foundations\n\nAdvanced tensor calculus for continuum mechanics\nVariational principles in geodynamics\nAsymptotic analysis and perturbation methods\n\n\n\nFluid Dynamics\n\nTurbulence and transition in geophysical flows\nMulti-phase flow in geological systems\nReactive flow and chemical transport\n\n\n\nGeodynamics Applications\n\nSubduction zone dynamics\nMid-ocean ridge processes\nContinental deformation and orogenesis\nCore dynamics and geodynamo theory\nPlanetary geodynamics\n\n\n\nNumerical Methods\n\nAdvanced finite element methods (mixed formulations, stabilization)\nSpectral methods for geodynamic problems\nParticle-based methods (SPH, MPM)\nAdaptive mesh refinement strategies\nParallel computing and scalability\n\n\n\nComputational Exercises\n\nPython implementations of basic algorithms\nJupyter notebooks with interactive examples\nBenchmarking exercises\nReal-world case studies",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Contributing to the Computational Geodynamics Primer</span>"
    ]
  },
  {
    "objectID": "Contributions/contributing.html#style-guide",
    "href": "Contributions/contributing.html#style-guide",
    "title": "Contributing to the Computational Geodynamics Primer",
    "section": "Style Guide",
    "text": "Style Guide\nPlease see the Style Guide for formatting conventions and best practices.",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Contributing to the Computational Geodynamics Primer</span>"
    ]
  },
  {
    "objectID": "Contributions/contributing.html#how-to-contribute",
    "href": "Contributions/contributing.html#how-to-contribute",
    "title": "Contributing to the Computational Geodynamics Primer",
    "section": "How to Contribute",
    "text": "How to Contribute\n\nFork the repository on GitHub\nCreate a new branch for your contribution\nWrite your content following the style guide\nTest the build locally using quarto preview WebBook\nSubmit a pull request with a clear description of your contribution",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Contributing to the Computational Geodynamics Primer</span>"
    ]
  },
  {
    "objectID": "Contributions/contributing.html#questions",
    "href": "Contributions/contributing.html#questions",
    "title": "Contributing to the Computational Geodynamics Primer",
    "section": "Questions?",
    "text": "Questions?\nIf you have questions about contributing, please open an issue on the GitHub repository or contact the maintainers.",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>22</span>  <span class='chapter-title'>Contributing to the Computational Geodynamics Primer</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html",
    "href": "Contributions/style-guide.html",
    "title": "Style Guide",
    "section": "",
    "text": "File Organization\nThis guide provides conventions for writing and formatting content for the Computational Geodynamics Primer.",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#file-organization",
    "href": "Contributions/style-guide.html#file-organization",
    "title": "Style Guide",
    "section": "",
    "text": "Place chapter files in the appropriate subdirectory (e.g., Part1-Fundamentals/, DraftMaterial/)\nUse descriptive, lowercase filenames with hyphens: thermal-convection.qmd\nStore images in Images/Diagrams/ or Images/Photos/",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#mathematical-notation",
    "href": "Contributions/style-guide.html#mathematical-notation",
    "title": "Style Guide",
    "section": "Mathematical Notation",
    "text": "Mathematical Notation\n\nGlobal Macros\nWe have defined global macros in _math-preamble.qmd. Include this at the top of each chapter:\n::: {.hidden}\n$$\n% Global LaTeX macros for MathJax\n\\newcommand{\\dGamma}{\\mathbf{d}\\boldsymbol{\\Gamma}}\n\\newcommand{\\uv}{\\mathbf{u}}\n\\newcommand{\\vv}{\\mathbf{v}}\n\\newcommand{\\nhat}{\\mathbf{\\hat{n}}}\n\\newcommand{\\DIV}{\\nabla\\cdot}\n\\newcommand{\\GRAD}{\\nabla}\n\\newcommand{\\CURL}{\\nabla\\times}\n\\DeclareMathOperator{\\erfc}{erfc}\n\n% Differential operators\n\\newcommand{\\DDt}[1]{\\frac{D #1}{D t}}\n\\newcommand{\\ddt}[1]{\\frac{d #1}{d t}}\n\\newcommand{\\ppt}[1]{\\frac{\\partial #1}{\\partial t}}\n\\newcommand{\\ppx}[1]{\\frac{\\partial #1}{\\partial x}}\n\n% Color commands (MathJax compatible)\n\\newcommand{\\Red}[1]{{\\color{red} #1}}\n\\newcommand{\\Green}[1]{{\\color{green} #1}}\n\\newcommand{\\Blue}[1]{{\\color{blue} #1}}\n\\newcommand{\\Emerald}[1]{{\\color{teal} #1}}\n$$\n:::\nAvailable macros include: - \\uv - velocity vector \\(\\mathbf{u}\\) - \\vv - velocity vector \\(\\mathbf{v}\\) - \\DIV - divergence operator \\(\\nabla\\cdot\\) - \\GRAD - gradient operator \\(\\nabla\\) - \\CURL - curl operator \\(\\nabla\\times\\) - \\Red{text} - red text for emphasis - \\Blue{text} - blue text - \\Green{text} - green text\n\n\nEquations\nUse display equations with labels for important results:\n$$\n\\DIV \\sigma + \\rho \\mathbf{g} = 0\n$$ {#eq-stokes-momentum}\nReference equations using @eq-label:\nThe momentum equation @eq-stokes-momentum shows...\n\n\nMulti-line Equations\nFor multi-line equations, use the aligned or split environments:\n$$\n\\begin{aligned}\n\\frac{\\partial T}{\\partial t} + \\uv \\cdot \\GRAD T &= \\kappa \\nabla^2 T + H \\\\\n\\DIV \\uv &= 0\n\\end{aligned}\n$$",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#figures",
    "href": "Contributions/style-guide.html#figures",
    "title": "Style Guide",
    "section": "Figures",
    "text": "Figures\nUse Markdown image syntax with labels:\n![Caption describing the figure](../Images/Diagrams/filename.png){#fig-label width=450px}\nReference figures using @fig-label:\nAs shown in @fig-convection-cells, the...",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#citations",
    "href": "Contributions/style-guide.html#citations",
    "title": "Style Guide",
    "section": "Citations",
    "text": "Citations\nAdd references to references.bib in BibTeX format. Cite using:\nThe seminal work by @turcotte2014 showed...\n\nMultiple studies [@moresi1995; @tackley2008] have demonstrated...",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#code-blocks",
    "href": "Contributions/style-guide.html#code-blocks",
    "title": "Style Guide",
    "section": "Code Blocks",
    "text": "Code Blocks\n\nPython Code\nFor executable Python code using pyodide:\n```{pyodide-python}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Your code here\n```\nFor non-executable code examples:\n```python\n# Example code\ndef solve_stokes(mesh, viscosity):\n    # Implementation\n    pass\n```",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#headings",
    "href": "Contributions/style-guide.html#headings",
    "title": "Style Guide",
    "section": "Headings",
    "text": "Headings\nUse hierarchical headings:\n# Chapter Title (automatically numbered)\n\n## Major Section\n\n### Subsection\n\n#### Minor subsection (use sparingly)",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#emphasis-and-formatting",
    "href": "Contributions/style-guide.html#emphasis-and-formatting",
    "title": "Style Guide",
    "section": "Emphasis and Formatting",
    "text": "Emphasis and Formatting\n\nBold for key terms on first use: **Rayleigh number**\nItalics for emphasis: *important*\nCode font for variables and functions: `temperature`\nMath mode for mathematical symbols: $\\eta$",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#cross-references",
    "href": "Contributions/style-guide.html#cross-references",
    "title": "Style Guide",
    "section": "Cross-References",
    "text": "Cross-References\n\nInternal Links\nLink to other chapters:\nSee [Conservation Laws](../DraftMaterial/ContinuumMechanics.qmd) for details.\n\n\nEquations in Other Files\nWhen referencing equations from other chapters, use @eq-label. Note that cross-file references may generate warnings during single-file rendering.",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#callout-blocks",
    "href": "Contributions/style-guide.html#callout-blocks",
    "title": "Style Guide",
    "section": "Callout Blocks",
    "text": "Callout Blocks\nUse callout blocks to highlight important information:\n:::{.callout-note}\nThis is a note.\n:::\n\n:::{.callout-tip}\nThis is a helpful tip.\n:::\n\n:::{.callout-warning}\nThis is a warning about potential issues.\n:::\n\n:::{.callout-important}\nThis is important information.\n:::\n\n:::{.callout-caution}\nExercise caution in this situation.\n:::\nAdd collapse=\"true\" to make them collapsible:\n:::{.callout-note collapse=\"true\"}\n## Click to expand\nHidden content here...\n:::",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#physical-quantities-and-units",
    "href": "Contributions/style-guide.html#physical-quantities-and-units",
    "title": "Style Guide",
    "section": "Physical Quantities and Units",
    "text": "Physical Quantities and Units\n\nUse SI units by default\nClearly state non-dimensional forms\nUse consistent notation for physical quantities throughout the book",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#common-notation",
    "href": "Contributions/style-guide.html#common-notation",
    "title": "Style Guide",
    "section": "Common Notation",
    "text": "Common Notation\n\n\\(\\eta\\) - dynamic viscosity\n\\(\\rho\\) - density\n\\(T\\) - temperature\n\\(\\mathbf{u}\\), \\(\\mathbf{v}\\) - velocity vectors\n\\(p\\) - pressure\n\\(\\kappa\\) - thermal diffusivity\n\\(\\alpha\\) - thermal expansivity\n\\(g\\) - gravitational acceleration",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/style-guide.html#examples",
    "href": "Contributions/style-guide.html#examples",
    "title": "Style Guide",
    "section": "Examples",
    "text": "Examples\nSee the Example: Using Citations and Math chapter for a working demonstration of these conventions.",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>23</span>  <span class='chapter-title'>Style Guide</span>"
    ]
  },
  {
    "objectID": "Contributions/example-citations.html",
    "href": "Contributions/example-citations.html",
    "title": "Example: Using Citations and Math",
    "section": "",
    "text": "Citations\nThis chapter demonstrates how to use citations and mathematics in the book, showing both the source markup and the rendered output.\nFor complete documentation, see the Quarto Documentation and specifically:",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Example: Using Citations and Math</span>"
    ]
  },
  {
    "objectID": "Contributions/example-citations.html#citations",
    "href": "Contributions/example-citations.html#citations",
    "title": "Example: Using Citations and Math",
    "section": "",
    "text": "Source Markup\nFor a comprehensive introduction to geodynamics, see @turcotte2014.\nThe numerical methods for mantle convection are well described in @zhong2007.\n\nMultiple citations can be grouped: [@moresi1995; @moresi1996; @tackley2008].\n\nFor fluid dynamics fundamentals, classic texts include @batchelor1967 and @acheson1990.\n\n\nRendered Output\nFor a comprehensive introduction to geodynamics, see Turcotte and Schubert (2014). The numerical methods for mantle convection are well described in Zhong, Yuen, and Moresi (2007).\nMultiple citations can be grouped: (L. Moresi and Solomatov 1995; L. N. Moresi, Zhong, and Gurnis 1996; Tackley 2008).\nFor fluid dynamics fundamentals, classic texts include Batchelor (1967) and Acheson (1990).",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Example: Using Citations and Math</span>"
    ]
  },
  {
    "objectID": "Contributions/example-citations.html#mathematics-with-proper-rendering",
    "href": "Contributions/example-citations.html#mathematics-with-proper-rendering",
    "title": "Example: Using Citations and Math",
    "section": "Mathematics with Proper Rendering",
    "text": "Mathematics with Proper Rendering\n\n$$ % Global LaTeX macros for MathJax \n% Differential operators\n% Color commands (MathJax compatible)\n$$\n\n\nInline Math\n\nSource Markup\nThe Stokes equation for incompressible flow is $\\DIV \\sigma = \\rho \\mathbf{g}$\nwhere $\\sigma$ is the stress tensor and $\\rho$ is density.\n\n\nRendered Output\nThe Stokes equation for incompressible flow is \\(\\nabla\\cdot\\sigma = \\rho \\mathbf{g}\\) where \\(\\sigma\\) is the stress tensor and \\(\\rho\\) is density.\n\n\n\nDisplay Equations with Labels\n\nSource Markup\n$$\n\\DIV \\sigma + \\rho \\mathbf{g} = 0\n$$ {#eq-stokes-momentum}\n\n$$\n\\DIV \\uv = 0\n$$ {#eq-incompressible}\n\nWe can reference equations: The momentum equation @eq-stokes-momentum\ncombined with incompressibility @eq-incompressible forms the basis of\nmantle convection modeling.\n\n\nRendered Output\n\\[\n\\nabla\\cdot\\sigma + \\rho \\mathbf{g} = 0\n\\tag{24.1}\\]\n\\[\n\\nabla\\cdot\\mathbf{u}= 0\n\\tag{24.2}\\]\nWe can reference equations: The momentum equation Equation 24.1 combined with incompressibility Equation 24.2 forms the basis of mantle convection modeling.\n\n\n\nMulti-line Equations\n\nSource Markup\n$$\n\\begin{aligned}\n\\frac{\\partial T}{\\partial t} + \\uv \\cdot \\GRAD T &= \\kappa \\nabla^2 T + H \\\\\n\\DIV \\uv &= 0 \\\\\n\\rho &= \\rho_0(1 - \\alpha T)\n\\end{aligned}\n$$ {#eq-thermal-system}\n\n\nRendered Output\n\\[\n\\begin{aligned}\n\\frac{\\partial T}{\\partial t} + \\mathbf{u}\\cdot \\nabla T &= \\kappa \\nabla^2 T + H \\\\\n\\nabla\\cdot\\mathbf{u}&= 0 \\\\\n\\rho &= \\rho_0(1 - \\alpha T)\n\\end{aligned}\n\\tag{24.3}\\]\nThe thermal convection system Equation 24.3 couples temperature and velocity.",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Example: Using Citations and Math</span>"
    ]
  },
  {
    "objectID": "Contributions/example-citations.html#colored-math-for-emphasis",
    "href": "Contributions/example-citations.html#colored-math-for-emphasis",
    "title": "Example: Using Citations and Math",
    "section": "Colored Math (for emphasis)",
    "text": "Colored Math (for emphasis)\n\nSource Markup\nThe $\\Red{red}$ terms represent heating, while $\\Blue{blue}$ terms represent cooling:\n\n$$\n\\frac{\\partial T}{\\partial t} + \\uv \\cdot \\GRAD T = \\kappa \\nabla^2 T + \\Red{H} - \\Blue{L}\n$$\n\n\nRendered Output\nThe \\({\\color{red} red}\\) terms represent heating, while \\({\\color{blue} blue}\\) terms represent cooling:\n\\[\n\\frac{\\partial T}{\\partial t} + \\mathbf{u}\\cdot \\nabla T = \\kappa \\nabla^2 T + {\\color{red} H} - {\\color{blue} L}\n\\]",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Example: Using Citations and Math</span>"
    ]
  },
  {
    "objectID": "Contributions/example-citations.html#figures",
    "href": "Contributions/example-citations.html#figures",
    "title": "Example: Using Citations and Math",
    "section": "Figures",
    "text": "Figures\n\nSource Markup\n![Consider the fluid motions in a layer of arbitrary depth, $d$. The fluid is\nassumed to have constant properties such as viscosity, thermal expansivity,\nthermal diffusivity.](../Images/Diagrams/layer.png){#fig-layer-example width=350px}\n\nAs shown in @fig-layer-example, the layer has depth $d$.\n\n\nRendered Output\n\n\n\n\n\n\nFigure 24.1: Consider the fluid motions in a layer of arbitrary depth, \\(d\\). The fluid is assumed to have constant properties such as viscosity, thermal expansivity, thermal diffusivity.\n\n\n\nAs shown in Figure 24.1, the layer has depth \\(d\\).",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Example: Using Citations and Math</span>"
    ]
  },
  {
    "objectID": "Contributions/example-citations.html#code-blocks",
    "href": "Contributions/example-citations.html#code-blocks",
    "title": "Example: Using Citations and Math",
    "section": "Code Blocks",
    "text": "Code Blocks\n\nPython Code (Display Only)\n\nSource Markup\n```python\nimport numpy as np\n\ndef rayleigh_number(rho, g, alpha, delta_T, d, kappa, eta):\n    \"\"\"Calculate Rayleigh number for thermal convection.\"\"\"\n    return (rho * g * alpha * delta_T * d**3) / (kappa * eta)\n```\n\n\nRendered Output\nimport numpy as np\n\ndef rayleigh_number(rho, g, alpha, delta_T, d, kappa, eta):\n    \"\"\"Calculate Rayleigh number for thermal convection.\"\"\"\n    return (rho * g * alpha * delta_T * d**3) / (kappa * eta)\n\n\n\nInteractive Python (using pyodide)\n\nSource Markup\n```{pyodide-python}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Calculate Rayleigh number for different viscosities\neta_values = np.logspace(19, 23, 50)\nRa = 3300 * 10 * 3e-5 * 3000 * (2900e3)**3 / (1e-6 * eta_values)\n\nplt.figure(figsize=(8, 5))\nplt.loglog(eta_values, Ra)\nplt.xlabel('Viscosity (Pa·s)')\nplt.ylabel('Rayleigh Number')\nplt.title('Mantle Rayleigh Number vs Viscosity')\nplt.grid(True, alpha=0.3)\nplt.show()\n```\n\n\nRendered Output",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Example: Using Citations and Math</span>"
    ]
  },
  {
    "objectID": "Contributions/example-citations.html#using-global-macros",
    "href": "Contributions/example-citations.html#using-global-macros",
    "title": "Example: Using Citations and Math",
    "section": "Using Global Macros",
    "text": "Using Global Macros\n\nSource Markup\nAt the top of your file, include the math preamble:\n::: {.hidden}\n$$\n% Global LaTeX macros for MathJax\n\\newcommand{\\dGamma}{\\mathbf{d}\\boldsymbol{\\Gamma}}\n\\newcommand{\\uv}{\\mathbf{u}}\n\\newcommand{\\vv}{\\mathbf{v}}\n\\newcommand{\\nhat}{\\mathbf{\\hat{n}}}\n\\newcommand{\\DIV}{\\nabla\\cdot}\n\\newcommand{\\GRAD}{\\nabla}\n\\newcommand{\\CURL}{\\nabla\\times}\n\\DeclareMathOperator{\\erfc}{erfc}\n\n% Differential operators\n\\newcommand{\\DDt}[1]{\\frac{D #1}{D t}}\n\\newcommand{\\ddt}[1]{\\frac{d #1}{d t}}\n\\newcommand{\\ppt}[1]{\\frac{\\partial #1}{\\partial t}}\n\\newcommand{\\ppx}[1]{\\frac{\\partial #1}{\\partial x}}\n\n% Color commands (MathJax compatible)\n\\newcommand{\\Red}[1]{{\\color{red} #1}}\n\\newcommand{\\Green}[1]{{\\color{green} #1}}\n\\newcommand{\\Blue}[1]{{\\color{blue} #1}}\n\\newcommand{\\Emerald}[1]{{\\color{teal} #1}}\n$$\n:::\nThen use the defined macros:\n- Velocity: $\\uv$ or $\\vv$\n- Divergence: $\\DIV \\uv = 0$\n- Gradient: $\\GRAD T$\n- Curl: $\\CURL \\mathbf{B}$\n- Colored text: $\\Red{important}$, $\\Blue{cold}$, $\\Green{check}$\n\n\nRendered Output\nAvailable macros (already included at the top of this page):\n\nVelocity: \\(\\mathbf{u}\\) or \\(\\mathbf{v}\\)\nDivergence: \\(\\nabla\\cdot\\mathbf{u}= 0\\)\nGradient: \\(\\nabla T\\)\nCurl: \\(\\nabla\\times\\mathbf{B}\\)\nColored text: \\({\\color{red} important}\\), \\({\\color{blue} cold}\\), \\({\\color{green} check}\\)",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Example: Using Citations and Math</span>"
    ]
  },
  {
    "objectID": "Contributions/example-citations.html#callout-blocks",
    "href": "Contributions/example-citations.html#callout-blocks",
    "title": "Example: Using Citations and Math",
    "section": "Callout Blocks",
    "text": "Callout Blocks\nCallout blocks are useful for highlighting important information, tips, warnings, and notes. See the Quarto Callout Blocks documentation for more details.\n\nSource Markup\n:::{.callout-note}\n## Note Title (optional)\n\nThis is a note callout. Use it for general information that readers should be aware of.\n:::\n\n:::{.callout-tip}\n## Tip: Numerical Stability\n\nWhen implementing finite difference schemes, always check the CFL condition:\n$$\n\\Delta t \\leq \\frac{\\Delta x^2}{2\\kappa}\n$$\n:::\n\n:::{.callout-warning}\n## Warning\n\nThe Boussinesq approximation breaks down when density variations exceed\napproximately 10% of the reference density.\n:::\n\n:::{.callout-important}\n## Important: Sign Conventions\n\nIn this book, we use the convention that tensile stress is positive and\ncompressive stress is negative.\n:::\n\n:::{.callout-caution}\n## Caution: Computational Cost\n\nThree-dimensional calculations can be extremely expensive. A grid with\n$100^3$ points requires solving systems with ~1 million unknowns.\n:::\n\n\nRendered Output\n\n\n\n\n\n\nNoteNote Title (optional)\n\n\n\nThis is a note callout. Use it for general information that readers should be aware of.\n\n\n\n\n\n\n\n\nTipTip: Numerical Stability\n\n\n\nWhen implementing finite difference schemes, always check the CFL condition: \\[\n\\Delta t \\leq \\frac{\\Delta x^2}{2\\kappa}\n\\]\n\n\n\n\n\n\n\n\nWarningWarning\n\n\n\nThe Boussinesq approximation breaks down when density variations exceed approximately 10% of the reference density.\n\n\n\n\n\n\n\n\nImportantImportant: Sign Conventions\n\n\n\nIn this book, we use the convention that tensile stress is positive and compressive stress is negative.\n\n\n\n\n\n\n\n\nCautionCaution: Computational Cost\n\n\n\nThree-dimensional calculations can be extremely expensive. A grid with \\(100^3\\) points requires solving systems with ~1 million unknowns.\n\n\n\n\nCollapsible Callouts\nYou can make callouts collapsible (closed by default):\n\nSource Markup\n:::{.callout-note collapse=\"true\"}\n## Derivation Details (click to expand)\n\nHere's the detailed derivation that advanced readers might want to see,\nbut beginners can skip:\n\nStarting from the continuity equation...\n[lengthy derivation]\n:::\n\n\nRendered Output\n\n\n\n\n\n\nNoteDerivation Details (click to expand)\n\n\n\n\n\nHere’s the detailed derivation that advanced readers might want to see, but beginners can skip:\nStarting from the continuity equation, we apply the divergence theorem and integrate by parts to obtain the weak formulation…",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Example: Using Citations and Math</span>"
    ]
  },
  {
    "objectID": "Contributions/example-citations.html#references",
    "href": "Contributions/example-citations.html#references",
    "title": "Example: Using Citations and Math",
    "section": "References",
    "text": "References\nThe bibliography will appear at the end of the book automatically based on all cited works.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAcheson, D. J. 1990. Elementary Fluid Dynamics. Oxford University Press.\n\n\nBatchelor, G. K. 1967. An Introduction to Fluid Dynamics. Cambridge University Press.\n\n\nMoresi, L. N., S. Zhong, and M. Gurnis. 1996. “The Accuracy of Finite Element Solutions of Stokes’ Flow with Strongly Varying Viscosity.” Physics of the Earth and Planetary Interiors 97 (1-4): 83–94.\n\n\nMoresi, L., and V. Solomatov. 1995. “Numerical Investigation of 2D Convection with Extremely Large Viscosity Variations.” Physics of Fluids 7 (9): 2154–62.\n\n\nTackley, P. J. 2008. “Modelling Compressible Mantle Convection with Large Viscosity Contrasts in a Three-Dimensional Spherical Shell Using the Yin-Yang Grid.” Physics of the Earth and Planetary Interiors 171 (1-4): 7–18.\n\n\nTurcotte, D., and G. Schubert. 2014. Geodynamics. 3rd ed. Cambridge University Press.\n\n\nZhong, S., D. A. Yuen, and L. N. Moresi. 2007. Numerical Methods for Mantle Convection. Treatise on Geophysics. Vol. 7.",
    "crumbs": [
      "Introduction",
      "Contributing",
      "<span class='chapter-number'>24</span>  <span class='chapter-title'>Example: Using Citations and Math</span>"
    ]
  },
  {
    "objectID": "Notebooks/BinderLandingPage.html",
    "href": "Notebooks/BinderLandingPage.html",
    "title": "Index of notebooks:",
    "section": "",
    "text": "TestNB1 (ipynb)\nTestQMD (qmd)",
    "crumbs": [
      "Introduction",
      "Appendices",
      "Index of notebooks:"
    ]
  },
  {
    "objectID": "Notebooks/TestNB1.html",
    "href": "Notebooks/TestNB1.html",
    "title": "Appendix A — Test Notebook",
    "section": "",
    "text": "for i in range(0,10):\n    print(i)",
    "crumbs": [
      "Introduction",
      "Appendices",
      "<span class='chapter-number'>A</span>  <span class='chapter-title'>Test Notebook</span>"
    ]
  },
  {
    "objectID": "Notebooks/TestQMD_NB1.html",
    "href": "Notebooks/TestQMD_NB1.html",
    "title": "Appendix B — Quarto MD notebook",
    "section": "",
    "text": "for i in range(0,10):\n    print(i+1)",
    "crumbs": [
      "Introduction",
      "Appendices",
      "<span class='chapter-number'>B</span>  <span class='chapter-title'>Quarto MD notebook</span>"
    ]
  }
]