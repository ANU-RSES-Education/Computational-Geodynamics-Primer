<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>MathPhysicsBackground</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js" type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<p><span>VIEPS Geodynamics — 2015</span><br />
</p>
<p><img src="MundusSubterraneusOriginal.jpg" alt="image" /><br />
Athanasius Kircher, Mundus subterraneus (1664/65): “Systema Ideale PYRO- PHYLACIORUM Subterraneorum, quorum montes <em>Vulcanii, veluti spiracula quaedam existant</em>”</p>
<p><span>Louis Moresi (louis.moresi@unimelb.edu.au)</span></p>
<h1 id="sec:introduction">Introduction</h1>
<p>Our goal is to develop an quantitative understanding of the dynamic processes within the Earth and sister planets as I have sketched in the Figure to the right. These dynamic processes are largely driven by the internal heat of the planet escaping to the surface through whatever mechanisms are available. Some of the heat is left over from the original formation of the planet, and the rest originates in the decay of radioactive elements. In the Earth’s early history and elsewhere in the solar system, tidal heating, chemical segregation, and impacts have all played a role in supplying the interior heat budget. Figure <a href="#fig:Diagrams_EarthProcessesPlume" data-reference-type="ref" data-reference="fig:Diagrams_EarthProcessesPlume">[fig:Diagrams_EarthProcessesPlume]</a> is a schematic of the Earth’s interior and something similar for Venus and Mars would be, on the face of it, much simpler.</p>
<p><span>r</span><span>90mm</span></p>
<p><img src="Diagrams/EarthProcessesPlume.png" style="width:100mm" alt="image" /></p>
<p><span id="fig:Diagrams_EarthProcessesPlume" label="fig:Diagrams_EarthProcessesPlume">[fig:Diagrams_EarthProcessesPlume]</span></p>
<p>This is because the Earth’s dynamics is completely dominated by Plate Tectonics — a unique manifestation of interior heat loss as far as we are aware. Part of our task is to understand why plate tectonics is a possible outcome of a hot planet, but also why it is not the only possible outcome. If we can also understand how the different modes are selected for planets of different size, composition, and heat budget, then we have a powerful way to predict the geological behaviour of extrasolar planets. Plate tectonics creates a number of very efficient cycling mechanisms which link the interior of the Earth and the Atmosphere and Oceans; it may prove to be an essential ingredient for the kind of friendly world we expect to be needed to nurture (intelligent) life.</p>
<h2 id="modeling">Modeling</h2>
<p>Global scale geodynamics is a discipline where we cannot do controlled experiments on the basic processes we are studying. We rely on observing the Earth and the other terrestrial planets and moons and looking for multiple manifestations of the same processes under different conditions to give us control on certain parameters.</p>
<p>While it is not possible to do experiments at the planetary scale over geological time, it is possible to perform experiments at a physically manageable size and, by careful scaling, to generalise the results to geologically relevant space and time-scales. If these processes of interest can be understood through a mathematical description, then the equations are automatically applicable at geological time and space scales provided the assumptions which go into developing the mathematical model are still valid.</p>
<p>We will frequently be talking about “modeling” — people mean many different things by this and all of the following fall under the general concept of modeling:</p>
<ul>
<li><p>Laboratory based physical models which can be scaled to give meaningful, quantitative insight into deformation at geological scales.</p></li>
<li><p>The building of mathematical descriptions of the world and their use to approximate physical "reality".</p></li>
<li><p>Computational solution of these descriptions (where needed) and the concept of a numerical model.</p></li>
<li><p>How to go about constructing a model</p></li>
<li><p>How to go about using a model (these are quite different things !).</p></li>
<li><p>Exploring parameter variation to understand the dominant effects.</p></li>
</ul>
<h2 id="mathematical-background">Mathematical background</h2>
<p>These notes contains material at different levels. There is broadly descriptive content which is intended to introduce the subject and lead up to the more advanced mathematical content. It should be possible to follow these notes without detailed knowledge of how the mathematical results are obtained, but it is expected that you can use the results in exercises for to solve real problems in geophysics.</p>
<p>Familiarity with vector &amp; tensor notation &amp; index notation is required for understanding the kinds of equations we will be dealing with and I interchange them a little. On the assumption that these things are disconcerting (at best) the first few times, I tend to write everything out in full – at least for the Cartesian case. In other geometries, vector notation generally still holds, but the definition of the operators can be very different, and it is always worth checking before using them.</p>
<h1 id="conceptual-model-for-mantlelithosphere-dynamics">Conceptual model for mantle/lithosphere dynamics</h1>
<p><span>r</span><span>50mm</span></p>
<p><embed src="Diagrams/vol_elt.pdf" style="width:45mm" /></p>
<p>We start by deriving the equations of motion, energy balance and so on through a conservation principle. This will give a useful insight into the different forms of the equations which we will later encounter.</p>
<p>A general conservation law does not distinguish the quantity which is being conserved – it is a mathematical identity. Consider a quantity <span class="math inline">\(\phi\)</span> / unit mass which is carried around by a fluid. We can draw an arbitrary volume, <span class="math inline">\(\Omega\)</span> to contain some amount of this fluid at a given time. We label the surface of the volume <span class="math inline">\(\Omega\)</span> as <span class="math inline">\(\Gamma\)</span>, and define an outward surface normal vector <span class="math inline">\(\mathbf{d}\boldsymbol{\Gamma}\)</span> which is normal to the tangent plane of an infinitesimal element of the surface and has a magnitude equal to the area of this element.</p>
<p>We also define a source/sink term, <span class="math inline">\(H\)</span> / unit mass which generates/consumes the quantity <span class="math inline">\(\phi\)</span>, and a flux term, <span class="math inline">\(\mathbf{F}\)</span> which occurs across the surface when the fluid is stationary (e.g. this might represent diffusion of <span class="math inline">\(\phi\)</span>). The rate of change of <span class="math inline">\(\phi\)</span> is given by combining the contribution due to the source term, the stationary flux term, and the effect of motion of the fluid.</p>
<p><span class="math display">\[\frac{d}{dt} \int_{\Omega} \rho \phi d\Omega =
            - \int_{\Gamma} \mathbf{F} \cdot \mathbf{d}\boldsymbol{\Gamma}
            + \int_{\Omega} \rho H d\Omega
            - \int _{\Gamma} \rho \phi \mathbf{v} \cdot \mathbf{d}\boldsymbol{\Gamma}
        \label{eq:cons1}\]</span></p>
<p>where the final term is the change due to the fluid carrying <span class="math inline">\(\phi\)</span> through the volume. Fluxes are positive outward (by our definition of <span class="math inline">\(\mathbf{d}\boldsymbol{\Gamma}\)</span>), so a positive flux reduces <span class="math inline">\(\phi\)</span> within <span class="math inline">\(d\Omega\)</span> and negative signs are needed for these terms.</p>
<p>We can generally use Gauss’ theorem to write surface integrals as volume integrals:</p>
<p><span class="math display">\[\int_{\Gamma} \phi \mathbf{u} \cdot \mathbf{d}\boldsymbol{\Gamma}= \int_{\Omega}  \nabla \cdot (\phi \mathbf{u}) d\Omega\]</span></p>
<p>The test surface, <span class="math inline">\(\Gamma\)</span>, and volume, <span class="math inline">\(\Omega\)</span> are assumed to be <em>fixed in the lab reference frame</em> so that the order of integration and differentiation can be interchanged</p>
<p><span class="math display">\[\frac{d}{dt} \int_\Omega \rho \phi d\Omega =
                \int_\Omega \frac{\partial \rho \phi}{\partial t} d\Omega\]</span></p>
<p>Allowing us to write <span class="math display">\[\int_{\Gamma} \mathbf{F} \cdot \mathbf{d}\boldsymbol{\Gamma}+ 
        \int _{\Gamma} \rho \phi \mathbf{v} \cdot \mathbf{d}\boldsymbol{\Gamma}=
        \int_{\Omega} \nabla \cdot (\mathbf{F} + 
        \rho \phi \mathbf{v}) d\Omega\]</span></p>
<p>so that we rewrite the general conservation equation (<a href="#eq:cons1" data-reference-type="ref" data-reference="eq:cons1">[eq:cons1]</a>) as <span class="math display">\[\int_{\Omega} \left[ \frac{d \rho \phi}{dt} + 
            \nabla \cdot (\mathbf{F} + \rho \phi \mathbf{v}) 
            -\rho H \right] d\Omega =0\]</span></p>
<p>We can now appeal to the fact that this conservation law holds regardless of our particular choice of volume <span class="math inline">\(\Omega\)</span> and, therefore, the integral above can only be zero for arbitrary <span class="math inline">\(\Omega\)</span> if the enclosed term is zero everywhere, i.e. <span class="math display">\[\frac{d \rho \phi}{dt} + 
            \nabla \cdot (\mathbf{F} + \rho \phi \mathbf{v}) 
            -\rho H =0
            \label{eq:cons2}\]</span></p>
<p>This is the general conservation rule for any property <span class="math inline">\(\phi\)</span> of a moving fluid. We now consider several quantities and develop specific conservation laws.</p>
<h2 id="conservation-of-mass">Conservation of mass</h2>
<p>In this case <span class="math inline">\(\phi=1\)</span> (since <span class="math inline">\(\int_\Omega \rho d\Omega \rightarrow \mbox{mass}\)</span>), <span class="math inline">\(\mathbf{F} = H = 0\)</span>. Thus, equation (<a href="#eq:cons2" data-reference-type="ref" data-reference="eq:cons2">[eq:cons2]</a>) gives <span class="math display">\[\textcolor[rgb]{0.7,0.0,0.0}{\frac{\partial \rho}{\partial t} + 
                \nabla \cdot \rho \mathbf{v} = 0}
            \label{eq:masscons}\]</span></p>
<h2 id="conservation-of-heat-energy">Conservation of (heat) energy</h2>
<p>The thermal energy / unit mass is <span class="math inline">\(C_p T\)</span> and the conductive heat flux <span class="math inline">\(\mathbf{F}\)</span> is given by <span class="math inline">\(\mathbf{F} = -k \nabla T\)</span>, where <span class="math inline">\(k\)</span> is the thermal conductivity. Then the general conservation law of (<a href="#eq:cons2" data-reference-type="ref" data-reference="eq:cons2">[eq:cons2]</a>) reduces to <span class="math display">\[\frac{\partial (\rho C_p T)}{\partial t} +
             \nabla \cdot \left(-k \nabla T + 
             \rho C_p T \mathbf{v}\right) - \rho H = 0\]</span></p>
<p>Rearranging with some foresight gives this <span class="math display">\[\frac{C_p T}{\rho} \left[ \frac{\partial \rho}{\partial t} + 
            \nabla \cdot \rho \mathbf{v} \right] + 
            \frac{\partial C_p T}{\partial t} + 
            \mathbf{v} \cdot \nabla C_p T = 
            \frac{1}{\rho} \nabla \cdot k \nabla T + H\]</span></p>
<p>Where the term in square brackets is simply the statement of mass conservation which vanishes identically. The constant density assumption is just to simplify the discussion at this point and will have to be revisited later in the context of thermal convection where density changes drive the flow.</p>
<p>If the heat capacity, <span class="math inline">\(C_p\)</span> and thermal conductivity, <span class="math inline">\(k\)</span> are constants, then the conservation equation becomes <span class="math display">\[\textcolor[rgb]{0.7,0.0,0.0}{ \left( \frac{\partial T}{\partial t} + \mathbf{v} \cdot \nabla T \right)=
                        \kappa \nabla^2 T + \frac{H}{C_p} }
                \label{eq:energycons}\]</span></p>
<p>where <span class="math inline">\(\kappa\)</span> is the thermal diffusivity, <span class="math inline">\(\kappa = k/\rho C_p\)</span>.</p>
<p>This equation is linear provided that the velocity field is specified and is independent of <span class="math inline">\(T\)</span>. Clearly this is generally not true. A new bit of notation has been defined in the process of this derivation. The meaning of the <span class="math inline">\(\mathbf{v} \cdot \nabla\)</span> operator is <span class="math display">\[\mathbf{v} \cdot \nabla \equiv v_j \frac{\partial}{\partial x_j}\]</span></p>
<p>For later reference, this is how it looks: <span class="math display">\[(\mathbf{v} \cdot \nabla) T = v_1 \frac{\partial T}{\partial x_1} + 
                v_2 \frac{\partial T}{\partial x_2} + v_3 \frac{\partial T}{\partial x_3}\]</span></p>
<p>The Laplacian, <span class="math inline">\(\nabla^2\)</span>, is this expression (for scalar <span class="math inline">\(T\)</span>) <span class="math display">\[\nabla^2 T \equiv \frac{\partial^2 T}{\partial x_1^2} + \frac{\partial^2 T}{\partial x_2^2} + \frac{\partial^2 T}{\partial x_3^2}\]</span></p>
<h2 id="conservation-of-momentum">Conservation of momentum</h2>
<p>Momentum is a vector quantity, so the form of (<a href="#eq:cons1" data-reference-type="ref" data-reference="eq:cons1">[eq:cons1]</a>) is slightly different. The source term in a momentum equation represents a force, and the surface flux term represents a stress. <span class="math display">\[\frac{d}{dt}\int_{\Omega} \rho \mathbf{v} d\Omega = 
            -   \int_{\Omega} \rho g \hat{\mathbf{z}} d\Omega  
            +   \int_{\Gamma} \boldsymbol{\sigma} \cdot \mathbf{d}\boldsymbol{\Gamma}-
                \int_{\Gamma} \rho \mathbf{v} (\mathbf{v} \cdot \mathbf{d}\boldsymbol{\Gamma})    
                \label{eq:momcons1}\]</span></p>
<p>Gravity acts as a body force in the vertical direction, <span class="math inline">\(\hat{\mathbf{z}}\)</span>. We have introduced the stress tensor, <span class="math inline">\(\boldsymbol{\sigma}\)</span>; the force / unit area exerted on an arbitrarily oriented surface with normal <span class="math inline">\(\hat{\mathbf {n}}\)</span> is <span class="math display">\[f_i = \sigma_{ij} n_j\]</span></p>
<p>The application of Gauss’ theorem, and using the arbitrary nature of the chosen volume to require the integrand to be zero, as before, gives <span class="math display">\[\frac{\partial}{\partial t}(\rho \mathbf{v}) 
            +\rho g \hat{\mathbf{z}} - \nabla \cdot \sigma + \nabla \cdot (\rho \mathbf{v} \mathbf{v}) = 0
            \label{eq:momcons2}\]</span></p>
<p>Vector notation allows us to keep a number of equations written as one single equation. However, at this point, keeping the equations in vector notation makes the situation more confusing. Particularly, the last term of equation (<a href="#eq:momcons2" data-reference-type="ref" data-reference="eq:momcons2">[eq:momcons2]</a>) stretches the current notation rather too much. Instead, we consider the individual components of momentum, each of which must satisfy the conservation law independently</p>
<p>In index notation, equation (<a href="#eq:momcons2" data-reference-type="ref" data-reference="eq:momcons2">[eq:momcons2]</a>) is written as <span class="math display">\[\textcolor[rgb]{0.0,0.7,0.0}{ \frac{\partial \rho v_i}{\partial t}} + \rho g \delta_{i3} - 
            \frac{\partial \sigma_{ij}}{\partial x_j} +
            \textcolor[rgb]{0.0,0.0,0.7}{ \frac{\partial(\rho v_i v_j)}{\partial x_j}} = 0
            \label{eq:momindx}\]</span></p>
<p>where the troublesome final term is now unambiguous. Repeated indeces in each term are implicitly to be summed. <span class="math inline">\(\delta_{ij}\)</span> is the kronecker delta which obeys: <span class="math display">\[\delta_{ij} = \begin{cases}
                0 &amp; \text{if $i \neq j$}, \\
                1 &amp; \text{if $i = j$}.
            \end{cases}\]</span></p>
<p>With some foresight, we expand the derivatives of products of two terms and gather up some of the resulting terms: <span class="math display">\[v_i \left[\textcolor[rgb]{0.0,0.7,0.0}{ \frac{\partial \rho}{\partial t}} +
             \textcolor[rgb]{0.0,0.0,0.7}{  \frac{\partial \rho v_j}{\partial x_j}} \right]
            + \textcolor[rgb]{0.0,0.7,0.0}{ \rho \frac{\partial v_i}{\partial t}} + \textcolor[rgb]{0.0,0.0,0.7}{ \rho v_j \frac{\partial v_i}{\partial x_j}} =
            \frac{\partial \sigma_{ij}}{\partial x_j} -\rho g \delta_{i3}\]</span></p>
<p>The term in square brackets is, in fact, a restatement of the conservation of mass derived above and must vanish. The remaining terms can now be written out in vector notation as <span class="math display">\[\textcolor[rgb]{0.7,0.0,0.0}{   \rho \left( \frac{\partial \mathbf{v}}{\partial t}
                            + (\mathbf{v} \cdot \nabla) \mathbf{v} \right) =
                         \nabla \cdot \boldsymbol{\sigma} - g\rho\hat{\mathbf{z}}      }
            \label{eq:momcons3}\]</span></p>
<p>Note: The <span class="math inline">\(\mathbf{v} \cdot \nabla\)</span> notation we introduced earlier is now an operator on a vector. In this context, the <span class="math inline">\(\mathbf{v} \cdot \nabla\)</span> operator acts on each component of the vector independently. Written out it looks like this: <span class="math display">\[\begin{split}
                    (\mathbf{v} \cdot \nabla) \mathbf{u} = 
                        &amp; \hat{\boldsymbol{\imath}} \left( v_1 \frac{\partial u_1}{\partial x_1} + 
                        v_2 \frac{\partial u_1}{\partial x_2} + v_3 \frac{\partial u_1}{\partial x_3} \right) \\
                            &amp; \hat{\boldsymbol{\jmath}} \left( v_1 \frac{\partial u_2}{\partial x_1} + 
                        v_2 \frac{\partial u_2}{\partial x_2} + v_3 \frac{\partial u_2}{\partial x_3} \right) \\
                            &amp; \hat{\boldsymbol{k}} \left( v_1 \frac{\partial u_3}{\partial x_1} + 
                        v_2 \frac{\partial u_3}{\partial x_2} + v_3 \frac{\partial u_3}{\partial x_3} \right) \\                
                \end{split}\]</span></p>
<h1 id="constitutive-laws">Constitutive Laws</h1>
<p>The formulation above is quite general, and can be extended where necessary to include conservation laws for additional physical variables (for example, angular momentum, electric current). Specific to the type of material which is deforming is the constitutive law which describes the stress. In the case of an incompressible fluid, the stress is related to strain rate through a viscosity, <span class="math inline">\(\eta\)</span>, and to the pressure, <span class="math inline">\(p\)</span>. Incompressibility is expressed as <span class="math display">\[\nabla \cdot \mathbf{u} = 0\]</span></p>
<p>This is a tighter constraint than mass conservation and emerges from equation (<a href="#eq:masscons" data-reference-type="ref" data-reference="eq:masscons">[eq:masscons]</a>) when <span class="math inline">\(\rho\)</span> is assumed to be constant. With this assumption, the constitutive law is written <span style="color: 0.0,0.7,0.3"> (A derivation for this is in Landau &amp; Lifschitz). </span> <span class="math display">\[\sigma_{ij} = \eta \left( \frac{\partial v_i}{\partial x_j} + \frac{\partial v_j}{\partial x_i}\right) - p\delta_{ij}\]</span></p>
<p>If the viscosity is constant, then we can substitute the constitutive law into the stress-divergence term of the momentum conservation equation. In index notation once again, <span class="math display">\[\begin{split}
                \nabla \cdot \boldsymbol{\sigma} &amp; =
                    \frac{\partial}{\partial x_j} \eta 
                        \left( \frac{\partial v_i}{\partial x_j} +  \frac{\partial v_j}{\partial x_i} \right)
                        - \frac{\partial p}{\partial x_j} \delta_{ij} \\
                &amp; = \eta \frac{\partial^2 v_i}{\partial x_j \partial x_j} +
                            \eta \frac{\partial^2 v_j}{\partial x_i \partial x_j} -
                                \frac{\partial p}{\partial x_i}\\
                &amp; = \eta \nabla^2 \mathbf{v} +
                             \eta \textcolor[rgb]{0.0,0.7,0.0}{ \nabla (\nabla \cdot \mathbf{v})} - \nabla p       
            \end{split}\]</span></p>
<p>the second term in this final form must vanish because of the incompressibility assumption, so the momentum conservation equation becomes</p>
<p><span class="math display">\[\textcolor[rgb]{0.7,0.0,0.0}{   \rho \left( \frac{\partial \mathbf{v}}{\partial t}
                            + (\mathbf{v} \cdot \nabla) \mathbf{v} \right) =
                            \eta \nabla^2 \mathbf{v} - \nabla p 
                            - g\rho\hat{\mathbf{z}}      }
                \label{eq:navstokes}\]</span></p>
<p>This is the Navier-Stokes equation. Once again some new notation has shown up uninvited. The Laplacian operator <span class="math inline">\(\nabla^2\)</span> is defined (in a scalar context) as <span class="math display">\[\begin{split}
            \nabla^2 \phi &amp; = \nabla \cdot \nabla \phi \\
                                    &amp; = \frac{\partial^2 \phi}{\partial x^2} + 
                                            \frac{\partial^2 \phi}{\partial y^2} +  
                                            \frac{\partial^2 \phi}{\partial z^2}  \text{\hspace{1cm} (Cartesian)}
            \end{split}\]</span></p>
<p>and in a vector context as <span class="math display">\[\begin{split}
                \nabla^2 \mathbf{u} &amp; = \nabla \nabla \cdot \mathbf{u} - \nabla \times (\nabla \times \mathbf{u}) \\
                                                    &amp; = \mathbf{i} \nabla \cdot \nabla u_x + 
                                                            \mathbf{j} \nabla \cdot \nabla u_y + 
                                                            \mathbf{k} \nabla \cdot \nabla u_z   \text{\hspace{1cm} (Cartesian)}
            \end{split}\]</span></p>
<p>In Cartesian coordinates, the Laplacian operator has a simple form, and the vector Laplacian is simply the scalar operator applied in each direction. In other coordinate systems this operator becomes substantially more elaborate.</p>
<h1 id="boussinesq-approximation-equation-of-state-density-variations">Boussinesq Approximation, Equation of State, Density Variations</h1>
<p>The equation which relates pressure, temperature and density is known as the equation of state. For the equations derived so far, we have specified an incompressible fluid, for which no density variations are possible. However, we have also included a source term for momentum which relies on gravity acting on <span><em>density variations</em></span>.</p>
<p>This conflict is typical of fluid mechanics: simplifying assumptions if taken to their logical limit imply no motion or some other trivial solution to the equations.</p>
<p>In this case, we make the assumption that density changes are typically small relative to the overall magnitude of the density itself. Terms which are scaled by density can therefore assume that it is a large constant value. Terms which contain gradients of density or density variations should consider the equation of state. This is the Boussinesq approximation and is only a suitable appropriation for nearly- incompressible fluids. In the Navier-Stokes equation, the hydrostatic pressure does not influence the velocity field at all. Only <em>differences</em> in density drive fluid flow, and so the sole term in which density needs to be considered variable is that of the gravitational body forces.</p>
<p>In the case of density variations due to temperature, the equation of state is simply <span class="math display">\[\rho = \rho_0 \left(1 - \alpha ( T-T_0 )\right)
            \label{eq:state}\]</span></p>
<p>where <span class="math inline">\(\rho_0\)</span> is the density at a reference temperature <span class="math inline">\(T_0\)</span>. <span class="math inline">\(\alpha\)</span> is the coefficient of thermal expansion. It is generally much smaller than one, making the Boussinesq approximation a reasonable choice.</p>
<p>The energy and momentum conservation equations thus become coupled through the term <span class="math display">\[g\rho\hat{\mathbf{z}} = g \rho_0 \left(1 - \alpha(T-T_0)\right)\]</span></p>
<p>Density variations due to pressure produce a perfectly vertical, isotropic forcing term on the momentum conservation equation. In the steady state case, this is balanced by the hydrostatic pressure gradient. (The isotropic term does not contribute at all the the deviatoric part of the stress equation and thus cannot induce steady flow). We therefore ignore the vertical density gradient due to the fluid overburden.</p>
<p>Another density variation is that which results from variation in chemical composition from one fluid element to another. This is the case where two immiscible fluids live in the same region. Now density variations might be large – the fluid domains must be considered separately.</p>
<h2 id="advection-and-the-lagrangian-formulation">Advection and the Lagrangian Formulation</h2>
<p>We have seen the <span class="math inline">\(\mathbf{v} \cdot \nabla\)</span> operator a number of times now. The presence of this term causes major difficulties in continuum mechanics since it introduces a strong non-linearity into the momentum equation. It is this term which produces turbulence in high speed flows etc.</p>
<p>This term is the ‘advection’ term which accounts for the passive transport of information (temperature, momentum, by the motion of the fluid. Advection also presents some serious headaches in numerical methods and has spawned entire literatures devoted to efficient and accurate solution methods.</p>
<p>One obvious way to avoid the problem of advection is to consider an elemental volume of space which <span><em>moves with the fluid</em></span>. The surface flux term from equation (<a href="#eq:cons1" data-reference-type="ref" data-reference="eq:cons1">[eq:cons1]</a>) vanishes immediately</p>
<p>Mathematically, we introduce a new notation (of course), as follows: <span class="math display">\[\frac{D \phi}{D t} = \frac{d}{dt} \phi[x_1(t),x_2(t),x_3(t),t]\]</span></p>
<p>where the change in the reference position <span class="math inline">\((x_1(t),x_2(t),x_3(t))\)</span> is governed by the local flow velocity: <span class="math display">\[\frac{d x_1}{d t} = v_1 \mbox{\hspace{1cm}}
                    \frac{d x_2}{d t} = v_2 \mbox{\hspace{1cm}}
                    \frac{d x_3}{d t} = v_3\]</span></p>
<p>which keeps the reference point moving with the fluid. Differentiating gives <span class="math display">\[\begin{aligned}
                \frac{D \phi}{D t} &amp;= \frac{\partial \phi}{\partial t}
                                    \frac{\partial \phi}{\partial x_1}\frac{d x_1}{d t} + 
                                    \frac{\partial \phi}{\partial x_2}\frac{d x_2}{d t} +
                                    \frac{\partial \phi}{\partial x_3}\frac{d x_3}{d t} \nonumber \\
        \intertext{and so leads to}
                \frac{D \phi}{D t} &amp;=   \frac{\partial \phi}{\partial t}
                                    v_1 \frac{\partial \phi}{\partial x_1} + 
                                    v_2 \frac{\partial \phi}{\partial x_2} +
                                    v_3 \frac{\partial \phi}{\partial x_3}  \nonumber \\
        \intertext{which is equivalent to}
                \frac{D \phi}{D t} &amp;= \frac{\partial \phi}{\partial t} + (\mathbf{v} \cdot \nabla) \phi                         
        \end{aligned}\]</span></p>
<p>If we think of <span class="math inline">\(\phi\)</span> as the concentration of a dye in the fluid, then the above is a conservation equation assuming the dye does not diffuse and has no sources or sinks.</p>
<p>Viewed from a reference frame locked to <span><em>a particular fluid element</em></span>, the energy conservation equation becomes <span class="math display">\[% \rho  ??
                \frac{D T}{Dt} =
                        \kappa \nabla^2 T + \frac{H}{C_p}\]</span></p>
<p>and the momentum conservation equation now becomes <span class="math display">\[\rho %% ?
            \frac{D \mathbf{v} }{D t} =
                            \eta \nabla^2 \mathbf{v} - \nabla P     
                            - g\rho\hat{\mathbf{z}}\]</span></p>
<p>This is a considerably more compact way of writing the equations, but we have only really succeeded in hiding the nasty term under the rug, since it is now necessary to use a coordinate system which is locked into the fluid and rapidly deforms as the fluid flows. Before long, the coordinate system is unimaginably complex – the advection problem returns in another guise. This formulation is known as the Lagrangian formulation and contrasts with the Eulerian viewpoint which is fixed in space.</p>
<p>From the numerical point of view, however, this approach can have some distinct advantages. The computer can often track the distorted coordinate system far better than it can handle successive applications of the <span class="math inline">\(\mathbf{v} \cdot \nabla\)</span> operator at a fixed point in space. We will return to this point later.</p>
<h1 id="non-dimensional-equations-dimensionless-numbers">Non-dimensional equations &amp; dimensionless numbers</h1>
<p>Before too long it would be a good idea to get a feeling for the flavour of these equations which continual rearrangements will not do — it is necessary to examine some solutions.</p>
<p>First of all, however, it is a good idea to make some simplifications based on the kinds of problems we will want to attack. The first thing to do, as is often the case when developing a model, is to test whether any of the terms in the equations are negligibly small, or utterly dominant. This is done by, essentially, dimensional analysis.</p>
<p>Now we consider some ‘typical values’ for the independent dimensions of the system (mass, length, time, temperature, that sort of thing) which can be used to rescale the standard units. We rescale all lengths by the depth of the fluid, <span class="math inline">\(d\)</span> (e.g. mantle thickness or depth of fluid in a lab tank), time according to the characteristic time for diffusion of heat, and temperature by the temperature difference across the depth of the layer. Obviously these choices are dependent on the problem in question but this exercise is a common one in fluid dynamics and provides a useful first step in the assault on the problem</p>
<figure>
<embed src="Diagrams/layer.pdf" style="width:60mm" /><figcaption aria-hidden="true">Consider the fluid motions in a layer of arbitrary depth, <span class="math inline">\(d\)</span>. The fluid is assumed to have constant properties such as viscosity, thermal expansivity, thermal diffusivity. Small fluctuations in density due to temperature driven flow. Additional heat is carried (advected) by the flow from the hot boundary to the cool one whenever the fluid is moving.</figcaption>
</figure>
<p>Various scalings result, with the new variables indicated using a prime (<span class="math inline">\(&#39;\)</span>). <span class="math display">\[\begin{array}{llll}
                x = d.x&#39; &amp; \partial / \partial x =  (1/d) \partial / \partial x&#39; &amp; \nabla = (1/d) \nabla &#39;  \\
                t = (d^2/\kappa) t&#39;  &amp;  \partial / \partial t = (\kappa/d^2) \partial / \partial t&#39; &amp; \\
                T = \Delta T T&#39; &amp; &amp; \\
                v = (\kappa / d) v&#39; &amp;&amp; \\
                p= p_0 + (\eta \kappa / d^2) p&#39;
            \end{array}\]</span></p>
<p>where <span class="math display">\[\nabla p_0 = - g \rho_0\]</span></p>
<p>Substituting for all the existing terms in the Navier-Stokes equation (<a href="#eq:navstokes" data-reference-type="ref" data-reference="eq:navstokes">[eq:navstokes]</a>) using the equation of state for thermally induced variation in density (<a href="#eq:state" data-reference-type="ref" data-reference="eq:state">[eq:state]</a>) gives: <span class="math display">\[\frac{\rho_0 \kappa}{d^2} \frac{D}{Dt&#39;} \left( \frac{\kappa}{d} \mathbf{v}&#39; \right) =
                \frac{\eta}{d^2} \acute{\nabla}^2 \left( \frac{\kappa}{d} \mathbf{v}&#39; \right)
                - \frac{\eta \kappa}{d^3}  \acute{\nabla} p&#39; + g \rho_0 \alpha \Delta T T&#39; \hat{\mathbf{z}}\]</span></p>
<p>Collecting everything together gives <span class="math display">\[\frac{\rho_0 \kappa^2}{d^3} \frac{D\mathbf{v}&#39;}{Dt&#39;}  =
                \frac{\eta \kappa}{d^3} \acute{\nabla}^2  \mathbf{v}&#39; 
                - \frac{\eta \kappa}{d^3}  \acute{\nabla} p&#39; + g \rho_0 \alpha \Delta T T&#39; \hat{\mathbf{z}}\]</span></p>
<p>Divide throughout by <span class="math inline">\(\eta \kappa / d^3\)</span> gives <span class="math display">\[\begin{aligned}
                \frac{\rho \kappa}{\eta} \frac{D\mathbf{v}&#39;}{Dt&#39;}  &amp; =
                     \acute{\nabla}^2  \mathbf{v}&#39;  -  \acute{\nabla} p&#39; + 
                     \frac{g \rho_0 \alpha \Delta T d^3}{\kappa \eta} T&#39; \hat{\mathbf{z}} \nonumber \\
            \intertext{or}   
                \frac{1}{{\rm Pr}} \frac{D\mathbf{v}&#39;}{Dt&#39;} &amp; =
                    \acute{\nabla}^2  \mathbf{v}&#39;  -  \acute{\nabla} p&#39; + {\rm Ra} T&#39; \hat{\mathbf{z}}
            \end{aligned}\]</span></p>
<p><span class="math inline">\(\rm Pr\)</span> is known as the Prandtl number, and <span class="math inline">\(\rm Ra\)</span> is known as the Rayleigh number; both are non-dimensional numbers. By choosing to scale the equations (and this is still perfectly general as we haven’t forced any particular choice of scaling yet), we have condensed the different physical variable quantities into just two numbers. The benefit of this procedure is that it tells us how different quantities trade off against one another. For example, we see that if the density doubles, and the viscosity doubles, then the solution should remain unchanged.</p>
<p>In fact, the main purpose of this particular exercise is about to be revealed. The value of mantle viscosity is believed to lie somewhere between <span class="math inline">\(10^{19}\)</span> and <span class="math inline">\(10^{23}\)</span> <span class="math inline">\({\rm Pa . s}\)</span>, the thermal diffusivity is around <span class="math inline">\(10^{-6}{\rm m}^2{\rm s}^{-1}\)</span>, and density around <span class="math inline">\(3300 {\rm kg . m}^{-3}\)</span>. This gives a Prandtl number greater than <span class="math inline">\(10^{20}\)</span>. Typical estimates for the Rayleigh number are between <span class="math inline">\(10^6\)</span> and <span class="math inline">\(10^8\)</span> depending on the supposed depth of convection, and the uncertain mantle viscosity.</p>
<p>Obviously, the time-dependent term can be neglected for the mantle, since it is at least twenty orders of magnitude smaller than other terms in the equations. The benefit of this is that the nasty advection term for momentum is eliminated – flow in the mantle is at the opposite extreme to turbulent flow. The disadvantage is that the equations now become non-local: changes in the stress field are propogated instantly from point to point which can make the equations a lot harder to solve. This can be counter-intuitive but the consequences are important when considering the dynamic response of the Earth to changes in, for example, plate configurations.</p>
<p>Incidentally, a third, independent dimensionless number can be derived for the thermally driven flow equations. This is the Nusselt number <span class="math display">\[{\rm Nu} = \frac{Q}{k\Delta T}\]</span></p>
<p>and is the ratio of actual heat transported by fluid motions in the layer compared to that transported conductively in the absence of fluid motion.</p>
<p>All other dimensionless quantities for this system can be expressed as some combination of the Nusselt, Rayleigh and Prandtl numbers. The Prandtl number is a property of the fluid itself – typical values are: air, <span class="math inline">\(\sim\)</span>1; water, <span class="math inline">\(\sim\)</span> 6; non-conducting fluids <span class="math inline">\(10^3\)</span> or more; liquid metal, <span class="math inline">\(\sim\)</span>0.1. Rayleigh number and Nusselt number are both properties of the chosen geometry.</p>
<h2 id="stream-function-vorticity-notation">Stream function / Vorticity Notation</h2>
<p>For incompressible flows in two dimensions it can be very convenient to work with the stream-function – a scalar quantity which defines the flow everywhere. Another quantity much beloved of fluid dynamicists is the vorticity. Although the application of such quantities to deformation of the solid planets is actually quite limited, it is still useful for exploring the basic fluid dynamics of the large scale flow.</p>
<h3 id="streamfunction">Streamfunction</h3>
<p>The stream function is the scalar quantity,<span class="math inline">\(\psi\)</span>, which satisfies <span class="math display">\[v_1 = -\frac{\partial \psi}{\partial x_2} \mbox{\hspace{1cm}}
                        v_2 = \frac{\partial \psi}{\partial x_1}
                    \label{eq:strmfn}\]</span> so that, automatically, <span class="math display">\[\frac{\partial v_1}{\partial x_1} + \frac{\partial v_2}{\partial x_2} = 0\]</span></p>
<p>Importantly, computing the following <span class="math display">\[(\mathbf{v} \cdot \nabla) \psi = 
                        v_1 \frac{\partial \psi}{\partial x_1} +    
                        v_2 \frac{\partial \psi}{\partial x_2} = 
                        \frac{\partial \psi}{\partial x_2} \frac{\partial \psi}{\partial x_1} -
                        \frac{\partial \psi}{\partial x_1} \frac{\partial \psi}{\partial x_2} = 0\]</span> tells us that <span class="math inline">\(\psi\)</span> does not change due to advection – in other words, contours of constant <span class="math inline">\(\psi\)</span> are streamlines of the fluid.</p>
<p>Provided we limit ourselves to the xy plane, it is possible to think of equation (<a href="#eq:strmfn" data-reference-type="ref" data-reference="eq:strmfn">[eq:strmfn]</a>) as <span class="math display">\[\mathbf{v} = \nabla \times (\psi \hat{\mathbf{k}})\]</span></p>
<p>This form can be used to write down the2D axisymetric version of equation (<a href="#eq:strmfn" data-reference-type="ref" data-reference="eq:strmfn">[eq:strmfn]</a>) at once <span class="math display">\[\begin{aligned}
                    u_r = -\frac{1}{r}\frac{\partial \psi}{\partial \theta} &amp; &amp; 
                    u_\theta = \frac{\partial \psi}{\partial r}
            \end{aligned}\]</span> which automatically satisfies the incompressibility condition in plane polar coordinates <span class="math display">\[\frac{1}{r}\frac{\partial}{\partial r}(ru_r) + \frac{1}{r}\frac{\partial u_\theta}{\partial \theta} = 0\]</span></p>
<h3 id="vorticity">Vorticity</h3>
<p>Vorticity is defined by <span class="math display">\[\boldsymbol{\omega} = \nabla \times \mathbf{v}\]</span></p>
<p>In 2D, the vorticity can be regarded as a scalar as it has only one component which lies out of the plane of the flow.</p>
<p><span class="math display">\[\omega = \frac{\partial v_2}{\partial x_1} -
         \frac{\partial v_1}{\partial x_2}\]</span> which is also exactly equal to twice the local measure of the spin in the fluid. Local here means that it applies to an infinitessimal region around the sample point but not to the fluid as a whole.</p>
<p>This concept is most useful in the context of invicid flow where vorticity is conserved within the bulk of the fluid provided the fluid is subject to only conservative forces – that is ones which can be described as the gradient of a single-valued potential.</p>
<p>In the context of viscous flow, the viscous effects acts cause diffusion of vorticity, and in our context, the fact that buoyancy forces result from to (irreversible) heat transport means that vorticity has sources. Taking the curl of the Navier-Stokes equation, and substituting for the vorticity where possible gives <span class="math display">\[\frac{1}{\rm Pr} \left( \frac{D \boldsymbol{\omega}}{D t} - 
                (\boldsymbol{\omega} \cdot \nabla) \mathbf{v} \right) = 
                    \eta \nabla ^2 \boldsymbol{\omega} + {\rm Ra} \frac{\partial T}{\partial x_1}\]</span> The pressure drops out because <span class="math inline">\(\nabla \times \nabla P = 0 \mbox{\hspace{0.5cm}} \forall P\)</span>.</p>
<h3 id="stream-function-vorticity-formulation">Stream-function, Vorticity formulation</h3>
<p>In the context of highly viscous fluids in 2D, the vorticity equation is <span class="math display">\[\nabla ^2 \omega = - Ra \frac{\partial T}{\partial x_1}
                \label{eq:vorteqn}\]</span> and, by considering the curl of <span class="math inline">\((-\partial \psi / \partial x_2, \partial \psi / \partial x_1, 0)\)</span> the stream function can be written <span class="math display">\[\nabla ^2 \psi = \omega
                \label{eq:psivort}\]</span></p>
<p>This form is useful from a computational point of view because it is relatively easy to solve the Laplacian, and the code can be reused for each application of the operator. The Laplacian is also used for thermal diffusion – one subroutine for three different bits of physics which is elegant in itself if nothing else.</p>
<h3 id="biharmonic-equation">Biharmonic equation</h3>
<p>The biharmonic operator is defined as <span class="math display">\[\nabla^4 \equiv \nabla^2 ( \nabla ^2) \equiv 
                    \left( \frac{\partial ^4}{\partial x_1^4} + 
                    \frac{\partial ^2}{\partial x_1^2} \frac{\partial ^2}{\partial x_2^2} +
                    \frac{\partial ^4}{\partial x_2^4} \right)\]</span> The latter form being the representation in Cartesian coordinates.</p>
<p>Using this form, it is easy to show that equations (<a href="#eq:vorteqn" data-reference-type="ref" data-reference="eq:vorteqn">[eq:vorteqn]</a>) and (<a href="#eq:psivort" data-reference-type="ref" data-reference="eq:psivort">[eq:psivort]</a>) can be combined to give <span class="math display">\[\nabla^4 \psi = -{\rm Ra} \frac{\partial T}{\partial x_1}
                \label{eq:biharm}\]</span></p>
<h2 id="poloidaltoroidal-velocity-decomposition">Poloidal/Toroidal velocity decomposition</h2>
<p>The stream-function / vorticity form we have just used is a simplification of the more general case of the poloidal / toroidal velocity decomposition which turns out to be quite useful to understand the balance of different contributions to the governing equation.</p>
<p>We can make a Helmholtz decomposition of the velocity vector field:</p>
<p><span class="math display">\[\mathbf{u} = \nabla \phi + \nabla \times \mathbf{A}\]</span></p>
<p>Then for an incompressible flow, since <span class="math inline">\(\nabla \cdot \mathbf{u} = 0\)</span>, <span class="math display">\[\mathbf{u} = \nabla \times \mathbf{A} \label{eq:curlA}\]</span></p>
<p>Now suppose there is some direction (<span class="math inline">\(\hat{\mathbf{z}}\)</span>) which we expect to be physically favoured in the solutions, we can rewrite <a href="#eq:curlA" data-reference-type="ref" data-reference="eq:curlA">[eq:curlA]</a> as</p>
<p><span class="math display">\[\mathbf{u} = \textcolor[rgb]{0.7,0.0,0.0}{\nabla \times(\Psi \hat{\mathbf{z}})} + 
                 \textcolor[rgb]{0.0,0.0,0.7}{ \nabla \times\nabla \times(\Phi \hat{\mathbf{z}})}
    \label{eq:poltor}\]</span></p>
<p>Where the first term on the right is the <span style="color: 0.7,0.0,0.0">Toroidal</span> part of the flow, and the second term is the <span style="color: 0.0,0.0,0.7"> Poloidal</span> part. Why is this useful ? Let’s substitute (<a href="#eq:poltor" data-reference-type="ref" data-reference="eq:poltor">[eq:poltor]</a>) into the Stokes’ equation for a constant viscosity fluid <span class="math display">\[\eta \nabla^2 \mathbf{u} - \nabla p = g \rho \hat{\mathbf{z}} 
    \label{eq:cvstokes}\]</span> where <span class="math inline">\(\hat{\mathbf{z}}\)</span> is the vertical unit vector (defined by the direction of gravity) and is clearly the one identifiable special direction, then equate coefficients in the <span class="math inline">\(\hat{\mathbf{z}}\)</span> direction, and using the following results:</p>
<p><span class="math display">\[\hat{\mathbf{z}} \cdot \nabla \times \nabla^2 \mathbf{u} =
        - \nabla^2 \nabla_h^2\Psi\]</span></p>
<p><span class="math display">\[\hat{\mathbf{z}} \cdot \nabla \times \nabla \times \nabla^2 \mathbf{u} = 
          \nabla^2 \nabla^2 \nabla_h^2\Phi\]</span></p>
<p>where <span class="math display">\[\nabla_h = \left( \frac{\partial}{\partial x}, \frac{\partial}{\partial y}, 0 \right)\]</span> is a gradient operator limited to the plane perpendicular to the special direction, <span class="math inline">\(\hat{\mathbf{z}}\)</span>.</p>
<p>If we first take the curl of (<a href="#eq:cvstokes" data-reference-type="ref" data-reference="eq:cvstokes">[eq:cvstokes]</a>), and look at the <span class="math inline">\(\hat{\mathbf{z}}\)</span> direction, <span class="math display">\[\hat{\mathbf{z}} \cdot \eta \nabla \times \nabla^2 \mathbf{u} = 
        -\eta \nabla^2 \nabla_h^2\Psi = 
        \hat{\mathbf{z}} \cdot \left( g \nabla \times \left( \rho \hat{\mathbf{z}}\right)\right) = 0\]</span> we see that there is no contribution of the toroidal velocity field to the force balance. This balance occurs entirely through the poloidal part of the velocity field. If we take the curl twice and, once again, look at the <span class="math inline">\(\hat{\mathbf{z}}\)</span> direction:</p>
<p><span class="math display">\[\hat{\mathbf{z}} \cdot \eta \nabla \times \nabla \times \nabla^2 \mathbf{u} = 
        \eta \nabla^2 \nabla^2 \nabla_h^2 \Phi = 
        \hat{\mathbf{z}} \cdot g \nabla \times \nabla \times \left( \rho \hat{\mathbf{z}}\right) = 
         \nabla_h^2 (\rho g)\]</span></p>
<p>Which is the 3D equivalent of the biharmonic equation that we derived above.</p>
<p>Note: if the viscosity varies in the <span class="math inline">\(\hat{\mathbf{z}}\)</span> direction, then this same decoupling still applies: bouyancy forces do not drive any toroidal flow. Lateral variations in viscosity (perpendicular to <span class="math inline">\(\hat{\mathbf{z}}\)</span>) couple the buoyancy to toroidal motion. This result is general in that it applies to the spherical geometry equally well assuming the radial direction (of gravity) to be special.</p>
<h1 id="thermal-convection">Thermal Convection</h1>
<p>Thermal convection describes the a process in which a fluid organizes itself into a structured flow pattern on a macroscopic scale to transport energy. Convection may be mechanically driven by stirring, but more commonly we refer to <em>natural convection</em> in which buoyancy due to a source of heat (and/or compositional variation) induces flow which transports and dissipates this anomalous buoyancy.</p>
<p>The Earth’s interior, on a geological timescale is a highly viscous fluid which is heated from below by heat escaping from the core, and internally by the decay of radioactive elements. In this respect</p>
<p>Description - what is involved ... Goal is to understand finite amplitude convection with complicated rheology and realistic initial, boundary conditions.</p>
<h2 id="critical-rayleigh-number-for-a-layer">Critical Rayleigh Number for a layer</h2>
<p>Does convection always occur in a layer heated from below ? In principle this would always provide a way to transport additional heat, but how much work would convection have to do in order to transport this extra heat ? One way to determine the answer is to consider small disturbances to a layer with otherwise uniform temperature and see under what conditions the perturbations grow (presumably into fully developed convection). This approach allows us to make <span><em>linear</em></span> approximations to the otherwise non-linear equations by dropping the small, high order non-linear terms.</p>
<p>We solve the incompressible flow equations (stream function form, <a href="#eq:biharm" data-reference-type="ref" data-reference="eq:biharm">[eq:biharm]</a>) and energy conservation equation in stream function form: <span class="math display">\[\frac{\partial T}{\partial t} +
                 \left[     -\frac{\partial \psi}{\partial x_2}\frac{\partial T}{\partial x_1}
                            +\frac  {\partial \psi}{\partial x_1}\frac{\partial T}{\partial x_2} \right]
                        = \nabla^2 T\]</span> By substituting throughout for a temperature which is a conductive profile with a small amplitude disturbance, <span class="math inline">\(\theta \ll 1\)</span> <span class="math display">\[T = 1- x_2 + \theta\]</span> Remember that the equations are non-dimensional so that the layer depth is one, and the temperature drop is one.</p>
<p>The advection term <span class="math display">\[-\frac{\partial \psi}{\partial x_2}\frac{\partial T}{\partial x_1}
                            +\frac  {\partial \psi}{\partial x_1}\frac{\partial T}{\partial x_2} \rightarrow
                    -\frac{\partial \psi}{\partial x_2}\frac{\partial \theta}{\partial x_1} -\frac{\partial \psi}{\partial x_1}
                    +\frac  {\partial \theta}{\partial x_2}\frac{\partial \psi}{\partial x_1}\]</span> is dominated by the <span class="math inline">\(\partial \psi / \partial x_1\)</span> since all others are the product of small terms. (Since we also know that <span class="math inline">\(\psi \sim \theta\)</span> from equation (<a href="#eq:biharm" data-reference-type="ref" data-reference="eq:biharm">[eq:biharm]</a>)). Therefore the energy conservation equation becomes <span class="math display">\[\frac{\partial \theta}{\partial t} - \frac{\partial \psi}{\partial x_1} = \nabla^2 \theta\]</span> which is linear.</p>
<p>Boundary conditions for this problem are zero normal velocity on <span class="math inline">\(x_2 = 0,1\)</span> which implies <span class="math inline">\(\psi=0\)</span> at these boundaries. The form of the perturbation is such that <span class="math inline">\(\theta =0\)</span> on <span class="math inline">\(x_2 = 0,1\)</span>, and we allow free slip along these boundaries such that <span class="math display">\[\sigma_{12} = \frac{\partial v_1}{\partial x_2} + \frac{\partial v_2}{\partial x_1} =0\]</span> when <span class="math inline">\(x_2 = 0,1\)</span> which implies <span class="math inline">\(\nabla^2 \psi =0\)</span> there.</p>
<p>Now introduce small harmonic perturbations to the driving terms and assuming a similar (i.e. harmonic) response in the flow. This takes the form <span class="math display">\[\begin{split}
                    \theta &amp;= \Theta(x_2) \exp(\sigma t) \sin kx_1 \\
                    \psi &amp;= \Psi(x_2) \exp(\sigma t) \cos kx_1
                \end{split}\]</span> So that we can now separate variables. <span class="math inline">\(\sigma\)</span> is unknown, however, if <span class="math inline">\(\sigma &lt; 0\)</span> then the perturbations will decay, whereas if <span class="math inline">\(\sigma &gt; 0\)</span> they will grow.</p>
<figure>
<embed src="Diagrams/crit_ra.pdf" style="width:70mm" /><figcaption aria-hidden="true">Critical Rayleigh Number determination. A plot of growth rates for harmonic perturbations as a function of wavenumber for different <span class="math inline">\({\rm Ra}\)</span>. The critical value occurs when the maximum of the curve just touches the horizontal axis at zero.</figcaption>
</figure>
<p>Substituting for the perturbations into the biharmonic equation and the linearized energy conservation equation gives <span class="math display">\[\left(\frac{d^2}{d{x_2}^2} -k^2 \right)^2 \Psi = -{\rm Ra} k \Theta 
                \label{eq:psitheta1}\]</span> and <span class="math display">\[\sigma \Theta + k \Psi =    \left(\frac{d^2}{d{x_2}^2} -k^2 \right) \Theta\]</span></p>
<p>Here we have shown and used the fact that <span class="math display">\[\nabla^2 \equiv \left(\frac{\partial^2}{\partial {x_2}^2} -k^2 \right)
                \label{eq:psitheta2}\]</span> when a function is expanded in the form <span class="math inline">\(\phi(x,z) = \Phi(z).\sin kx\)</span> – more generally, this is the fourier transform of the Laplacian operator.</p>
<p>Eliminating <span class="math inline">\(\Psi\)</span> between (<a href="#eq:psitheta1" data-reference-type="ref" data-reference="eq:psitheta1">[eq:psitheta1]</a>) and (<a href="#eq:psitheta2" data-reference-type="ref" data-reference="eq:psitheta2">[eq:psitheta2]</a>) gives <span class="math display">\[\sigma \left(\frac{d^2}{d {x_2}^2 } - k^2 \right)^2 -{\rm Ra} k^2 \Theta = 
                \left(\frac{d^2}{d {x_2}^2} -k^2 \right)^3 \Theta\]</span> This has a solution <span class="math display">\[\Theta = \Theta_0 \sin \pi z\]</span> which satisfies all the stated boundary conditions and implies <span class="math display">\[\sigma =  \frac{k^2 {\rm Ra}}{(\pi^2 + k^2)^2} -(\pi^2 + k^2)\]</span> a real function of <span class="math inline">\(k\)</span> and <span class="math inline">\(\rm Ra\)</span>.</p>
<p>For a given wavenumber, what is the lowest value of <span class="math inline">\(\rm Ra\)</span> for which perturbations at that wavenumber will grow ? <span class="math display">\[= \frac{(\pi^2 + k^2)^3}{k^2}\]</span> The absolute minimum value of <span class="math inline">\({\rm Ra}\)</span> which produces growing perturbations is found by differentiating <span class="math inline">\({\rm Ra_0}\)</span> with respect to <span class="math inline">\(k\)</span> and setting equal to zero to find the extremum. <span class="math display">\[{\rm Ra_c} = \frac{27}{4} \pi^4 = 657.51\]</span> for a wavenumber of <span class="math display">\[k = \frac{\pi}{2^{1/2}} = 2.22\]</span> corresponding to a wavelength of 2.828 times the depth of the layer.</p>
<p>Different boundary conditions produce different values of the critical Rayleigh number. If no-slip conditions are used, for example, then the <span class="math inline">\(\Theta\)</span> solution applied above does not satisfy the boundary conditions. In general, the critical Rayleigh number lies between about 100 and 3000.</p>
<h2 id="boundary-layer-theory-boundary-rayleigh-number">Boundary layer theory, Boundary Rayleigh Number</h2>
<p>Having determined the conditions under which convection will develop, we next consider what can be calculated about fully developed convection – i.e. when perturbations grow well beyond the linearization used to study the onset of instability.</p>
<p>Let’s consider fully developed convection with high Rayleigh number. From observations of real fluids in laboratory situations, it is well known how this looks. High Rayleigh number convection is dominated by the advection of heat. Diffusion is too slow to carry heat far into the fluid before the buoyancy anomaly becomes unstable. This leads to thin, horizontal “boundary layers” where diffusive heat transfer into and out of the fluid occurs. These are separated by approximately isothermal regions in the fluid interior. The horizontal boundary layers are connected by vertical boundary layers which take the form of sheets or cylindrical plumes depending on a number of things including the Rayleigh number. For the time being we consider only the sheet like downwellings since that allows us to continue working in 2D.</p>
<figure>
<embed src="Diagrams/blt.pdf" id="fig:blt1" style="width:100mm" /><figcaption aria-hidden="true"> <span id="fig:blt1" label="fig:blt1">[fig:blt1]</span> Boundary Layer Theory in its simplest form</figcaption>
</figure>
<p>Boundary layer analysis is a highly sophisticated field, and is used in a broad range of situations where differences in scales between different physical effects produce narrow accommodation zones where the ‘weaker’ term dominates (e.g viscosity in ‘invicid’ flow around an obstacle).</p>
<p>Here we first make a wild stab at an approximate theory describing the heat flow from a layer with a given Rayleigh number. The convective flow is shown in Figure <a href="#fig:blt1" data-reference-type="ref" data-reference="fig:blt1">1</a> together with our rough sketch of what actually happens.</p>
<p>Assuming the simplified flow pattern of the sketch, steady state, and replacing all derivatives by crude differences we obtain (using a vorticity form) <span class="math display">\[\kappa \nabla^2 T = (\mathbf{v} \cdot \nabla) T
                    \mbox{\hspace{1cm}} \longrightarrow \mbox{\hspace{1cm}} 
                \frac{v \Delta T}{d} \sim \frac{\Delta T \kappa}{\delta^2}\]</span> and <span class="math display">\[\nabla^2 \omega = \frac{g \rho \alpha}{\eta} \frac{\partial T}{\partial x}
                    \mbox{\hspace{1cm}} \longrightarrow \mbox{\hspace{1cm}} 
                \frac{\omega}{\delta ^2}    \sim  \frac{g \rho \alpha \Delta T}{\eta \delta}\]</span> where <span class="math inline">\(\omega\sim v / d\)</span> from the local rotation interpretation of vorticity and the approximate rigid-body rotation of the core of the convection cell, and <span class="math inline">\(v/d \sim \kappa / \delta^2\)</span>.</p>
<p>This gives <span class="math display">\[\begin{aligned}
            \frac{\delta}{d} &amp; \sim {\rm Ra}^{-1/3} \\
            v &amp; \sim \frac{\kappa}{d} {\rm Ra}^{2/3} 
        \end{aligned}\]</span></p>
<p>This theory balances diffusion of vorticity and temperature across and out of the boundary layer with advection of each quantity along the boundary layer to maintain a steady state.</p>
<p>The Nusselt number is the ratio of advected heat transport to that purely conducted in the absence of fluid motion, or, using the above approximations, <span class="math display">\[\begin{split}   
                {\rm Nu}    &amp; \sim \frac{\rho C_p v \Delta T \delta}{(k \Delta T/d)d} \\
                                &amp; \sim {\rm Ra}^{1/3}
            \end{split}\]</span></p>
<p>This latter result being observed in experiments to be in reasonably good agreement with observation.</p>
<p>If we define a boundary Rayleigh number <span class="math display">\[{\rm Ra_b} = \frac{g \rho \alpha \Delta T \delta^3}{\kappa \eta}\]</span> then the expression for <span class="math inline">\(\delta\)</span> gives <span class="math display">\[{\rm Ra_b} \sim 1\]</span> so the boundary layer does not become more or less stable with increasing Rayleigh number (this is not universal – for internal heating the boundary layer becomes less stable at higher Rayleigh number).</p>
<figure>
<embed src="Diagrams/blt2.pdf" style="width:100mm" /><figcaption aria-hidden="true">Boundary Layer Theory which accounts for the thickness variations along the boundary layer as it matures.</figcaption>
</figure>
<p>Another wrinkle can be added to the boundary layer theory by trying to account for the variation in the boundary layer thickness as it moves along the horizontal boundary. This refinement in the theory can account for the form of this thickness, the potential energy change in rising or sinking plumes, and the aspect ratio of the convection (width to height of convection roll) by maximizing Nusselt number as a function of aspect ratio.</p>
<p>Consider the boundary layer to be very thin above the upwelling plume (left side). As it moves to the right, it cools and the depth to any particular isotherm increases (this is clearly seen in the simulation). This can be treated exactly like a one dimensional problem if we work in the Lagrangian frame of reference attached to the boundary layer. That is, take the 1D half-space cooling model and replace the time with <span class="math inline">\(x_1/v\)</span> (cf. the advection equation in which time and velocity / lengths are mixed).</p>
<p>The standard solution is as follows. Assume a half-space at an intial temperature everywhere of <span class="math inline">\(T_0\)</span> to which a boundary condition, <span class="math inline">\(T=T_s\)</span> is applied at <span class="math inline">\(t=0,x_2=0\)</span>.</p>
<p>We solve for <span class="math inline">\(T(x_2,t)\)</span> by first making a substitution, <span class="math display">\[\theta = \frac{T-T_0}{T_s-T_0}\]</span> which is a dimensionless temperature, into the standard diffusion equation to obtain <span class="math display">\[\frac{\partial \theta(x_2,t)}{\partial t} = \kappa \frac{\partial ^2 \theta(x_2,t)}{\partial {x_2}^2}
            \label{eq:difftheta}\]</span></p>
<p>The boundary conditions on <span class="math inline">\(\theta\)</span> are simple: <span class="math display">\[\begin{aligned}
                &amp; \theta(x_2,0) = 0 \\
                &amp; \theta(0,t) = 1   \\
                &amp; \theta(\infty,0) = 0      
            \end{aligned}\]</span></p>
<figure>
<embed src="Diagrams/CoolingHalfSpaceSolutions1.pdf" /><figcaption aria-hidden="true">Cooling half-space calculation</figcaption>
</figure>
<p>In place of <span class="math inline">\(t,x_2\)</span>, we use the similarity transformation, <span class="math display">\[\eta = \frac{x_2}{2\sqrt{\kappa t}}\]</span> which is found (more or less) intuitively. Now we need to substitute <span class="math display">\[\begin{aligned}
            \frac{\partial \theta}{\partial t} &amp; = -\frac{d \theta}{d\eta}(\eta/2t) \\
            \frac{\partial^2 \theta}{\partial {x_2}^2} &amp; = \frac{1}{4\kappa t}\frac{d^2 \theta}{d \eta^2}
        \end{aligned}\]</span> to transform (<a href="#eq:difftheta" data-reference-type="ref" data-reference="eq:difftheta">[eq:difftheta]</a>) into <span class="math display">\[-\eta \frac{d \theta}{d\eta} = \frac{1}{2} \frac{d^2 \theta}{d \eta^2}
            \label{eq:diffode}\]</span></p>
<p>Boundary conditions transform to give <span class="math display">\[\begin{aligned}
                &amp; \theta(\eta=\infty) = 0   \\
                &amp; \theta(\eta=0) = 1    
            \end{aligned}\]</span></p>
<p>Write <span class="math inline">\(\phi = d\theta / d\eta\)</span> (for convenience only) to rewrite (<a href="#eq:diffode" data-reference-type="ref" data-reference="eq:diffode">[eq:diffode]</a>) as <span class="math display">\[\begin{aligned}
                -\eta \phi &amp;= \frac{1}{2} \frac{d \phi}{d \eta}     \\
            \intertext{or}
                -\eta d\eta &amp;= \frac{1}{2} \frac{d\phi}{\phi}   
            \end{aligned}\]</span></p>
<p>This is a standard integral with solution <span class="math display">\[\begin{aligned}
                &amp; -\eta^2 = \log_e \phi -\log_e c_1 \\
            \intertext{such that}
                &amp; \phi = c_1 \exp(-\eta^2) = \frac{d\theta}{d\eta}
            \end{aligned}\]</span></p>
<p>This latter form is then integrated to give the solution: <span class="math display">\[\theta = c_1 \int_0^\eta    \exp(-{\eta&#39;}^2) d\eta&#39; +1\]</span> Boundary conditions give <span class="math display">\[\theta = 1- \frac{2}{\sqrt{\pi}} \int_0^\eta\exp(-{\eta&#39;}^2) d\eta&#39;\]</span></p>
<p>Which is the definition of the complementary error function (<span class="math inline">\(\mbox{\rm erfc}(\eta)\)</span>).</p>
<p>Undoing the remaining substitutions gives <span class="math display">\[\frac{T-T_0}{T_s-T_0}   = \mbox{\rm erfc}\left(   \frac{x_2}{2\sqrt{\kappa t}} \right)\]</span></p>
<p>In our original context of the cooling boundary layer, then, the <span class="math inline">\(T_    s\)</span> is the surface temperature, <span class="math inline">\(T_0\)</span> is the interior temperature of the convection cell (<span class="math inline">\(\Delta T /2\)</span>) and <span class="math inline">\(t \leftarrow x_1/v\)</span>. The thickness of the boundary layer is found by assuming it is defined by a characteristic isotherm (doesn’t much matter which). The progression of this isotherm is <span class="math display">\[\delta \propto \sqrt{\kappa t}\]</span> or, in the Eulerian frame <span class="math display">\[\delta \propto \sqrt{\kappa x_1 / v}\]</span></p>
<h2 id="internal-heating">Internal Heating</h2>
<p>The definition of the Rayleigh number when the layer is significantly internally heated is <span class="math display">\[{\rm Ra} = \frac{g \rho^2 \alpha H d^5}{\eta \kappa k}\]</span> where <span class="math inline">\(H\)</span> is the rate of internal heat generation per unit mass.</p>
<p>The rigorous definition of the Nusselt number is the heat flow through the upper surface divided by the average basal temperature. This allows a Nusselt number to be calculated for internally heated convection where the basal temperature is not known <span><em>a priori</em></span></p>
<p>Internally heated convection is a problem to simulate in the lab, directly, but the same effect is achieved by reducing the temperature of the upper surface as a function of time.</p>
<h2 id="when-viscosity-is-not-constant">When Viscosity is Not Constant</h2>
<p>When viscosity is not constant, the equations are considerably complicated. It is no longer possible to form a pure biharmonic equation since <span class="math inline">\(\eta(x,z)\)</span> cannot be taken outside the differential operators. Nor can stream-function / vorticity formulations be used directly for the same reasons. Spectral methods — the decomposition of the problem into a sum of independent problems in the wavenumber domain — is no longer simple since the individual problems are coupled, not independent.</p>
<p>The Rayleigh number is no longer uniquely defined for the system since the viscosity to which it refers must take some suitable average over the layer — the nature of this average depends on the circumstances.</p>
<p>The form of convection changes since boundary layers at the top and bottom of the system (cold v hot) are no longer symmetric with each other.</p>
<p>The convecting system gains another control parameter which is a measure of the viscosity contrast as a function of temperature.</p>
<h1 id="application-to-planets">Application to Planets</h1>
<p>The application of realistic convection models to the Earth and other planets — particularly Venus.</p>
<p>The simplest computational and boundary layer solutions to the Stokes’ convection equations made the simplifying assumption that the viscosity was constant. Despite the experimental evidence which suggests viscosity variations should dominate in the Earth, agreement with some important observations was remarkably good.</p>
<p>The simulations were not able to produce plate-like motions at the surface (instead producing smoothly distributed deformation) but the average velocity, the heat flow and the observed pattern of subsidence of the ocean floor were well matched.</p>
<h2 id="mantle-rheology">Mantle Rheology</h2>
<p>Experimental determination of the rheology of mantle materials gives <span class="math display">\[\dot{\epsilon} \propto \sigma^n d^{-m} \exp\left( -\frac{E+PV}{RT} \right)\]</span> where <span class="math inline">\(\sigma\)</span> is a stress, <span class="math inline">\(d\)</span> is grain size, <span class="math inline">\(E\)</span> is an activation energy, <span class="math inline">\(V\)</span> is an activation volume, and <span class="math inline">\(T\)</span> is absolute temperature. (<span class="math inline">\(R\)</span> is the universal gas constant).</p>
<p>This translates to a viscosity <span class="math display">\[\eta \propto \sigma^{1-n} d^m exp\left( \frac{E+PV}{RT} \right)\]</span></p>
<p>In the mantle two forms of creep are possible, dislocation creep with <span class="math inline">\(n ~ 3.0\)</span>, <span class="math inline">\(m~0\)</span>, <span class="math inline">\(E ~ 430-540 KJ/mol\)</span>, <span class="math inline">\(V ~ 10 - 20 cm^3/mol\)</span>; and diffusion creep with <span class="math inline">\(n ~ 1.0\)</span>, <span class="math inline">\(m~2.5\)</span>, <span class="math inline">\(E ~ 240-300 KJ/mol\)</span>, <span class="math inline">\(V ~ 5-6 cm^3/mol\)</span>. This is for olivine — other minerals will produce different results, of course.</p>
<h2 id="convection-with-temperature-dependent-viscosity">Convection with Temperature Dependent Viscosity</h2>
<p>More sophisticated models included the effect of temperature dependent viscosity as a step towards more realistic simulations. In fact, the opposite was observed: convection with temperature dependent viscosity is a much worse description of the oceanic lithosphere than constant viscosity convection. It may, however, describe Venus rather well.</p>
<p>Theoretical studies of the asymptotic limit of convection in which the viscosity variation becomes very large (comparable to values determined for mantle rocks in laboratory experiments) find that the upper surface becomes entirely stagnant with little or no observable motion. Vigorous convection continues underneath the stagnant layer with very little surface manifestation.</p>
<p>This theoretical work demonstrates that the numerical simulations are producing correct results, and suggests that we should look for physics beyond pure viscous flow in explaining plate motions.</p>
<h2 id="non-linear-viscosity-and-brittle-effects">Non-linear Viscosity and Brittle Effects</h2>
<p>Realistic rheological laws show the viscosity may depend upon stress. This makes the problem non-linear since the stress clearly depends upon viscosity. In order to obtain a solution it is necessary to iterate velocity and viscosity until they no longer change.</p>
<p>The obvious association of plate boundaries with earthquake activity suggests that relevant effects are to be found in the brittle nature of the cold plates. Brittle materials have a finite strength and if they are stressed beyond that point they break. This is a familiar enough property of everyday materials, but rocks in the lithosphere are non-uniform, subject to great confining pressures and high temperatures, and they deform over extremely long periods of time. This makes it difficult to know how to apply laboratory results for rock breakage experiments to simulations of the plates.</p>
<p>An ideal, very general rheological model for the brittle lithosphere would incorporate the effects due to small-scale cracks, faults, ductile shear localization due to dynamic recrystalization, anisotropy (... kitchen sink). Needless to say, most attempts to date to account for the brittle nature of the plates have greatly simplified the picture. Some models have imposed weak zones which represent plate boundaries, others have included sharp discontinuities which represent the plate-bounding faults, still others have used continuum methods in which the yield properties of the lithosphere are known but not the geometry of any breaks. Of these approaches, the continuum approach is best able to demonstrate the spectrum of behaviours as convection in the mantle interacts with brittle lithospheric plates. For studying the evolution of individual plate boundaries methods which explicitly include discontinuities work best.</p>
<p>The simplest possible continuum formulation includes a yield stress expressed as an non-linear effective viscosity. <span class="math display">\[\eta_{\rm eff} = \frac{\tau_{\rm yield}}{\dot{\varepsilon}}\]</span> This formulation can be incorporated very easily into the mantle dynamics modeling approach that we have outlined above as it involves making modifications only to the viscosity law. There may be some numerical difficulties, however, as the strongly non-linear rheology can lead to dramatic variations in the viscosity across relatively narrow zones.</p>
<h1 id="thermochemical-convection">Thermochemical Convection</h1>
<p>The Rayleigh number is defined in terms of thermal buoyancy but other sources of buoyancy are possible in fluids.</p>
<p>For example, in the oceans, dissolved salt makes water heavy. When hot salty water (e.g. the outflows of shallow seas such as the Mediterranean) mixes with cold less salty water, there is a complicated interaction.</p>
<p>This is double diffusive convection and produces remarkable layerings etc since the diffusion coefficients of salt and heat are different by a factor of 100.</p>
<p>In the mantle, bulk chemical differences due to subduction of crustal material can be treated in a similar manner. From the point of view of the diffusion equations, the diffusivity of bulk chemistry in the mantle is tiny (pure advection).</p>
<p>Fluid flows with chemical v. thermal bouyancy are termed thermochemical convection problems.</p>
<h1 id="other-applications-and-analytic-results">Other Applications and Analytic Results</h1>
<h2 id="rayleigh-taylor-instability-diapirism">Rayleigh-Taylor Instability &amp; Diapirism</h2>
<figure>
<embed src="Diagrams/diapirs.pdf" id="fig:raytay" style="width:100mm" /><figcaption aria-hidden="true"> Salt diapirs result when a buried layer of salt(a,b) becomes convectively unstable and rises through the overlying sediment layers (c,d). The idealized geometry for the Rayleigh-Taylor instability problem is outlined in the lower diagram</figcaption>
</figure>
<p>Diapirism is the buoyant upwelling of rock which is lighter than its surroundings. This can include mantle plumes and other purely thermal phenomena but it often applied to compositionally distinct rock masses such as melts infiltrating the crust (in the Archean) or salt rising through denser sediments.</p>
<p>Salt layers may result from the evaporation of seawater. If subsequent sedimentation covers the salt, a gravitionally unstable configuration results with heavier material (sediments) on top of light material (salt). The rheology of salt is distinctly non-linear and also sensitive to temperature. Once buried, the increased temperature of the salt layer causes its viscosity to decrease to the point where instabilities can grow. Note, since there is always a strong density contrast between the two rock types, the critical Rayleigh number argument does not apply – this situation is always unstable, but instabilities can only grow at a reasonable rate once the salt has become weak.</p>
<p>The geometry is outlined above in Figure (</p>
<p><a href="#fig:raytay" data-reference-type="ref" data-reference="fig:raytay">2</a>). We suppose initially that the surface is slightly perturbed with a form of <span class="math display">\[w_m = w_{m0} \cos kx\]</span></p>
<p>where <span class="math inline">\(k\)</span> is the wavenumber, <span class="math inline">\(k=2\pi / \lambda\)</span>, <span class="math inline">\(\lambda\)</span> being the wavelength of the disturbance. We assume that the magnitude of the disturbance is always much smaller than the wavelength.</p>
<p>The problem is easiest to solve if we deal with the biharmonic equation for the stream function. Experience leads us to try to separate variables and look for solutions of the form <span class="math display">\[\psi = \left( A \sin kx + B \cos kx \right ) Y(y)\]</span></p>
<p>where the function <span class="math inline">\(Y\)</span> is to be determined. The form we have chosen for <span class="math inline">\(w_m\)</span> in fact means <span class="math inline">\(A=1,B=0\)</span> which we can assume from now on to simplify the algebra.</p>
<p>Substituting the trial solution for <span class="math inline">\(\psi\)</span> into the biharmonic equation gives <span class="math display">\[\frac{d^4 Y}{d y^4} -2k^2 \frac{d^2 Y}{dy^2} +k^4 Y = 0\]</span></p>
<p>which has solutions of the form <span class="math display">\[Y = A \exp(m y)\]</span> where <span class="math inline">\(A\)</span> is an arbitrary constant. Subtituting gives us an equation for <span class="math inline">\(m\)</span> <span class="math display">\[m^4 - 2 k^2 m^2 + k^4 = (m^2 - k^2)^2 = 0
            \label{eq:diapaux}\]</span> or <span class="math display">\[m = \pm k\]</span></p>
<p>Because we have degenerate eigenvalues (i.e. of the four possible solutions to the auxilliary equation (<a href="#eq:diapaux" data-reference-type="ref" data-reference="eq:diapaux">[eq:diapaux]</a>), two pairs are equal) we need to extend the form of the solution to <span class="math display">\[Y = (By+A) \exp(m y)\]</span> to give the general form of the solution in this situation to be <span class="math display">\[\begin{aligned}
            \psi &amp;= \sin kx \left( A e^{-ky} + B y e^{-ky} + C e^{ky} + D y e^{ky} \right)
            \label{eq:biharmsoln1} \\
        \intertext{or, equivalently}
            \psi &amp;= \sin kx \left( A_1 \cosh ky + B_1 \sinh ky + C_1 y \cosh ky + D_1 y \sinh ky  \right)
            \label{eq:biharmsoln2} 
        \end{aligned}\]</span></p>
<p>This equation applies in each of the layers separately. We therefore need to find two sets of constants <span class="math inline">\(\{A_1,B_1,C_1,D_1\}\)</span> and <span class="math inline">\(\{A_2,B_2,C_3,D_4\}\)</span> by the application of suitable boundary conditions. These are known in terms of the velocities in each layer, <span class="math inline">\(\mathbf{v}_1 = \mathbf{i} u_1 +\mathbf{j} v_1\)</span> and <span class="math inline">\(\mathbf{v}_2 = \mathbf{i} u_2 +\mathbf{j} v_2\)</span>: <span class="math display">\[\begin{aligned}
                u_1 = v_1 &amp;= 0 \text{\hspace{1cm} on \hspace{1cm}} y = -b \\
                u_2 = v_2 &amp;= 0 \text{\hspace{1cm} on \hspace{1cm}} y = b 
            \end{aligned}\]</span></p>
<p>together with a continuity condition across the interface (which we assume is imperceptibly deformed</p>
<p><span class="math display">\[u_1 = u_2  \text{\hspace{1cm} and \hspace{1cm}} 
                v_1 = v_2 \text{\hspace{1cm} on \hspace{1cm}} y = 0\]</span></p>
<p>The shear stress (<span class="math inline">\(\sigma_{xy}\)</span>) should also be continuous across the interface, which, if we assume equal viscosities, gives <span class="math display">\[\frac{\partial u_1}{\partial y} + \frac{\partial v_1}{\partial x} =
            \frac{\partial u_2}{\partial y} + \frac{\partial v_2}{\partial x} \text{\hspace{1cm} on \hspace{1cm}} y = 0\]</span> and, to simplify matters, if the velocity is continuous across <span class="math inline">\(y=0\)</span> then any velocity derivatives in the <span class="math inline">\(x\)</span> direction evaluated at <span class="math inline">\(y=0\)</span> will also be continuous (i.e. <span class="math inline">\(\partial v_2 / \partial x = \partial v_1 / \partial x\)</span>).</p>
<p>The expressions for velocity in terms of the solution (<a href="#eq:biharmsoln2" data-reference-type="ref" data-reference="eq:biharmsoln2">[eq:biharmsoln2]</a>) are</p>
<p><span class="math display">\[\begin{aligned}
                u  = -\frac{\partial \psi}{\partial y} &amp; = -\sin kx \left( 
                                (A_1 k + D_1 + C_1 k y) \sinh ky + (B_1 k + C_1 + D_1 ky) \cosh ky  \right) \\
                v  = \frac{\partial \psi}{\partial x} &amp; = k \cos kx \left( 
                                (A_1 +C_1 y)\cosh ky + (B_1 +D_1 y)  \sinh ky   \right)
            \end{aligned}\]</span></p>
<p>From here to the solution requires much tedious rearrangement, and the usual argument based on the arbitrary choice of wavenumber <span class="math inline">\(k\)</span> but we finally arrive at <span class="math display">\[\begin{gathered}
            \psi_1 = A_1 \sin kx \cosh ky + \\
                            A_1 \sin kx \left[  
                                \frac{y}{k b^2} \tanh kb \sinh ky + 
                                        \left( \frac{y}{b} \cosh ky    \frac{1}{kb} \sinh ky \right) \cdot 
                                        \left( \frac{1}{kb} + 
                                        \frac{1}{\sinh bk \cosh bk} \right) \right] \times \\
                            \left[ \frac{1}{\sinh bk \cosh bk} - \frac{1}{(b^2k^2} \tanh bk \right] ^{-1}   
            \label{eq:raytays1}             
        \end{gathered}\]</span> The stream function for the lower layer is found by replacing <span class="math inline">\(y\)</span> with <span class="math inline">\(-y\)</span> in this equation. This is already a relatively nasty expression, but we haven’t finished since the constant <span class="math inline">\(A_1\)</span> remains. This occurs because we have so far considered the form of flows which satisfy all the boundary conditions but have not yet considered what drives the flow in each layer.</p>
<p>To eliminate <span class="math inline">\(A_1\)</span>, we have to consider the physical scales inherent in the problem itself. We are interested (primarily) in the behaviour of the interface which moves with a velocity <span class="math inline">\(\partial w / \partial t\)</span>. As we are working with small deflections of the interface, <span class="math display">\[\frac{\partial w}{\partial t} = \left. v \right|_{y=0}\]</span></p>
<figure>
<embed src="Diagrams/diapir2.pdf" id="fig:raytay2" style="width:100mm" /><figcaption aria-hidden="true"> The restoring force for a stable layering is proportional to the excess density when a fluid element is displaced across the boundary</figcaption>
</figure>
<p>Consider what happens when the fluid above the interface is lighter than the fluid below – this situation is stable so we expect the layering to be preserved, and if the interface is disturbed the disturbance to decay. This implies that there must be a restoring force acting on an element of fluid which is somehow displaced across the boundary at <span class="math inline">\(y=0\)</span> (Figure <a href="#fig:raytay2" data-reference-type="ref" data-reference="fig:raytay2">3</a>).</p>
<p>This restoring force is due to the density difference between the displaced material and the layer in which it finds itself. The expression for the force is exactly that from Archimedes principle which explains how a boat can float (only in the opposite direction) <span class="math display">\[\left. F_2 \right|_{y=0} = \delta x g w (\rho_2 - \rho_1)\]</span> which can be expressed as a normal stress difference (assumed to apply, once again, at the boundary). The viscous component of the normal stress turns out to be zero – proven by evaluating <span class="math inline">\(\partial v / \partial y\)</span> at <span class="math inline">\(y=0\)</span> using the expression for <span class="math inline">\(\phi\)</span> in equation (<a href="#eq:raytays1" data-reference-type="ref" data-reference="eq:raytays1">[eq:raytays1]</a>). Thus the restoring stress is purely pressure <span class="math display">\[\left. P_2 \right|_{y=0} = g w (\rho_2 - \rho_1)\]</span></p>
<p>The pressure in terms of the solution (so far) for <span class="math inline">\(\psi\)</span> is found from the equation of motion in the horizontal direction (substituting the stream function formulation) and is then equated to the restoring pressure above. <span class="math display">\[(\rho_1-\rho_2) g w = -\frac{4 \eta k A_1}{b} \cos kx 
                    \left(\frac{1}{kb} + \frac{1}{\sinh bk \cosh bk} \right) \cdot
                    \left(   \frac{1}{\sinh bk \cosh bk} - \frac{1}{(b^2k^2} \tanh bk \right)^{-1}\]</span> which allows us to substitute for <span class="math inline">\(A_1\)</span> in our expression for <span class="math inline">\(\partial w / \partial t\)</span> above. Since <span class="math inline">\(A_1\)</span> is independent of <span class="math inline">\(t\)</span>, we can see that the solution for <span class="math inline">\(w\)</span> will be of a growing or decaying exponential form with growth/decay constant coming from the argument above. <span class="math display">\[w(t) = w_0 \exp((t-t_0)/\tau)\]</span> where <span class="math display">\[\tau = \frac{4 \eta}{(\rho_1-\rho_2) g b} \left( \frac{1}{kb} + \frac{1}{\sinh bk \cosh bk} \right) \cdot
                        \left(   \frac{1}{k^2b^2} \tanh kb - \frac{1}{\sinh kb \cosh kb}     \right)^{-1}\]</span></p>
<p>So, finally, an answer – the rate at which instabilities on the interface between two layers will grow (or shrink) which depends on viscosity, layer depth and density differences, together with the geometrical consideration of the layer thicknesses.</p>
<p>A stable layering results from light fluid resting on heavy fluid; a heavy fluid resting on a light fluid is always unstable (no critical Rayleigh number applies) although the growth rate can be so small that no deformation occurs in practice. The growth rate is also dependent on wavenumber. There is a minimum in the growth time as a function of dimensional wavenumber which occurs at <span class="math inline">\(k b = 2.4\)</span>, so instabilities close to this wavenumber are expected to grow first and dominate.</p>
<p>Remember that this derivation is simplified for fluids of equal viscosity, and layers of identical depth. Remember also that the solution is for <span>infinitessimal</span> deformations of the interface. If the deformation grows then the approximations of small deformation no longer hold. This gives a clue as to how difficulties dealing with the advection term of the transport equations arise.</p>
<p>At some point it becomes impossible to obtain meaningful results without computer simulation. However, plenty of further work has already been done on this area for non-linear fluids, temperature dependent viscosity &amp;c and the solutions are predictably long and tedious to read, much less solve. When the viscosity is not constant, the use of a stream function notation is not particularly helpful as the biharmonic form no longer appears.</p>
<p><span style="color: 0.0,0.7,0.3"> (e.g. read work by Ribe, Houseman et al.)</span></p>
<p>The methodology used here is instructive, as it can be used in a number of different applications to related areas. The equations are similar, the boundary conditions different.</p>
<h3 id="post-glacial-rebound">Post-Glacial Rebound</h3>
<figure>
<embed src="Diagrams/postglac.pdf" id="fig:postg1" style="width:80mm" /><figcaption aria-hidden="true">The relaxation of the Earth’s surface after removal of an ice load. </figcaption>
</figure>
<p>In the postglacial rebound problem, consider a viscous half space with an imposed topography at <span class="math inline">\(t=0\)</span>. The ice load is removed at <span class="math inline">\(t=0\)</span> and the interface relaxes back to its original flat state.</p>
<p>This can be studied one wavenumber at a time — computing a decay rate for each component of the topography. The intial loading is computed from the fourier transform of the ice bottom topography.</p>
<p>The system is similar to that of the diapirs except that the loading is now applied to one surface rather than the interface between two fluids.</p>
<h3 id="phase-changes-in-the-mantle">Phase Changes in the mantle</h3>
<p>A different interface problem is that of mantle phase changes. Here a bouyancy anomaly results if the phase change boundary is distorted. This can result from advection normal to the boundary bringing cooler or warmer material across the boundary.</p>
<p>The buoyancy balance argument used above can be recycled here to determine a scaling for the ability of plumes/downwellings to cross the phase boundary.</p>
<h3 id="kernels-for-surface-observables">Kernels for Surface Observables</h3>
<p>The solution method used for the Rayleigh Taylor problem can also be used in determining spectral Green’s functions for mantle flow in response to thermal perturbations. This is a particularly abstract application of the identical theory.</p>
<h2 id="folding-of-layered-viscous-medium">Folding of Layered (Viscous) Medium</h2>
<figure>
<embed src="Diagrams/fold.pdf" id="fig:fold1" style="width:100mm" /><figcaption aria-hidden="true">Instability in a thin, viscous layer compressed from both ends. </figcaption>
</figure>
<p>If a thin viscous layer is compressed from one end then it may develop buckling instabilities in which velocities grow perpendicular to the plane of the layer.</p>
<p>If the layer is embedded between two semi-infinite layers of viscous fluid with viscosity much smaller than the viscosity of the layer, then Biot theory tells us the wavelength of the initial buckling instability, and the rate at which it grows.</p>
<p>The fold geometry evolves as <span class="math display">\[w=w_m \cos(kx) e^{\frac{t}{\tau_a}}\]</span> where <span class="math display">\[\tau_a = \frac{1}{\bar{P}}\left[ \frac{4 \eta_0}{k} + \frac{\eta_1 h^3}{3k^2} \right]\]</span> and the fastest growing wavenumber is <span class="math display">\[k = \frac{6}{h}\left( \frac{\eta_1}{\eta_0} \right)^{\frac{1}{3}}\]</span></p>
<p>For large deformations we eventually must resort to numerical simulation.</p>
<h2 id="gravity-currents">Gravity Currents</h2>
<figure>
<embed src="Diagrams/gravcurr.pdf" id="fig:gcurr1" style="width:100mm" /><figcaption aria-hidden="true">A gravity current is the spreading of a dense fluid under its own weight across a horizontal surface (or a buoyant fluid under a surface). Open the fridge door and the cold air falls out as a gravity current. </figcaption>
</figure>
<p>Gravity currents can occur when a viscous fluid flows under its own weight as shown in Figure <a href="#fig:gcurr1" data-reference-type="ref" data-reference="fig:gcurr1">6</a>.</p>
<p>We assume that the fluid has constant viscosity, <span class="math inline">\(\eta\)</span> and that the length of the current is considerably greater than its height. The fluid is embedded in a low viscosity medium of density <span class="math inline">\(\rho-\Delta \rho\)</span> where <span class="math inline">\(\rho\)</span> is the density of the fluid itself.</p>
<p>The force balance is between buoyancy and viscosity. The assumptions of geometry allow us to simplify the Stokes equation by assuming horizontal pressure gradients due to the surface slope drive the flow. <span class="math display">\[\nabla p = \eta\nabla^2 u \approx   g \Delta \rho \frac{\partial h}{\partial x}\]</span></p>
<p>We assume near-zero shear stress at the top of the current to give <span class="math display">\[\frac{\partial u}{\partial z} (x,h,t) = 0\]</span> and zero velocity at the base of the current. Hence <span class="math display">\[u(x,z,t) = -\frac{1}{2} \frac{g \Delta \rho}{\eta} \frac{\partial h}{\partial x}  z(2h-z)\]</span></p>
<p>Continuity integrated over depth implies <span class="math display">\[\frac{\partial h}{\partial t} + \frac{\partial }{\partial x} \int_0^h u dz = 0\]</span> Combining these equations gives <span class="math display">\[\frac{\partial h}{\partial t} -\frac{1}{3} \frac{g \Delta \rho}{\eta} 
                     \frac{\partial }{\partial x}  \left( h^3 \frac{\partial h}{\partial x} \right) = 0\]</span> Finally, a global constraint fixes the total amount of fluid at any given time <span class="math display">\[\int_0^{x_N(t)} h(x,t)dx = qt^\alpha\]</span> The latter term being a fluid source at the origin, and <span class="math inline">\(x_{N(t)}\)</span> the location of the front of the current. A similarity variable is available <span class="math display">\[\nu = \left( \frac{1}{3} g\Delta \rho q^3 / \eta \right)^{-\frac{1}{5}} x t^{-(3\alpha +1) / 5}\]</span> giving a solution of the form <span class="math display">\[h(x,t) = \nu_N^{2/3} (3q^2 \eta / (g\Delta\rho))^{1/5} t^{(2\alpha -1) / 5} \phi(\nu/\nu_N)\]</span> where <span class="math inline">\(\nu_N\)</span> is the value of <span class="math inline">\(\nu\)</span> at <span class="math inline">\(x=x_N(t)\)</span>. Substituting into the equation for <span class="math inline">\(\partial h / \partial t\)</span> we find that <span class="math inline">\(\phi(\nu/\nu_N)\)</span> satisfies <span class="math display">\[\phi({\nu}/{\nu_N}) = \left[ \frac{3}{5}(3\alpha+1)\right]^{\frac{1}{3}}
                \left(1-\frac{\nu}{\nu_N} \right)^{\frac{1}{3}} \left[
                1 - \frac{3\alpha-4}{24(3\alpha+1)}\left(1-\frac{\nu}{\nu_N} \right) + O \left(1-\frac{\nu}{\nu_N} \right)^2
                \right]\]</span> Which has an analytic solution if <span class="math inline">\(\alpha=0\)</span> (only constant sources or sinks) <span class="math display">\[\begin{split} 
            \phi({\nu}/{\nu_N}) &amp;= \left( \frac{3}{10}\right)^{\frac{1}{3}} 
            \left( 1-\left(\frac{\nu}{\nu_N}\right)^2 \right)^{\frac{1}{3}}  \\                     
        \nu_N &amp;= \left[ \frac{1}{5} \left( \frac{3}{10}\right)^{\frac{1}{3}}  \pi^{\frac{1}{2}}
    \Gamma (1/3) / \Gamma (5/6) \right]^{-\frac{3}{5}} = 1.411
            \end{split}\]</span> For all other values of <span class="math inline">\(\alpha\)</span> numerical integration schemes must be used for <span class="math inline">\(\phi\)</span>.</p>
<p>It is also possible to obtain solutions if axisymmetric geometry is used.</p>
<h1 id="reading-material">Reading Material</h1>
<p>G. F. Davies. <em>Dynamic Earth</em>. Cambridge University Press, New York, 1999.</p>
<p>J. Grotzinger, T. H. Jordan, F. Press, and R. Siever. <em>Understanding Earth</em>. W. H. Freeman &amp; Co, 5 edition, 2006. URL <a href="http://bcs.whfreeman.com/understandingearth5e/">http://bcs.whfreeman.com/understandingearth5e/</a>.</p>
<p>L. D. Landau and E. M. Lifshitz. <em>Fluid Mechanics</em>, volume 6 of <em>Course of Theoretical Physics</em>. Pergamon Press, 1959.</p>
<p>G. Schubert, D. L. Turcotte, and P. Olson. <em>Mantle Convection in <span>E</span>arth and Planets</em>. Cambridge University Press, UK, 2001.</p>
<p>D.L. Turcotte and G. Schubert. <em>Geodynamics</em>. John Wiley and Sons, New York, 1982.</p>
</body>
</html>
